"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[44478],{44478:(le,p,l)=>{l.r(p),l.d(p,{RolesModule:()=>ie});var m=l(70916),y=l(47530),u=l(41840),c=l(44328),b=l(66232),g=l(64716),e=l(99468),f=l(96814),d=l(72500),T=l(76388),v=l(94901),x=l(68027),R=l(85219),A=l(68989),r=l(56223),_=l(612),C=l(45513),M=l(42152),N=l(24142),h=l(3291);const E=["createOrEditModal"],w=["permissionTree"];function H(t,s){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"EditRole"),": ",n.role.displayName,"")}}function L(t,s){1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CreateNewRole")))}function z(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e.TgZ(2,"div",7)(3,"h4",8),e.YNc(4,H,3,4,"span",9),e.YNc(5,L,3,3,"span",9),e.qZA(),e.TgZ(6,"button",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.close())}),e.qZA()(),e.TgZ(7,"div",11)(8,"tabset",12)(9,"tab",13),e.ALo(10,"localize"),e.TgZ(11,"div",14)(12,"label",15),e._uU(13),e.ALo(14,"localize"),e.qZA(),e.TgZ(15,"input",16,17),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.role.displayName=i)}),e.qZA(),e._UZ(17,"validation-messages",18),e.qZA(),e.TgZ(18,"label",19)(19,"input",20),e.NdJ("ngModelChange",function(i){e.CHM(n);const a=e.oxw();return e.KtG(a.role.isDefault=i)}),e.qZA(),e.TgZ(20,"span",21),e._uU(21),e.ALo(22,"localize"),e.TgZ(23,"small",22),e._uU(24),e.ALo(25,"localize"),e.qZA()()()()(),e.TgZ(26,"div",23)(27,"em"),e._uU(28),e.ALo(29,"localize"),e.qZA()()(),e.TgZ(30,"div",24)(31,"button",25),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.close())}),e._uU(32),e.ALo(33,"localize"),e.qZA(),e.TgZ(34,"button",26),e._UZ(35,"i",27),e.TgZ(36,"span"),e._uU(37),e.ALo(38,"localize"),e.qZA()()()()}if(2&t){const n=e.MAs(1),o=e.MAs(16),i=e.oxw();e.xp6(4),e.Q6J("ngIf",i.role.id),e.xp6(1),e.Q6J("ngIf",!i.role.id),e.xp6(1),e.Q6J("disabled",i.saving),e.uIk("aria-label",i.l("Close")),e.xp6(3),e.s9C("heading",e.lcZ(10,18,"RoleName")),e.xp6(4),e.Oqu(e.lcZ(14,20,"RoleName")),e.xp6(2),e.Q6J("ngModel",i.role.displayName),e.xp6(2),e.Q6J("formCtrl",o),e.xp6(2),e.Q6J("ngModel",i.role.isDefault),e.xp6(2),e.hij(" ",e.lcZ(22,22,"Default")," "),e.xp6(3),e.hij("(",e.lcZ(25,24,"DefaultRole_Description"),")"),e.xp6(4),e.Oqu(e.lcZ(29,26,"Note_RefreshPageForPermissionChanges")),e.xp6(3),e.Q6J("disabled",i.saving),e.xp6(1),e.hij(" ",e.lcZ(33,28,"Cancel")," "),e.xp6(2),e.Q6J("disabled",!n.form.valid)("buttonBusy",i.saving)("busyText",i.l("SavingWithThreeDot")),e.xp6(3),e.Oqu(e.lcZ(38,30,"Save"))}}const J=function(t){return{backdrop:"static",keyboard:t}};let S=(()=>{class t extends u.c{constructor(n,o){super(n),this._roleService=o,this.modalSave=new e.vpe,this.active=!1,this.saving=!1,this.role=new c.f78}show(n){const o=this;o.active=!0,o._roleService.getRoleForEdit(n).subscribe(i=>{o.role=i.role,o.modal.show()})}onShown(){document.getElementById("RoleDisplayName").focus()}save(){const o=new c.H$n;o.role=this.role,o.grantedPermissionNames=this.permissionTree.getGrantedPermissionNames(),this.saving=!0,this._roleService.createOrUpdateRole(o).pipe((0,g.x)(()=>this.saving=!1)).subscribe(()=>{this.notify.info(this.l("SavedSuccessfully")),this.close(),this.modalSave.emit(null)})}close(){this.active=!1,this.modal.hide()}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(e.zs3),e.Y36(c.AR1))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["createOrEditRoleModal"]],viewQuery:function(o,i){if(1&o&&(e.Gf(E,7),e.Gf(w,5)),2&o){let a;e.iGM(a=e.CRH())&&(i.modal=a.first),e.iGM(a=e.CRH())&&(i.permissionTree=a.first)}},outputs:{modalSave:"modalSave"},features:[e.qOj],decls:5,vars:4,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","createOrEditModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["createOrEditModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["novalidate","","autocomplete","new-password",3,"ngSubmit",4,"ngIf"],["novalidate","","autocomplete","new-password",3,"ngSubmit"],["roleForm","ngForm"],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"tab-container","tabbable-line"],[1,"p-5",3,"heading"],[1,"mb-5"],[1,"form-label","required"],["id","RoleDisplayName","type","text","name","DisplayName","required","","maxlength","64",1,"form-control",3,"ngModel","ngModelChange"],["roleNameInput","ngModel"],[3,"formCtrl"],[1,"form-check","form-check-custom","form-check-solid","py-1"],["id","EditRole_IsDefault","type","checkbox","name","IsDefault",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"form-text","text-muted","ms-3"],[1,"alert","alert-warning",2,"margin-top","30px"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-save"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return i.onShown()}),e.TgZ(2,"div",2)(3,"div",3),e.YNc(4,z,39,32,"form",4),e.qZA()()()),2&o&&(e.Q6J("config",e.VKq(2,J,!i.saving)),e.xp6(4),e.Q6J("ngIf",i.active))},dependencies:[f.O5,r._Y,r.Fj,r.Wl,r.JJ,r.JL,r.Q7,r.nD,r.On,r.F,_.wW,_.AH,C.L,M.s,N.Z,h.F],encapsulation:2})}return t})();var O=l(88922),U=l(83410),I=l(98155);const Q=["createOrEditRoleModal"],D=["entityTypeHistoryModal"],F=["dataTable"],q=["permissionFilterTreeModal"];function G(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.createRole())}),e._UZ(1,"i",25),e.TgZ(2,"span",12),e._uU(3),e.ALo(4,"localize"),e.qZA()()}2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"CreateNewRole")," "))}const Z=function(){return["Pages.Administration.Roles.Edit","Pages.Administration.Roles.Delete"]};function j(t,s){1&t&&(e.TgZ(0,"tr")(1,"th",26),e.ALo(2,"permissionAny"),e._uU(3),e.ALo(4,"localize"),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.ALo(7,"localize"),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.ALo(10,"localize"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("hidden",!e.lcZ(2,4,e.DdM(12,Z))),e.xp6(2),e.hij(" ",e.lcZ(4,6,"Actions")," "),e.xp6(3),e.Oqu(e.lcZ(7,8,"RoleName")),e.xp6(3),e.Oqu(e.lcZ(10,10,"CreationTime")))}function Y(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li",38)(1,"a",39),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2).$implicit;e.oxw();const a=e.MAs(29);return e.KtG(a.show(i.id))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Edit")," "))}function P(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li",38)(1,"a",39),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.deleteRole(i))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Delete")," "))}function B(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"li",38)(1,"a",39),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.showHistory(i))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"History")," "))}function k(t,s){if(1&t&&(e.TgZ(0,"ul",36),e.YNc(1,Y,4,3,"li",37),e.ALo(2,"permission"),e.YNc(3,P,4,3,"li",37),e.ALo(4,"permission"),e.YNc(5,B,4,3,"li",37),e.qZA()),2&t){const n=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,"Pages.Administration.Roles.Edit")),e.xp6(2),e.Q6J("ngIf",!n.isStatic&&e.lcZ(4,5,"Pages.Administration.Roles.Delete")),e.xp6(2),e.Q6J("ngIf",o.entityHistoryEnabled)}}function K(t,s){1&t&&(e.TgZ(0,"span",40),e.ALo(1,"localize"),e._uU(2),e.ALo(3,"localize"),e.qZA()),2&t&&(e.s9C("title",e.lcZ(1,2,"StaticRole_Tooltip")),e.xp6(2),e.hij(" ",e.lcZ(3,4,"Static")," "))}function $(t,s){1&t&&(e.TgZ(0,"span",41),e.ALo(1,"localize"),e._uU(2),e.ALo(3,"localize"),e.qZA()),2&t&&(e.s9C("title",e.lcZ(1,2,"DefaultRole_Description")),e.xp6(2),e.hij(" ",e.lcZ(3,4,"Default")," "))}function W(t,s){if(1&t&&(e.TgZ(0,"tr")(1,"td",27),e.ALo(2,"permissionAny"),e.TgZ(3,"div",28)(4,"button",29),e._UZ(5,"i",30)(6,"span",31),e._uU(7),e.ALo(8,"localize"),e.qZA(),e.YNc(9,k,6,7,"ul",32),e.qZA()(),e.TgZ(10,"td")(11,"span",33),e._uU(12),e.ALo(13,"localize"),e.qZA(),e.TgZ(14,"span"),e._uU(15),e.YNc(16,K,4,6,"span",34),e.YNc(17,$,4,6,"span",35),e.qZA()(),e.TgZ(18,"td")(19,"span",33),e._uU(20),e.ALo(21,"localize"),e.qZA(),e._uU(22),e.ALo(23,"luxonFormat"),e.qZA()()),2&t){const n=s.$implicit,o=e.oxw();e.xp6(1),e.Q6J("hidden",!(e.lcZ(2,8,e.DdM(19,Z))||o.entityHistoryEnabled)),e.xp6(6),e.hij(" ",e.lcZ(8,10,"Actions")," "),e.xp6(5),e.Oqu(e.lcZ(13,12,"RoleName")),e.xp6(3),e.hij(" ",n.displayName," "),e.xp6(1),e.Q6J("ngIf",n.isStatic),e.xp6(1),e.Q6J("ngIf",n.isDefault),e.xp6(3),e.Oqu(e.lcZ(21,14,"CreationTime")),e.xp6(2),e.hij(" ",e.xi3(23,16,n.creationTime,"F")," ")}}function X(t,s){1&t&&(e.TgZ(0,"div",42),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const V=function(){return{"min-width":"50rem"}},ee=[{path:"",component:(()=>{class t extends u.c{constructor(n,o){super(n),this._roleService=o,this._entityTypeFullName="Minimates.Authorization.Roles.Role",this.entityHistoryEnabled=!1}ngOnInit(){this.setIsEntityHistoryEnabled()}getRoles(){this.primengTableHelper.showLoadingIndicator();let n=this.permissionFilterTreeModal.getSelectedPermissions();this._roleService.getRoles(new c.mik({permissions:n})).pipe((0,g.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(o=>{this.primengTableHelper.records=o.items,this.primengTableHelper.totalRecordsCount=o.items.length,this.primengTableHelper.hideLoadingIndicator()})}createRole(){this.createOrEditRoleModal.show()}showHistory(n){this.entityTypeHistoryModal.show({entityId:n.id.toString(),entityTypeFullName:this._entityTypeFullName,entityTypeDescription:n.displayName})}deleteRole(n){this.message.confirm(this.l("RoleDeleteWarningMessage",n.displayName),this.l("AreYouSure"),i=>{i&&this._roleService.deleteRole(n.id).subscribe(()=>{this.getRoles(),abp.notify.success(this.l("SuccessfullyDeleted"))})})}setIsEntityHistoryEnabled(){let n=abp.custom;this.entityHistoryEnabled=n.EntityHistory&&n.EntityHistory.isEnabled&&1===(0,b.Z)(n.EntityHistory.enabledEntities,o=>o===this._entityTypeFullName).length}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(e.zs3),e.Y36(c.AR1))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(o,i){if(1&o&&(e.Gf(Q,7),e.Gf(D,7),e.Gf(F,7),e.Gf(q,7)),2&o){let a;e.iGM(a=e.CRH())&&(i.createOrEditRoleModal=a.first),e.iGM(a=e.CRH())&&(i.entityTypeHistoryModal=a.first),e.iGM(a=e.CRH())&&(i.dataTable=a.first),e.iGM(a=e.CRH())&&(i.permissionFilterTreeModal=a.first)}},features:[e.qOj],decls:32,vars:23,consts:[[3,"title","description"],["role","actions"],["class","btn btn-primary float-end",3,"click",4,"ngIf"],[1,"card","card-custom"],[1,"card-body"],[1,"form"],[1,"row"],[1,"col-6"],[1,"mb-5"],[1,"col-6","text-end"],["name","RefreshButton",1,"btn","btn-primary","float-end",3,"click"],[1,"la","la-refresh","btn-md-icon"],[1,"d-none","d-md-inline-block"],[1,"row","align-items-center"],[1,"primeng-datatable-container",3,"busyIf"],[3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"ui-table-footer"],[3,"modalSave"],["createOrEditRoleModal",""],["entityTypeHistoryModal",""],[1,"btn","btn-primary","float-end",3,"click"],[1,"fa","fa-plus","btn-md-icon"],[2,"width","130px",3,"hidden"],[3,"hidden"],["dropdown","","placement","bottom left","container","body",1,"btn-group"],["id","dropdownButton","type","button","dropdownToggle","","aria-controls","dropdownMenu",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog"],[1,"caret"],["id","dropdownMenu","class","dropdown-menu","role","menu","aria-labelledby","dropdownButton",4,"dropdownMenu"],[1,"p-column-title"],["class","badge badge-primary m-1","data-toggle","tooltip","data-placement","top",3,"title",4,"ngIf"],["class","badge badge-dark m-1","data-toggle","tooltip","data-placement","top",3,"title",4,"ngIf"],["id","dropdownMenu","role","menu","aria-labelledby","dropdownButton",1,"dropdown-menu"],["role","menuitem",4,"ngIf"],["role","menuitem"],["href","javascript:;",1,"dropdown-item",3,"click"],["data-toggle","tooltip","data-placement","top",1,"badge","badge-primary","m-1",3,"title"],["data-toggle","tooltip","data-placement","top",1,"badge","badge-dark","m-1",3,"title"],[1,"primeng-no-data"]],template:function(o,i){1&o&&(e.TgZ(0,"div")(1,"sub-header",0),e.ALo(2,"localize"),e.ALo(3,"localize"),e.TgZ(4,"div",1),e.YNc(5,G,5,3,"button",2),e.ALo(6,"permission"),e.qZA()(),e.TgZ(7,"div")(8,"div",3)(9,"div",4)(10,"div",5)(11,"div",6)(12,"div",7),e._UZ(13,"div",8),e.qZA(),e.TgZ(14,"div",9)(15,"button",10),e.NdJ("click",function(){return i.getRoles()}),e._UZ(16,"i",11),e.TgZ(17,"span",12),e._uU(18),e.ALo(19,"localize"),e.qZA()()()()(),e.TgZ(20,"div",13)(21,"div",14)(22,"p-table",15,16),e.NdJ("onLazyLoad",function(){return i.getRoles()}),e.YNc(24,j,11,13,"ng-template",17),e.YNc(25,W,24,20,"ng-template",18),e.qZA(),e.YNc(26,X,3,3,"div",19),e._UZ(27,"div",20),e.qZA()()()()(),e.TgZ(28,"createOrEditRoleModal",21,22),e.NdJ("modalSave",function(){return i.getRoles()}),e.qZA(),e._UZ(30,"entityTypeHistoryModal",null,23),e.qZA()),2&o&&(e.Q6J("@routerTransition",void 0),e.xp6(1),e.Q6J("title",e.lcZ(2,14,"Roles"))("description",e.lcZ(3,16,"RolesHeaderInfo")),e.xp6(4),e.Q6J("ngIf",e.lcZ(6,18,"Pages.Administration.Roles.Create")),e.xp6(2),e.Tol(i.containerClass),e.xp6(11),e.hij(" ",e.lcZ(19,20,"Refresh")," "),e.xp6(3),e.Q6J("busyIf",i.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",i.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",i.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(22,V)),e.xp6(4),e.Q6J("ngIf",0==i.primengTableHelper.totalRecordsCount))},dependencies:[f.O5,d.Hz,d.Mq,d.TO,T.A,v.U,x.iA,R.jx,A.$,S,O.n,h.F,U.a,I.G],encapsulation:2,data:{animation:[(0,y.MH)()]}})}return t})(),pathMatch:"full"}];let te=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#o=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(ee),m.Bz]})}return t})();var oe=l(71902),ne=l(92337);let ie=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#o=this.\u0275inj=e.cJS({imports:[ne.o,oe.g,te]})}return t})()}}]);