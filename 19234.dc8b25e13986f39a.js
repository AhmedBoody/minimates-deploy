"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[19234],{19234:(A,p,s)=>{s.r(p),s.d(p,{StripePurchaseModule:()=>P});var h=s(92337),l=s(91860),o=s(70916),m=s(41840),v=s(49291),y=s(47530),r=s(44328),d=s(15047),t=s(99468),u=s(96814),f=s(94901),g=s(3291);function I(e,U){if(1&e&&t._UZ(0,"div",11),2&e){const n=t.oxw();t.Q6J("busyIf",n.stripeIsLoading)}}const S=[{path:"",component:(()=>{class e extends m.c{constructor(n,a,i,c){super(n),this._activatedRoute=a,this._stripePaymentAppService=i,this._paymentAppService=c,this.amount=0,this.description="",this.stripeIsLoading=!0,this.subscriptionPaymentGateway=r.UWJ,this.subscriptionStartType=r.gPM}ngOnInit(){this.spinnerService.show(),this.setTenantIdCookieIfNeeded(),this.stripeIsLoading=!0,this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,(new v.$).load("https://js.stripe.com/v3").then(()=>{this._stripePaymentAppService.getConfiguration().subscribe(n=>{this._stripePaymentAppService.createPaymentSession(new r.ieL({paymentId:this.paymentId,successUrl:d.g.appBaseUrl+"/account/stripe-payment-result",cancelUrl:d.g.appBaseUrl+"/account/stripe-cancel-payment"})).subscribe(a=>{this._paymentAppService.getPayment(this.paymentId).subscribe(i=>{this.spinnerService.hide(),this.amount=i.amount,this.description=i.description,this.successCallbackUrl=i.successUrl,this.errorCallbackUrl=i.errorUrl;let c=window.Stripe(n.publishableKey);document.getElementById("stripe-checkout").addEventListener("click",function(){c.redirectToCheckout({sessionId:a})}),this.stripeIsLoading=!1},i=>{this.spinnerService.hide()})},a=>{this.spinnerService.hide()})},n=>{this.spinnerService.hide()})}).catch(n=>{this.spinnerService.hide()})}setTenantIdCookieIfNeeded(){if(!this._activatedRoute.snapshot.queryParams.tenantId)return;let n=parseInt(this._activatedRoute.snapshot.queryParams.tenantId);abp.multiTenancy.setTenantIdCookie(n)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(t.zs3),t.Y36(o.gz),t.Y36(r.YgH),t.Y36(r.KC))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["stripe-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[t.qOj],decls:24,vars:17,consts:[[1,"login-form"],[1,"card","card-bordered"],[1,"card-header","align-items-center"],[1,"card-body"],[1,"mb-5","row"],[1,"form-label","col-sm-4"],[1,"col-sm-8","text-end"],[1,"fw-bold"],["id","totalPrice",1,"fw-bold"],["id","stripe-checkout",1,"btn","btn-primary","w-100",3,"disabled"],[3,"busyIf",4,"ngIf"],[3,"busyIf"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4),t.ALo(5,"localize"),t.qZA()(),t.TgZ(6,"div",3)(7,"div",4)(8,"label",5),t._uU(9),t.qZA(),t.TgZ(10,"div",6)(11,"p",7),t._uU(12),t.qZA()()(),t.TgZ(13,"div",4)(14,"label",5),t._uU(15),t.qZA(),t.TgZ(16,"div",6)(17,"p",8),t._uU(18),t.ALo(19,"number"),t.qZA()()(),t.TgZ(20,"button",9),t._uU(21),t.ALo(22,"localize"),t.qZA(),t.YNc(23,I,1,1,"div",10),t.qZA()()()),2&a&&(t.Q6J("@routerTransition",void 0),t.xp6(4),t.hij(" ",t.lcZ(5,10,"TenantSignUp")," "),t.xp6(5),t.Oqu(i.l("Item")),t.xp6(3),t.hij(" ",i.description," "),t.xp6(3),t.Oqu(i.l("Price")),t.xp6(3),t.AsE(" ",i.appSession.application.currencySign,"",t.xi3(19,12,i.amount,"1.2-2")," "),t.xp6(2),t.Q6J("disabled",i.stripeIsLoading),t.xp6(1),t.hij(" ",t.lcZ(22,15,"Purchase")," "),t.xp6(2),t.Q6J("ngIf",i.stripeIsLoading))},dependencies:[u.O5,f.U,u.JJ,g.F],encapsulation:2,data:{animation:[(0,y.RP)()]}})}return e})(),pathMatch:"full"}];let b=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[o.Bz.forChild(S),o.Bz]})}return e})(),P=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[h.o,l.y,b]})}return e})()}}]);