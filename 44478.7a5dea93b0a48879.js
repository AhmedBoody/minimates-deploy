"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[44478],{44478:(se,p,l)=>{l.r(p),l.d(p,{RolesModule:()=>ae});var m=l(70916),y=l(47530),u=l(41840),c=l(44328),T=l(66232),g=l(64716),e=l(99468),f=l(96814),d=l(72500),b=l(76388),v=l(94901),x=l(68027),R=l(85219),A=l(59170),C=l(68989),r=l(56223),_=l(612),M=l(45513),N=l(42152),E=l(24142),H=l(99824),h=l(3291);const L=["createOrEditModal"],w=["permissionTree"];function z(t,s){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t){const i=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,"EditRole"),": ",i.role.displayName,"")}}function J(t,s){1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"CreateNewRole")))}function S(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("ngSubmit",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.save())}),e.TgZ(2,"div",7)(3,"h4",8),e.YNc(4,z,3,4,"span",9),e.YNc(5,J,3,3,"span",9),e.qZA(),e.TgZ(6,"button",10),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.close())}),e.qZA()(),e.TgZ(7,"div",11)(8,"tabset",12)(9,"tab",13),e.ALo(10,"localize"),e.TgZ(11,"div",14)(12,"label",15),e._uU(13),e.ALo(14,"localize"),e.qZA(),e.TgZ(15,"input",16,17),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.role.displayName=n)}),e.qZA(),e._UZ(17,"validation-messages",18),e.qZA(),e.TgZ(18,"label",19)(19,"input",20),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.role.isDefault=n)}),e.qZA(),e.TgZ(20,"span",21),e._uU(21),e.ALo(22,"localize"),e.TgZ(23,"small",22),e._uU(24),e.ALo(25,"localize"),e.qZA()()()(),e.TgZ(26,"tab",13),e.ALo(27,"localize"),e._UZ(28,"permission-tree",null,23),e.qZA()(),e.TgZ(30,"div",24)(31,"em"),e._uU(32),e.ALo(33,"localize"),e.qZA()()(),e.TgZ(34,"div",25)(35,"button",26),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.close())}),e._uU(36),e.ALo(37,"localize"),e.qZA(),e.TgZ(38,"button",27),e._UZ(39,"i",28),e.TgZ(40,"span"),e._uU(41),e.ALo(42,"localize"),e.qZA()()()()}if(2&t){const i=e.MAs(1),o=e.MAs(16),n=e.oxw();e.xp6(4),e.Q6J("ngIf",n.role.id),e.xp6(1),e.Q6J("ngIf",!n.role.id),e.xp6(1),e.Q6J("disabled",n.saving),e.uIk("aria-label",n.l("Close")),e.xp6(3),e.s9C("heading",e.lcZ(10,19,"RoleName")),e.xp6(4),e.Oqu(e.lcZ(14,21,"RoleName")),e.xp6(2),e.Q6J("ngModel",n.role.displayName),e.xp6(2),e.Q6J("formCtrl",o),e.xp6(2),e.Q6J("ngModel",n.role.isDefault),e.xp6(2),e.hij(" ",e.lcZ(22,23,"Default")," "),e.xp6(3),e.hij("(",e.lcZ(25,25,"DefaultRole_Description"),")"),e.xp6(2),e.s9C("heading",e.lcZ(27,27,"Permissions")),e.xp6(6),e.Oqu(e.lcZ(33,29,"Note_RefreshPageForPermissionChanges")),e.xp6(3),e.Q6J("disabled",n.saving),e.xp6(1),e.hij(" ",e.lcZ(37,31,"Cancel")," "),e.xp6(2),e.Q6J("disabled",!i.form.valid)("buttonBusy",n.saving)("busyText",n.l("SavingWithThreeDot")),e.xp6(3),e.Oqu(e.lcZ(42,33,"Save"))}}const O=function(t){return{backdrop:"static",keyboard:t}};let U=(()=>{class t extends u.c{constructor(i,o){super(i),this._roleService=o,this.modalSave=new e.vpe,this.active=!1,this.saving=!1,this.role=new c.f78}show(i){const o=this;o.active=!0,o._roleService.getRoleForEdit(i).subscribe(n=>{o.role=n.role,this.permissionTree.editData=n,o.modal.show()})}onShown(){document.getElementById("RoleDisplayName").focus()}save(){const o=new c.H$n;o.role=this.role,o.grantedPermissionNames=this.permissionTree.getGrantedPermissionNames(),this.saving=!0,this._roleService.createOrUpdateRole(o).pipe((0,g.x)(()=>this.saving=!1)).subscribe(()=>{this.notify.info(this.l("SavedSuccessfully")),this.close(),this.modalSave.emit(null)})}close(){this.active=!1,this.modal.hide()}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(e.zs3),e.Y36(c.AR1))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["createOrEditRoleModal"]],viewQuery:function(o,n){if(1&o&&(e.Gf(L,7),e.Gf(w,5)),2&o){let a;e.iGM(a=e.CRH())&&(n.modal=a.first),e.iGM(a=e.CRH())&&(n.permissionTree=a.first)}},outputs:{modalSave:"modalSave"},features:[e.qOj],decls:5,vars:4,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","createOrEditModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["createOrEditModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["novalidate","","autocomplete","new-password",3,"ngSubmit",4,"ngIf"],["novalidate","","autocomplete","new-password",3,"ngSubmit"],["roleForm","ngForm"],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"tab-container","tabbable-line"],[1,"p-5",3,"heading"],[1,"mb-5"],[1,"form-label","required"],["id","RoleDisplayName","type","text","name","DisplayName","required","","maxlength","64",1,"form-control",3,"ngModel","ngModelChange"],["roleNameInput","ngModel"],[3,"formCtrl"],[1,"form-check","form-check-custom","form-check-solid","py-1"],["id","EditRole_IsDefault","type","checkbox","name","IsDefault",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"form-text","text-muted","ms-3"],["permissionTree",""],[1,"alert","alert-warning",2,"margin-top","30px"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-save"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return n.onShown()}),e.TgZ(2,"div",2)(3,"div",3),e.YNc(4,S,43,35,"form",4),e.qZA()()()),2&o&&(e.Q6J("config",e.VKq(2,O,!n.saving)),e.xp6(4),e.Q6J("ngIf",n.active))},dependencies:[f.O5,r._Y,r.Fj,r.Wl,r.JJ,r.JL,r.Q7,r.nD,r.On,r.F,_.wW,_.AH,M.L,N.s,E.Z,H.I,h.F],encapsulation:2})}return t})();var I=l(88922),Q=l(83410),D=l(98155);const F=["createOrEditRoleModal"],q=["entityTypeHistoryModal"],G=["dataTable"],j=["permissionFilterTreeModal"];function Y(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.createRole())}),e._UZ(1,"i",27),e.TgZ(2,"span",14),e._uU(3),e.ALo(4,"localize"),e.qZA()()}2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"CreateNewRole")," "))}const Z=function(){return["Pages.Administration.Roles.Edit","Pages.Administration.Roles.Delete"]};function P(t,s){1&t&&(e.TgZ(0,"tr")(1,"th",28),e.ALo(2,"permissionAny"),e._uU(3),e.ALo(4,"localize"),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.ALo(7,"localize"),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.ALo(10,"localize"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("hidden",!e.lcZ(2,4,e.DdM(12,Z))),e.xp6(2),e.hij(" ",e.lcZ(4,6,"Actions")," "),e.xp6(3),e.Oqu(e.lcZ(7,8,"RoleName")),e.xp6(3),e.Oqu(e.lcZ(10,10,"CreationTime")))}function B(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"li",40)(1,"a",41),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2).$implicit;e.oxw();const a=e.MAs(31);return e.KtG(a.show(n.id))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Edit")," "))}function K(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"li",40)(1,"a",41),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.deleteRole(n))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Delete")," "))}function k(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"li",40)(1,"a",41),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.showHistory(n))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"History")," "))}function $(t,s){if(1&t&&(e.TgZ(0,"ul",38),e.YNc(1,B,4,3,"li",39),e.ALo(2,"permission"),e.YNc(3,K,4,3,"li",39),e.ALo(4,"permission"),e.YNc(5,k,4,3,"li",39),e.qZA()),2&t){const i=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,"Pages.Administration.Roles.Edit")),e.xp6(2),e.Q6J("ngIf",!i.isStatic&&e.lcZ(4,5,"Pages.Administration.Roles.Delete")),e.xp6(2),e.Q6J("ngIf",o.entityHistoryEnabled)}}function W(t,s){1&t&&(e.TgZ(0,"span",42),e.ALo(1,"localize"),e._uU(2),e.ALo(3,"localize"),e.qZA()),2&t&&(e.s9C("title",e.lcZ(1,2,"StaticRole_Tooltip")),e.xp6(2),e.hij(" ",e.lcZ(3,4,"Static")," "))}function X(t,s){1&t&&(e.TgZ(0,"span",43),e.ALo(1,"localize"),e._uU(2),e.ALo(3,"localize"),e.qZA()),2&t&&(e.s9C("title",e.lcZ(1,2,"DefaultRole_Description")),e.xp6(2),e.hij(" ",e.lcZ(3,4,"Default")," "))}function V(t,s){if(1&t&&(e.TgZ(0,"tr")(1,"td",29),e.ALo(2,"permissionAny"),e.TgZ(3,"div",30)(4,"button",31),e._UZ(5,"i",32)(6,"span",33),e._uU(7),e.ALo(8,"localize"),e.qZA(),e.YNc(9,$,6,7,"ul",34),e.qZA()(),e.TgZ(10,"td")(11,"span",35),e._uU(12),e.ALo(13,"localize"),e.qZA(),e.TgZ(14,"span"),e._uU(15),e.YNc(16,W,4,6,"span",36),e.YNc(17,X,4,6,"span",37),e.qZA()(),e.TgZ(18,"td")(19,"span",35),e._uU(20),e.ALo(21,"localize"),e.qZA(),e._uU(22),e.ALo(23,"luxonFormat"),e.qZA()()),2&t){const i=s.$implicit,o=e.oxw();e.xp6(1),e.Q6J("hidden",!(e.lcZ(2,8,e.DdM(19,Z))||o.entityHistoryEnabled)),e.xp6(6),e.hij(" ",e.lcZ(8,10,"Actions")," "),e.xp6(5),e.Oqu(e.lcZ(13,12,"RoleName")),e.xp6(3),e.hij(" ",i.displayName," "),e.xp6(1),e.Q6J("ngIf",i.isStatic),e.xp6(1),e.Q6J("ngIf",i.isDefault),e.xp6(3),e.Oqu(e.lcZ(21,14,"CreationTime")),e.xp6(2),e.hij(" ",e.xi3(23,16,i.creationTime,"F")," ")}}function ee(t,s){1&t&&(e.TgZ(0,"div",44),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const te=function(){return{"min-width":"50rem"}},oe=[{path:"",component:(()=>{class t extends u.c{constructor(i,o){super(i),this._roleService=o,this._entityTypeFullName="Minimates.Authorization.Roles.Role",this.entityHistoryEnabled=!1}ngOnInit(){this.setIsEntityHistoryEnabled()}getRoles(){this.primengTableHelper.showLoadingIndicator();let i=this.permissionFilterTreeModal.getSelectedPermissions();this._roleService.getRoles(new c.mik({permissions:i})).pipe((0,g.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(o=>{this.primengTableHelper.records=o.items,this.primengTableHelper.totalRecordsCount=o.items.length,this.primengTableHelper.hideLoadingIndicator()})}createRole(){this.createOrEditRoleModal.show()}showHistory(i){this.entityTypeHistoryModal.show({entityId:i.id.toString(),entityTypeFullName:this._entityTypeFullName,entityTypeDescription:i.displayName})}deleteRole(i){this.message.confirm(this.l("RoleDeleteWarningMessage",i.displayName),this.l("AreYouSure"),n=>{n&&this._roleService.deleteRole(i.id).subscribe(()=>{this.getRoles(),abp.notify.success(this.l("SuccessfullyDeleted"))})})}setIsEntityHistoryEnabled(){let i=abp.custom;this.entityHistoryEnabled=i.EntityHistory&&i.EntityHistory.isEnabled&&1===(0,T.Z)(i.EntityHistory.enabledEntities,o=>o===this._entityTypeFullName).length}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(e.zs3),e.Y36(c.AR1))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(o,n){if(1&o&&(e.Gf(F,7),e.Gf(q,7),e.Gf(G,7),e.Gf(j,7)),2&o){let a;e.iGM(a=e.CRH())&&(n.createOrEditRoleModal=a.first),e.iGM(a=e.CRH())&&(n.entityTypeHistoryModal=a.first),e.iGM(a=e.CRH())&&(n.dataTable=a.first),e.iGM(a=e.CRH())&&(n.permissionFilterTreeModal=a.first)}},features:[e.qOj],decls:34,vars:23,consts:[[3,"title","description"],["role","actions"],["class","btn btn-primary float-end",3,"click",4,"ngIf"],[1,"card","card-custom"],[1,"card-body"],[1,"form"],[1,"row"],[1,"col-6"],[1,"mb-5"],[3,"onModalclose"],["permissionFilterTreeModal",""],[1,"col-6","text-end"],["name","RefreshButton",1,"btn","btn-primary","float-end",3,"click"],[1,"la","la-refresh","btn-md-icon"],[1,"d-none","d-md-inline-block"],[1,"row","align-items-center"],[1,"primeng-datatable-container",3,"busyIf"],[3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"ui-table-footer"],[3,"modalSave"],["createOrEditRoleModal",""],["entityTypeHistoryModal",""],[1,"btn","btn-primary","float-end",3,"click"],[1,"fa","fa-plus","btn-md-icon"],[2,"width","130px",3,"hidden"],[3,"hidden"],["dropdown","","placement","bottom left","container","body",1,"btn-group"],["id","dropdownButton","type","button","dropdownToggle","","aria-controls","dropdownMenu",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog"],[1,"caret"],["id","dropdownMenu","class","dropdown-menu","role","menu","aria-labelledby","dropdownButton",4,"dropdownMenu"],[1,"p-column-title"],["class","badge badge-primary m-1","data-toggle","tooltip","data-placement","top",3,"title",4,"ngIf"],["class","badge badge-dark m-1","data-toggle","tooltip","data-placement","top",3,"title",4,"ngIf"],["id","dropdownMenu","role","menu","aria-labelledby","dropdownButton",1,"dropdown-menu"],["role","menuitem",4,"ngIf"],["role","menuitem"],["href","javascript:;",1,"dropdown-item",3,"click"],["data-toggle","tooltip","data-placement","top",1,"badge","badge-primary","m-1",3,"title"],["data-toggle","tooltip","data-placement","top",1,"badge","badge-dark","m-1",3,"title"],[1,"primeng-no-data"]],template:function(o,n){1&o&&(e.TgZ(0,"div")(1,"sub-header",0),e.ALo(2,"localize"),e.ALo(3,"localize"),e.TgZ(4,"div",1),e.YNc(5,Y,5,3,"button",2),e.ALo(6,"permission"),e.qZA()(),e.TgZ(7,"div")(8,"div",3)(9,"div",4)(10,"div",5)(11,"div",6)(12,"div",7)(13,"div",8)(14,"permission-tree-modal",9,10),e.NdJ("onModalclose",function(){return n.getRoles()}),e.qZA()()(),e.TgZ(16,"div",11)(17,"button",12),e.NdJ("click",function(){return n.getRoles()}),e._UZ(18,"i",13),e.TgZ(19,"span",14),e._uU(20),e.ALo(21,"localize"),e.qZA()()()()(),e.TgZ(22,"div",15)(23,"div",16)(24,"p-table",17,18),e.NdJ("onLazyLoad",function(){return n.getRoles()}),e.YNc(26,P,11,13,"ng-template",19),e.YNc(27,V,24,20,"ng-template",20),e.qZA(),e.YNc(28,ee,3,3,"div",21),e._UZ(29,"div",22),e.qZA()()()()(),e.TgZ(30,"createOrEditRoleModal",23,24),e.NdJ("modalSave",function(){return n.getRoles()}),e.qZA(),e._UZ(32,"entityTypeHistoryModal",null,25),e.qZA()),2&o&&(e.Q6J("@routerTransition",void 0),e.xp6(1),e.Q6J("title",e.lcZ(2,14,"Roles"))("description",e.lcZ(3,16,"RolesHeaderInfo")),e.xp6(4),e.Q6J("ngIf",e.lcZ(6,18,"Pages.Administration.Roles.Create")),e.xp6(2),e.Tol(n.containerClass),e.xp6(13),e.hij(" ",e.lcZ(21,20,"Refresh")," "),e.xp6(3),e.Q6J("busyIf",n.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",n.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",n.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(22,te)),e.xp6(4),e.Q6J("ngIf",0==n.primengTableHelper.totalRecordsCount))},dependencies:[f.O5,d.Hz,d.Mq,d.TO,b.A,v.U,x.iA,R.jx,A.Z,C.$,U,I.n,h.F,Q.a,D.G],encapsulation:2,data:{animation:[(0,y.MH)()]}})}return t})(),pathMatch:"full"}];let ne=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#o=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(oe),m.Bz]})}return t})();var ie=l(71902),le=l(92337);let ae=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#o=this.\u0275inj=e.cJS({imports:[le.o,ie.g,ne]})}return t})()}}]);