"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[28457],{28457:(E,f,r)=>{r.r(f),r.d(f,{AuditLogsModule:()=>ge});var L=r(71902),i=r(92337),T=r(70916),v=r(47530),h=r(41840),x=r(90864),e=r(99468),b=r(44328),y=r(98547),C=r(58399),Z=r(96814),u=r(56223),p=r(612),A=r(53279),s=r(96655),d=r(94901),m=r(81243),_=r(68027),q=r(85219),D=r(51712),N=r(68989),w=r(24142),M=r(3291);const z=["auditLogDetailModal"];function S(n,c){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"AuditLogDetail")))}function O(n,c){1&n&&(e.TgZ(0,"div",12),e._UZ(1,"label",13),e.TgZ(2,"div",23)(3,"span"),e._uU(4),e.ALo(5,"localize"),e.qZA()()()),2&n&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"AuditLogImpersonatedOperationInfo")))}function H(n,c){if(1&n&&(e.TgZ(0,"div",16)(1,"pre"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.auditLog.customData)}}function J(n,c){1&n&&(e.TgZ(0,"label",24),e._UZ(1,"i",25),e._uU(2),e.ALo(3,"localize"),e.qZA()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Success")," "))}function j(n,c){if(1&n&&(e.TgZ(0,"div",26)(1,"pre"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.auditLog.exception)}}function I(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"form",null,5)(2,"div",6)(3,"h4",7),e.YNc(4,S,3,3,"span",4),e.qZA(),e.TgZ(5,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.close())}),e.qZA()(),e.TgZ(6,"div",9)(7,"h3"),e._uU(8),e.ALo(9,"localize"),e.qZA(),e.TgZ(10,"div",10)(11,"div",11)(12,"div",12)(13,"label",13),e._uU(14),e.ALo(15,"localize"),e.qZA(),e.TgZ(16,"div",14)(17,"span"),e._uU(18),e.qZA()()(),e.TgZ(19,"div",12)(20,"label",13),e._uU(21),e.ALo(22,"localize"),e.qZA(),e.TgZ(23,"div",14)(24,"span"),e._uU(25),e.qZA()()(),e.TgZ(26,"div",12)(27,"label",13),e._uU(28),e.ALo(29,"localize"),e.qZA(),e.TgZ(30,"div",14)(31,"span"),e._uU(32),e.qZA()()(),e.TgZ(33,"div",12)(34,"label",13),e._uU(35),e.ALo(36,"localize"),e.qZA(),e.TgZ(37,"div",14)(38,"span"),e._uU(39),e.qZA()()(),e.YNc(40,O,6,3,"div",15),e.qZA()(),e.TgZ(41,"h3"),e._uU(42),e.ALo(43,"localize"),e.qZA(),e.TgZ(44,"div",10)(45,"div",11)(46,"div",12)(47,"label",13),e._uU(48),e.ALo(49,"localize"),e.qZA(),e.TgZ(50,"div",14)(51,"span"),e._uU(52),e.qZA()()()(),e.TgZ(53,"div",11)(54,"div",12)(55,"label",13),e._uU(56),e.ALo(57,"localize"),e.qZA(),e.TgZ(58,"div",14)(59,"span"),e._uU(60),e.qZA()()()(),e.TgZ(61,"div",11)(62,"div",12)(63,"label",13),e._uU(64),e.ALo(65,"localize"),e.qZA(),e.TgZ(66,"div",14)(67,"span"),e._uU(68),e.qZA()()()(),e.TgZ(69,"div",11)(70,"div",12)(71,"label",13),e._uU(72),e.ALo(73,"localize"),e.qZA(),e.TgZ(74,"div",14)(75,"span"),e._uU(76),e.qZA()()(),e.TgZ(77,"div",12)(78,"label",13),e._uU(79),e.ALo(80,"localize"),e.qZA(),e.TgZ(81,"div",16)(82,"pre",17),e._uU(83),e.qZA()()()()(),e.TgZ(84,"h3"),e._uU(85),e.ALo(86,"localize"),e.qZA(),e.TgZ(87,"div",10)(88,"div",11)(89,"div",12)(90,"label",13),e._uU(91),e.ALo(92,"localize"),e.qZA(),e.YNc(93,H,3,1,"div",18),e.qZA()()(),e.TgZ(94,"h3"),e._uU(95),e.ALo(96,"localize"),e.qZA(),e.TgZ(97,"div",10)(98,"div",11)(99,"div",12),e.YNc(100,J,4,3,"label",19),e.YNc(101,j,3,1,"div",20),e.qZA()()()(),e.TgZ(102,"div",21)(103,"button",22),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.close())}),e._uU(104),e.ALo(105,"localize"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.auditLog.userId),e.xp6(1),e.uIk("aria-label",t.l("Close")),e.xp6(3),e.hij(" ",e.lcZ(9,30,"UserInformations")," "),e.xp6(6),e.hij("",e.lcZ(15,32,"UserName"),":"),e.xp6(4),e.Oqu(t.auditLog.userName),e.xp6(3),e.hij("",e.lcZ(22,34,"IpAddress"),":"),e.xp6(4),e.Oqu(t.auditLog.clientIpAddress),e.xp6(3),e.hij("",e.lcZ(29,36,"Client"),":"),e.xp6(4),e.Oqu(t.auditLog.clientName),e.xp6(3),e.hij("",e.lcZ(36,38,"Browser"),":"),e.xp6(4),e.Oqu(t.auditLog.browserInfo),e.xp6(1),e.Q6J("ngIf",t.auditLog.impersonatorUserId),e.xp6(2),e.Oqu(e.lcZ(43,40,"ActionInformations")),e.xp6(6),e.hij("",e.lcZ(49,42,"Service"),":"),e.xp6(4),e.Oqu(t.auditLog.serviceName),e.xp6(4),e.hij("",e.lcZ(57,44,"Action"),":"),e.xp6(4),e.Oqu(t.auditLog.methodName),e.xp6(4),e.hij("",e.lcZ(65,46,"Time"),":"),e.xp6(4),e.Oqu(t.getExecutionTime()),e.xp6(4),e.hij("",e.lcZ(73,48,"Duration"),":"),e.xp6(4),e.Oqu(t.getDurationAsMs()),e.xp6(3),e.hij("",e.lcZ(80,50,"Parameters"),":"),e.xp6(4),e.Oqu(t.getFormattedParameters()),e.xp6(2),e.Oqu(e.lcZ(86,52,"CustomData")),e.xp6(6),e.hij("",e.lcZ(92,54,"None"),":"),e.xp6(2),e.Q6J("ngIf",t.auditLog.customData),e.xp6(2),e.Oqu(e.lcZ(96,56,"ErrorState")),e.xp6(5),e.Q6J("ngIf",!t.auditLog.exception),e.xp6(1),e.Q6J("ngIf",t.auditLog.exception),e.xp6(3),e.hij(" ",e.lcZ(105,58,"Close")," ")}}const R=function(){return{backdrop:"static"}};let F=(()=>{class n extends h.c{constructor(t,a){super(t),this._dateTimeService=a,this.active=!1}getExecutionTime(){return this._dateTimeService.fromNow(this.auditLog.executionTime)+" ("+this._dateTimeService.formatDate(this.auditLog.executionTime,"yyyy-LL-dd HH:mm:ss")+")"}getDurationAsMs(){return this.l("Xms",this.auditLog.executionDuration)}getFormattedParameters(){const t=this;try{const a=JSON.parse(t.auditLog.parameters);return JSON.stringify(a,null,4)}catch{return t.auditLog.parameters}}show(t){const a=this;a.active=!0,a.auditLog=t,a.modal.show()}close(){this.active=!1,this.modal.hide()}static#e=this.\u0275fac=function(a){return new(a||n)(e.Y36(e.zs3),e.Y36(C.C))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["auditLogDetailModal"]],viewQuery:function(a,o){if(1&a&&e.Gf(z,7),2&a){let l;e.iGM(l=e.CRH())&&(o.modal=l.first)}},features:[e.qOj],decls:5,vars:3,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","auditLogDetailModal","aria-hidden","true",1,"modal","fade",3,"config"],["auditLogDetailModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[4,"ngIf"],["roleForm","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[1,"mb-5","row"],[1,"col-lg-3","col-form-label"],[1,"col-lg-9"],["class","mb-5 row",4,"ngIf"],[1,"col-lg-9","alert","alert-warning"],["lang","js"],["class","col-lg-9 alert alert-warning",4,"ngIf"],["class","col-lg-12 col-form-label",4,"ngIf"],["class","col-lg-12 alert alert-warning",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],[1,"col-lg-9","text-warning"],[1,"col-lg-12","col-form-label"],[1,"fa","fa-check-circle","text-success"],[1,"col-lg-12","alert","alert-warning"]],template:function(a,o){1&a&&(e.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3),e.YNc(4,I,106,60,"form",4),e.qZA()()()),2&a&&(e.Q6J("config",e.DdM(2,R)),e.xp6(4),e.Q6J("ngIf",o.active))},dependencies:[Z.O5,u._Y,u.JL,u.F,w.Z,M.F],encapsulation:2})}return n})();var P=r(88922);const Q=["auditLogDetailModal"],Y=["entityChangeDetailModal"],G=["dataTableAuditLogs"],k=["dataTableEntityChanges"],B=["paginatorAuditLogs"],K=["paginatorEntityChanges"];function W(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",50)(1,"div",15)(2,"div",16)(3,"label",51),e._uU(4),e.ALo(5,"localize"),e.qZA(),e.TgZ(6,"input",52),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.serviceName=o)}),e.qZA()()(),e.TgZ(7,"div",15)(8,"label",53),e._uU(9),e.ALo(10,"localize"),e.qZA(),e.TgZ(11,"div",54)(12,"input",55),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.minExecutionDuration=o)}),e.qZA(),e.TgZ(13,"span",56),e._uU(14,"---"),e.qZA(),e.TgZ(15,"input",57),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.maxExecutionDuration=o)}),e.qZA()()(),e.TgZ(16,"div",15)(17,"div",16)(18,"label",58),e._uU(19),e.ALo(20,"localize"),e.qZA(),e.TgZ(21,"input",59),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.methodName=o)}),e.qZA()()(),e.TgZ(22,"div",15)(23,"div",16)(24,"label",60),e._uU(25),e.ALo(26,"localize"),e.qZA(),e.TgZ(27,"select",61),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.hasException=o)}),e.TgZ(28,"option",62),e._uU(29),e.ALo(30,"localize"),e.qZA(),e.TgZ(31,"option",63),e._uU(32),e.ALo(33,"localize"),e.qZA(),e.TgZ(34,"option",64),e._uU(35),e.ALo(36,"localize"),e.qZA()()()(),e.TgZ(37,"div",15)(38,"div",16)(39,"label",65),e._uU(40),e.ALo(41,"localize"),e.qZA(),e.TgZ(42,"input",66),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.browserInfo=o)}),e.qZA()()(),e.TgZ(43,"div",15),e._UZ(44,"div",16),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,14,"Service")," "),e.xp6(2),e.Q6J("ngModel",t.serviceName),e.xp6(3),e.Oqu(e.lcZ(10,16,"Duration")),e.xp6(3),e.Q6J("ngModel",t.minExecutionDuration),e.xp6(3),e.Q6J("ngModel",t.maxExecutionDuration),e.xp6(4),e.Oqu(e.lcZ(20,18,"Action")),e.xp6(2),e.Q6J("ngModel",t.methodName),e.xp6(4),e.hij(" ",e.lcZ(26,20,"ErrorState")," "),e.xp6(2),e.Q6J("ngModel",t.hasException),e.xp6(2),e.Oqu(e.lcZ(30,22,"All")),e.xp6(3),e.Oqu(e.lcZ(33,24,"Success")),e.xp6(3),e.Oqu(e.lcZ(36,26,"HasError")),e.xp6(5),e.hij(" ",e.lcZ(41,28,"Browser")," "),e.xp6(2),e.Q6J("ngModel",t.browserInfo)}}function $(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"span",67),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.advancedFiltersAreShown=!o.advancedFiltersAreShown)}),e._UZ(1,"i",68),e._uU(2),e.ALo(3,"localize"),e.qZA()}2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"ShowAdvancedFilters")," "))}function X(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"span",67),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.advancedFiltersAreShown=!o.advancedFiltersAreShown)}),e._UZ(1,"i",69),e._uU(2),e.ALo(3,"localize"),e.qZA()}2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"HideAdvancedFilters")," "))}function V(n,c){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",70)(2,"th",70),e.TgZ(3,"th",71),e._uU(4),e.ALo(5,"localize"),e._UZ(6,"p-sortIcon",72),e.qZA(),e.TgZ(7,"th",73),e._uU(8),e.ALo(9,"localize"),e.qZA(),e.TgZ(10,"th",73),e._uU(11),e.ALo(12,"localize"),e.qZA(),e.TgZ(13,"th",74),e._uU(14),e.ALo(15,"localize"),e._UZ(16,"p-sortIcon",75),e.qZA(),e.TgZ(17,"th",76),e._uU(18),e.ALo(19,"localize"),e.qZA(),e.TgZ(20,"th",76),e._uU(21),e.ALo(22,"localize"),e.qZA(),e.TgZ(23,"th",76),e._uU(24),e.ALo(25,"localize"),e.qZA(),e.TgZ(26,"th",77),e._uU(27),e.ALo(28,"localize"),e._UZ(29,"p-sortIcon",78),e.qZA()()),2&n&&(e.xp6(4),e.hij(" ",e.lcZ(5,8,"UserName")," "),e.xp6(4),e.hij(" ",e.lcZ(9,10,"Service")," "),e.xp6(3),e.hij(" ",e.lcZ(12,12,"Action")," "),e.xp6(3),e.hij(" ",e.lcZ(15,14,"Duration")," "),e.xp6(4),e.hij(" ",e.lcZ(19,16,"IpAddress")," "),e.xp6(3),e.hij(" ",e.lcZ(22,18,"Client")," "),e.xp6(3),e.hij(" ",e.lcZ(25,20,"Browser")," "),e.xp6(3),e.hij(" ",e.lcZ(28,22,"Time")," "))}function ee(n,c){1&n&&e._UZ(0,"i",86)}function te(n,c){1&n&&e._UZ(0,"i",87)}function ie(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",70)(2,"div",79)(3,"button",80),e.NdJ("click",function(){const l=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.showAuditLogDetails(l))}),e._UZ(4,"i",81),e.qZA()()(),e.TgZ(5,"td",70)(6,"div",79),e.YNc(7,ee,1,0,"i",82),e.YNc(8,te,1,0,"i",83),e.qZA()(),e.TgZ(9,"td",76)(10,"span",84),e._uU(11),e.ALo(12,"localize"),e.qZA(),e._uU(13),e.qZA(),e.TgZ(14,"td",73)(15,"span",84),e._uU(16),e.ALo(17,"localize"),e.qZA(),e._uU(18),e.qZA(),e.TgZ(19,"td",73)(20,"span",84),e._uU(21),e.ALo(22,"localize"),e.qZA(),e._uU(23),e.qZA(),e.TgZ(24,"td",85),e._uU(25),e.TgZ(26,"span",84),e._uU(27),e.ALo(28,"localize"),e.qZA()(),e.TgZ(29,"td",76)(30,"span",84),e._uU(31),e.ALo(32,"localize"),e.qZA(),e._uU(33),e.qZA(),e.TgZ(34,"td",76)(35,"span",84),e._uU(36),e.ALo(37,"localize"),e.qZA(),e._uU(38),e.qZA(),e.TgZ(39,"td",76)(40,"span",84),e._uU(41),e.ALo(42,"localize"),e.qZA(),e.TgZ(43,"span",0),e._uU(44),e.qZA()(),e.TgZ(45,"td",76)(46,"span",84),e._uU(47),e.ALo(48,"localize"),e.qZA(),e._uU(49),e.ALo(50,"luxonFormat"),e.qZA()()}if(2&n){const t=c.$implicit,a=e.oxw();e.xp6(4),e.uIk("aria-label",a.l("Search")),e.xp6(3),e.Q6J("ngIf",t.exception),e.xp6(1),e.Q6J("ngIf",!t.exception),e.xp6(3),e.Oqu(e.lcZ(12,20,"UserName")),e.xp6(2),e.hij(" ",t.userName," "),e.xp6(3),e.Oqu(e.lcZ(17,22,"Service")),e.xp6(2),e.hij(" ",t.serviceName," "),e.xp6(3),e.Oqu(e.lcZ(22,24,"Action")),e.xp6(2),e.hij(" ",t.methodName," "),e.xp6(2),e.hij(" ",t.executionDuration,"ms "),e.xp6(2),e.Oqu(e.lcZ(28,26,"Duration")),e.xp6(4),e.Oqu(e.lcZ(32,28,"IpAddress")),e.xp6(2),e.hij(" ",t.clientIpAddress," "),e.xp6(3),e.Oqu(e.lcZ(37,30,"Client")),e.xp6(2),e.hij(" ",t.clientName," "),e.xp6(3),e.Oqu(e.lcZ(42,32,"Browser")),e.xp6(2),e.s9C("title",t.browserInfo),e.xp6(1),e.hij(" ",a.truncateStringWithPostfix(t.browserInfo,20)," "),e.xp6(3),e.Oqu(e.lcZ(48,34,"Time")),e.xp6(2),e.hij(" ",e.xi3(50,36,t.executionTime,"F")," ")}}function oe(n,c){1&n&&(e.TgZ(0,"div",88),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}function ne(n,c){if(1&n&&(e.TgZ(0,"option",89),e._uU(1),e.qZA()),2&n){const t=c.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function ae(n,c){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",90),e.TgZ(2,"th",76),e._uU(3),e.ALo(4,"localize"),e.qZA(),e.TgZ(5,"th",73),e._uU(6),e.ALo(7,"localize"),e.qZA(),e.TgZ(8,"th",71),e._uU(9),e.ALo(10,"localize"),e._UZ(11,"p-sortIcon",72),e.qZA(),e.TgZ(12,"th",91),e._uU(13),e.ALo(14,"localize"),e._UZ(15,"p-sortIcon",92),e.qZA()()),2&n&&(e.xp6(3),e.hij(" ",e.lcZ(4,4,"Action")," "),e.xp6(3),e.hij(" ",e.lcZ(7,6,"Object")," "),e.xp6(3),e.hij(" ",e.lcZ(10,8,"UserName")," "),e.xp6(4),e.hij(" ",e.lcZ(14,10,"Time")," "))}function le(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",90)(2,"div",79)(3,"button",80),e.NdJ("click",function(){const l=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.showEntityChangeDetails(l))}),e._UZ(4,"i",81),e.qZA()()(),e.TgZ(5,"td",76)(6,"span",84),e._uU(7),e.ALo(8,"localize"),e.qZA(),e.TgZ(9,"span",0),e._uU(10),e.qZA()(),e.TgZ(11,"td",73)(12,"span",84),e._uU(13),e.ALo(14,"localize"),e.qZA(),e._uU(15),e.qZA(),e.TgZ(16,"td",76)(17,"span",84),e._uU(18),e.ALo(19,"localize"),e.qZA(),e._uU(20),e.qZA(),e.TgZ(21,"td",76)(22,"span",84),e._uU(23),e.ALo(24,"localize"),e.qZA(),e._uU(25),e.ALo(26,"luxonFormat"),e.qZA()()}if(2&n){const t=c.$implicit,a=e.oxw();e.xp6(4),e.uIk("aria-label",a.l("Search")),e.xp6(3),e.Oqu(e.lcZ(8,10,"Action")),e.xp6(2),e.s9C("title",t.changeTypeName),e.xp6(1),e.hij(" ",a.l(t.changeTypeName)," "),e.xp6(3),e.Oqu(e.lcZ(14,12,"Object")),e.xp6(2),e.hij(" ",t.entityTypeFullName," "),e.xp6(3),e.Oqu(e.lcZ(19,14,"UserName")),e.xp6(2),e.hij(" ",t.userName," "),e.xp6(3),e.Oqu(e.lcZ(24,16,"Time")),e.xp6(2),e.hij(" ",e.xi3(26,18,t.changeTime,"yyyy-LL-dd HH:mm:ss")," ")}}function re(n,c){1&n&&(e.TgZ(0,"div",88),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const U=function(){return{"min-width":"50rem"}},se=[{path:"",component:(()=>{class n extends h.c{constructor(t,a,o,l){super(t),this._auditLogService=a,this._fileDownloadService=o,this._dateTimeService=l,this.dateRange=[this._dateTimeService.getStartOfDay(),this._dateTimeService.getEndOfDay()],this.hasException=void 0,this.primengTableHelperAuditLogs=new x.f,this.primengTableHelperEntityChanges=new x.f,this.advancedFiltersAreShown=!1}ngAfterViewInit(){this.primengTableHelper.adjustScroll(this.dataTableAuditLogs),this.primengTableHelper.adjustScroll(this.dataTableEntityChanges)}showAuditLogDetails(t){this.auditLogDetailModal.show(t)}showEntityChangeDetails(t){this.entityChangeDetailModal.show(t)}getAuditLogs(t){this.primengTableHelperAuditLogs.shouldResetPaging(t)&&(this.paginatorAuditLogs.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0)||(this.primengTableHelperAuditLogs.showLoadingIndicator(),this._auditLogService.getAuditLogs(this._dateTimeService.getStartOfDayForDate(this.dateRange[0]),this._dateTimeService.getEndOfDayForDate(this.dateRange[1]),this.usernameAuditLog,this.serviceName,this.methodName,this.browserInfo,this.hasException,this.minExecutionDuration,this.maxExecutionDuration,this.primengTableHelperAuditLogs.getSorting(this.dataTableAuditLogs),this.primengTableHelperAuditLogs.getMaxResultCount(this.paginatorAuditLogs,t),this.primengTableHelperAuditLogs.getSkipCount(this.paginatorAuditLogs,t)).subscribe(a=>{this.primengTableHelperAuditLogs.totalRecordsCount=a.totalCount,this.primengTableHelperAuditLogs.records=a.items,this.primengTableHelperAuditLogs.hideLoadingIndicator()}))}getEntityChanges(t){this._auditLogService.getEntityHistoryObjectTypes().subscribe(a=>{this.objectTypes=a}),!(this.primengTableHelperEntityChanges.shouldResetPaging(t)&&(this.paginatorEntityChanges.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0))&&(this.primengTableHelperEntityChanges.showLoadingIndicator(),this._auditLogService.getEntityChanges(this._dateTimeService.getStartOfDayForDate(this.dateRange[0]),this._dateTimeService.getEndOfDayForDate(this.dateRange[1]),this.usernameEntityChange,this.entityTypeFullName,this.primengTableHelperEntityChanges.getSorting(this.dataTableEntityChanges),this.primengTableHelperEntityChanges.getMaxResultCount(this.paginatorEntityChanges,t),this.primengTableHelperEntityChanges.getSkipCount(this.paginatorEntityChanges,t)).subscribe(a=>{this.primengTableHelperEntityChanges.totalRecordsCount=a.totalCount,this.primengTableHelperEntityChanges.records=a.items,this.primengTableHelperEntityChanges.hideLoadingIndicator()}))}exportToExcelAuditLogs(){const t=this;t._auditLogService.getAuditLogsToExcel(this._dateTimeService.getStartOfDayForDate(t.dateRange[0]),this._dateTimeService.getEndOfDayForDate(t.dateRange[1]),t.usernameAuditLog,t.serviceName,t.methodName,t.browserInfo,t.hasException,t.minExecutionDuration,t.maxExecutionDuration,void 0,1,0).subscribe(a=>{t._fileDownloadService.downloadTempFile(a)})}exportToExcelEntityChanges(){const t=this;t._auditLogService.getEntityChangesToExcel(this._dateTimeService.getStartOfDayForDate(t.dateRange[0]),t._dateTimeService.getEndOfDayForDate(t.dateRange[1]),t.usernameEntityChange,t.entityTypeFullName,void 0,1,0).subscribe(a=>{t._fileDownloadService.downloadTempFile(a)})}truncateStringWithPostfix(t,a){return abp.utils.truncateStringWithPostfix(t,a)}static#e=this.\u0275fac=function(a){return new(a||n)(e.Y36(e.zs3),e.Y36(b.xWy),e.Y36(y._),e.Y36(C.C))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(a,o){if(1&a&&(e.Gf(Q,7),e.Gf(Y,7),e.Gf(G,7),e.Gf(k,7),e.Gf(B,7),e.Gf(K,7)),2&a){let l;e.iGM(l=e.CRH())&&(o.auditLogDetailModal=l.first),e.iGM(l=e.CRH())&&(o.entityChangeDetailModal=l.first),e.iGM(l=e.CRH())&&(o.dataTableAuditLogs=l.first),e.iGM(l=e.CRH())&&(o.dataTableEntityChanges=l.first),e.iGM(l=e.CRH())&&(o.paginatorAuditLogs=l.first),e.iGM(l=e.CRH())&&(o.paginatorEntityChanges=l.first)}},features:[e.qOj],decls:110,vars:83,consts:[[3,"title"],[1,"card","card-custom","gutter-b"],[1,"card-body"],[3,"heading"],[1,"row","m-2","mt-5"],[1,"col-sm-12","text-end"],["type","button",1,"btn","btn-primary","float-end",3,"click"],[1,"fa","fa-sync","btn-md-icon"],[1,"d-none","d-md-inline-block"],["type","button",1,"btn","btn-success","float-end","me-1",3,"click"],[1,"far","fa-file-excel","btn-md-icon"],[1,"form"],[3,"ngSubmit"],["auditFilterForm","ngForm"],[1,"row","align-items-center","mb-2"],[1,"col-md-6"],[1,"mb-5"],["for","StartEndRange",1,"form-label"],["id","StartEndRange","name","StartEndRange","readonly","readonly","bsDaterangepicker","","dateRangePickerLuxonModifier","",1,"form-control",3,"date","dateChange"],["drp","bsDaterangepicker"],["for","UsernameAuditLog",1,"form-label"],["id","UsernameAuditLog","type","text","name","UsernameAuditLog",1,"form-control",3,"ngModel","ngModelChange"],["class","row",4,"ngIf"],[1,"row","mb-2"],[1,"col-sm-6"],["class","clickable-item text-muted",3,"click",4,"ngIf"],[1,"row","align-items-center"],[1,"primeng-datatable-container",3,"busyIf"],["sortMode","multiple","scrollable","true","ScrollWidth","100%","resizableColumns","primengTableHelperAuditLogs.resizableColumns",3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTableAuditLogs",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginatorAuditLogs",""],["entityChangeFilterForm","ngForm"],["for","StartEndRangeEntityChange",1,"form-label"],["id","StartEndRangeEntityChange","name","StartEndRangeEntityChange","readonly","readonly","bsDaterangepicker","","dateRangePickerLuxonModifier","",1,"form-control",3,"date","dateChange"],["for","UserNameEntityChange",1,"form-label"],["id","UserNameEntityChange","type","text","name","UserNameEntityChange",1,"form-control",3,"ngModel","ngModelChange"],["for","EntityTypeFullName",1,"form-label"],["id","EntityTypeFullName","name","EntityTypeFullName",1,"form-control",3,"ngModel","ngModelChange"],["value","undefined","selected","selected"],[3,"value",4,"ngFor","ngForOf"],["sortMode","multiple","scrollable","true","ScrollWidth","100%","resizableColumns","primengTableHelperEntityChanges.resizableColumns",3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTableEntityChanges",""],["paginatorEntityChanges",""],["auditLogDetailModal",""],["entityChangeDetailModal",""],[1,"row"],["for","ServiceName",1,"form-label"],["id","ServiceName","name","ServiceName","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-label","d-block"],[1,"input-group",2,"width","250px !important"],["type","text","name","MinExecutionDuration","only-number","","min","0","max","86400000","ng-minlength","0","ng-maxlength","8",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-text"],["type","text","name","MaxExecutionDuration","only-number","","min","0","max","86400000","ng-minlength","0","ng-maxlength","8",1,"form-control",3,"ngModel","ngModelChange"],["for","MethodName",1,"form-label"],["id","MethodName","type","text","name","MethodName",1,"form-control",3,"ngModel","ngModelChange"],["for","HasException",1,"form-label"],["id","HasException","name","HasException",1,"form-control",3,"ngModel","ngModelChange"],["value",""],["value","false"],["value","true"],["for","BrowserInfo",1,"form-label"],["id","BrowserInfo","type","text","name","BrowserInfo",1,"form-control",3,"ngModel","ngModelChange"],[1,"clickable-item","text-muted",3,"click"],[1,"fa","fa-angle-down"],[1,"fa","fa-angle-up"],[2,"width","75px"],["pSortableColumn","userName",2,"width","150px"],["field","userName"],[2,"width","250px"],["pSortableColumn","executionDuration",2,"width","100px"],["field","executionDuration"],[2,"width","150px"],["pSortableColumn","executionTime",2,"width","150px"],["field","executionTime"],[1,"text-center"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm",3,"click"],[1,"la","la-search"],["class","fa fa-exclamation-triangle text-warning",4,"ngIf"],["class","fa fa-check-circle text-success",4,"ngIf"],[1,"p-column-title"],[2,"width","100px"],[1,"fa","fa-exclamation-triangle","text-warning"],[1,"fa","fa-check-circle","text-success"],[1,"primeng-no-data"],[3,"value"],[2,"width","40px"],["pSortableColumn","changeTime",2,"width","150px"],["field","changeTime"]],template:function(a,o){1&a&&(e.TgZ(0,"div"),e._UZ(1,"sub-header",0),e.ALo(2,"localize"),e.TgZ(3,"div")(4,"div",1)(5,"div",2)(6,"tabset")(7,"tab",3),e.ALo(8,"localize"),e.TgZ(9,"div",4)(10,"div",5)(11,"button",6),e.NdJ("click",function(){return o.getAuditLogs()}),e._UZ(12,"i",7),e.TgZ(13,"span",8),e._uU(14),e.ALo(15,"localize"),e.qZA()(),e.TgZ(16,"button",9),e.NdJ("click",function(){return o.exportToExcelAuditLogs()}),e._UZ(17,"i",10),e.TgZ(18,"span",8),e._uU(19),e.ALo(20,"localize"),e.qZA()()()(),e.TgZ(21,"div",11)(22,"form",12,13),e.NdJ("ngSubmit",function(){return o.getAuditLogs()}),e.TgZ(24,"div",14)(25,"div",15)(26,"div",16)(27,"label",17),e._uU(28),e.ALo(29,"localize"),e.qZA(),e.TgZ(30,"input",18,19),e.NdJ("dateChange",function(g){return o.dateRange=g}),e.qZA()()(),e.TgZ(32,"div",15)(33,"div",16)(34,"label",20),e._uU(35),e.ALo(36,"localize"),e.qZA(),e.TgZ(37,"input",21),e.NdJ("ngModelChange",function(g){return o.usernameAuditLog=g}),e.qZA()()()(),e.YNc(38,W,45,30,"div",22),e.TgZ(39,"div",23)(40,"div",24),e.YNc(41,$,4,3,"span",25),e.YNc(42,X,4,3,"span",25),e.qZA()()()(),e.TgZ(43,"div",26)(44,"div",27)(45,"p-table",28,29),e.NdJ("onLazyLoad",function(g){return o.getAuditLogs(g)}),e.YNc(47,V,30,24,"ng-template",30),e.YNc(48,ie,51,39,"ng-template",31),e.qZA(),e.YNc(49,oe,3,3,"div",32),e.TgZ(50,"div",33)(51,"p-paginator",34,35),e.NdJ("onPageChange",function(g){return o.getAuditLogs(g)}),e.ALo(53,"localize"),e.qZA()()()()(),e.TgZ(54,"tab",3),e.ALo(55,"localize"),e.TgZ(56,"div",4)(57,"div",5)(58,"button",6),e.NdJ("click",function(){return o.getEntityChanges()}),e._UZ(59,"i",7),e.TgZ(60,"span",8),e._uU(61),e.ALo(62,"localize"),e.qZA()(),e.TgZ(63,"button",9),e.NdJ("click",function(){return o.exportToExcelEntityChanges()}),e._UZ(64,"i",10),e.TgZ(65,"span",8),e._uU(66),e.ALo(67,"localize"),e.qZA()()()(),e.TgZ(68,"div",11)(69,"form",12,36),e.NdJ("ngSubmit",function(){return o.getEntityChanges()}),e.TgZ(71,"div",14)(72,"div",15)(73,"div",16)(74,"label",37),e._uU(75),e.ALo(76,"localize"),e.qZA(),e.TgZ(77,"input",38,19),e.NdJ("dateChange",function(g){return o.dateRange=g}),e.qZA()()(),e.TgZ(79,"div",15)(80,"div",16)(81,"label",39),e._uU(82),e.ALo(83,"localize"),e.qZA(),e.TgZ(84,"input",40),e.NdJ("ngModelChange",function(g){return o.usernameEntityChange=g}),e.qZA()()(),e.TgZ(85,"div",15)(86,"div",16)(87,"label",41),e._uU(88),e.ALo(89,"localize"),e.qZA(),e.TgZ(90,"select",42),e.NdJ("ngModelChange",function(g){return o.entityTypeFullName=g}),e.TgZ(91,"option",43),e._uU(92),e.ALo(93,"localize"),e.qZA(),e.YNc(94,ne,2,2,"option",44),e.qZA()()()()()(),e.TgZ(95,"div",26)(96,"div",27)(97,"p-table",45,46),e.NdJ("onLazyLoad",function(g){return o.getEntityChanges(g)}),e.YNc(99,ae,16,12,"ng-template",30),e.YNc(100,le,27,21,"ng-template",31),e.qZA(),e.YNc(101,re,3,3,"div",32),e.TgZ(102,"div",33)(103,"p-paginator",34,47),e.NdJ("onPageChange",function(g){return o.getEntityChanges(g)}),e.ALo(105,"localize"),e.qZA()()()()()()()()(),e._UZ(106,"auditLogDetailModal",null,48)(108,"entityChangeDetailModal",null,49),e.qZA()),2&a&&(e.Q6J("@routerTransition",void 0),e.xp6(1),e.Q6J("title",e.lcZ(2,49,"AuditLogs")),e.xp6(2),e.Tol(o.containerClass),e.xp6(4),e.s9C("heading",e.lcZ(8,51,"OperationLogs")),e.xp6(7),e.hij(" ",e.lcZ(15,53,"Refresh")," "),e.xp6(5),e.hij(" ",e.lcZ(20,55,"ExportToExcel")," "),e.xp6(9),e.hij(" ",e.lcZ(29,57,"DateRange")," "),e.xp6(2),e.Q6J("date",o.dateRange),e.xp6(5),e.hij(" ",e.lcZ(36,59,"UserName")," "),e.xp6(2),e.Q6J("ngModel",o.usernameAuditLog),e.xp6(1),e.Q6J("ngIf",o.advancedFiltersAreShown),e.xp6(3),e.Q6J("ngIf",!o.advancedFiltersAreShown),e.xp6(1),e.Q6J("ngIf",o.advancedFiltersAreShown),e.xp6(2),e.Q6J("busyIf",o.primengTableHelperAuditLogs.isLoading),e.xp6(1),e.s9C("rows",o.primengTableHelperAuditLogs.defaultRecordsCountPerPage),e.Q6J("value",o.primengTableHelperAuditLogs.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(81,U)),e.xp6(4),e.Q6J("ngIf",0==o.primengTableHelperAuditLogs.totalRecordsCount),e.xp6(2),e.Q6J("rows",o.primengTableHelperAuditLogs.defaultRecordsCountPerPage)("totalRecords",o.primengTableHelperAuditLogs.totalRecordsCount)("rowsPerPageOptions",o.primengTableHelperAuditLogs.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(53,61,"TotalRecordsCount",o.primengTableHelperAuditLogs.totalRecordsCount)),e.xp6(3),e.s9C("heading",e.lcZ(55,64,"ChangeLogs")),e.xp6(7),e.hij(" ",e.lcZ(62,66,"Refresh")," "),e.xp6(5),e.hij(" ",e.lcZ(67,68,"ExportToExcel")," "),e.xp6(9),e.hij(" ",e.lcZ(76,70,"DateRange")," "),e.xp6(2),e.Q6J("date",o.dateRange),e.xp6(5),e.hij(" ",e.lcZ(83,72,"UserName")," "),e.xp6(2),e.Q6J("ngModel",o.usernameEntityChange),e.xp6(4),e.hij(" ",e.lcZ(89,74,"Object")," "),e.xp6(2),e.Q6J("ngModel",o.entityTypeFullName),e.xp6(2),e.hij(" ",e.lcZ(93,76,"All")," "),e.xp6(2),e.Q6J("ngForOf",o.objectTypes),e.xp6(2),e.Q6J("busyIf",o.primengTableHelperEntityChanges.isLoading),e.xp6(1),e.s9C("rows",o.primengTableHelperEntityChanges.defaultRecordsCountPerPage),e.Q6J("value",o.primengTableHelperEntityChanges.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(82,U)),e.xp6(4),e.Q6J("ngIf",0==o.primengTableHelperEntityChanges.totalRecordsCount),e.xp6(2),e.Q6J("rows",o.primengTableHelperEntityChanges.defaultRecordsCountPerPage)("totalRecords",o.primengTableHelperEntityChanges.totalRecordsCount)("rowsPerPageOptions",o.primengTableHelperEntityChanges.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(105,78,"TotalRecordsCount",o.primengTableHelperEntityChanges.totalRecordsCount)))},dependencies:[Z.sg,Z.O5,u._Y,u.YN,u.Kr,u.Fj,u.EJ,u.JJ,u.JL,u.On,u.F,p.wW,p.AH,A.FR,A.TB,s.S,d.U,m.t,_.iA,q.jx,_.lQ,_.fz,D.D,N.$,F,P.n,M.F],styles:[".audit-log-detail-view h3.form-section{margin-top:5px}.audit-log-detail-view .form-group{margin-bottom:0}.audit-log-detail-view .form-group p.form-control-static{margin:0}.audit-log-detail-view .form-group .control-label{font-weight:700}\n"],encapsulation:2,data:{animation:[(0,v.MH)()]}})}return n})(),pathMatch:"full"}];let de=(()=>{class n{static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({imports:[T.Bz.forChild(se),T.Bz]})}return n})(),ge=(()=>{class n{static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({imports:[i.o,L.g,de]})}return n})()},96655:(E,f,r)=>{r.d(f,{S:()=>u});var L=r(41840),i=r(99468),T=r(44328),v=r(58399),h=r(96814),x=r(24142),e=r(3291);const b=["entityChangeDetailModal"];function y(p,A){if(1&p){const s=i.EpF();i.TgZ(0,"div",9)(1,"h4",10)(2,"span"),i._uU(3),i.ALo(4,"localize"),i.ALo(5,"localize"),i.qZA(),i._UZ(6,"br")(7,"small",11),i.qZA(),i.TgZ(8,"button",12),i.NdJ("click",function(){i.CHM(s);const m=i.oxw();return i.KtG(m.close())}),i.qZA()()}if(2&p){const s=i.oxw();i.xp6(3),i.AsE("",i.lcZ(4,4,"Detail")," - ",i.lcZ(5,6,s.entityChange.entityTypeFullName),""),i.xp6(4),i.Q6J("innerHTML",s.l("CreatedAtByUser",s.entityChange.changeTime,s.entityChange.userName),i.oJD),i.xp6(1),i.uIk("aria-label",s.l("Close"))}}function C(p,A){if(1&p&&(i.TgZ(0,"div",13)(1,"div",14)(2,"h3",15)(3,"span",16),i._uU(4),i.qZA()()(),i.TgZ(5,"div",17)(6,"div",18)(7,"div",19)(8,"div",20),i._uU(9),i.ALo(10,"localize"),i.qZA(),i.TgZ(11,"div",21),i._uU(12),i.qZA()(),i.TgZ(13,"div",22)(14,"div",20),i._uU(15),i.ALo(16,"localize"),i.qZA(),i.TgZ(17,"div",21),i._uU(18),i.qZA()()()()()),2&p){const s=A.$implicit,d=i.oxw();i.xp6(4),i.Oqu(s.propertyName),i.xp6(5),i.hij(" ",i.lcZ(10,5,"OriginalValue")," "),i.xp6(3),i.hij(" ",d.getPropertyChangeValue(s.originalValue,s.propertyTypeFullName)," "),i.xp6(3),i.Oqu(i.lcZ(16,7,"NewValue")),i.xp6(3),i.hij(" ",d.getPropertyChangeValue(s.newValue,s.propertyTypeFullName)," ")}}const Z=function(){return{backdrop:"static"}};let u=(()=>{class p extends L.c{constructor(s,d,m){super(s),this._auditLogService=d,this._dateTimeService=m,this.active=!1}getPropertyChangeValue(s,d){return s&&(s=s.replace(/^['"]+/g,"").replace(/['"]+$/g,""),this.isDate(s,d)?this._dateTimeService.formatDate(this._dateTimeService.fromISODateString(s),"yyyy-LL-dd HH:mm:ss"):"null"===s?"":s)}isDate(s,d){return d.includes("DateTime")&&!isNaN(Date.parse(s).valueOf())}show(s){const d=this;d.active=!0,d.entityChange=s,this._auditLogService.getEntityPropertyChanges(s.id).subscribe(m=>{d.entityPropertyChanges=m}),d.modal.show()}close(){this.active=!1,this.modal.hide()}static#e=this.\u0275fac=function(d){return new(d||p)(i.Y36(i.zs3),i.Y36(T.xWy),i.Y36(v.C))};static#t=this.\u0275cmp=i.Xpm({type:p,selectors:[["entityChangeDetailModal"]],viewQuery:function(d,m){if(1&d&&i.Gf(b,7),2&d){let _;i.iGM(_=i.CRH())&&(m.modal=_.first)}},features:[i.qOj],decls:11,vars:7,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","entityChangeDetailModal","aria-hidden","true",1,"modal","fade",3,"config"],["entityChangeDetailModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["class","modal-header",4,"ngIf"],[1,"modal-body"],["class","card card-custom gutter-b",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],[1,"modal-header"],[1,"modal-title"],[3,"innerHTML"],["type","button",1,"btn-close",3,"click"],[1,"card","card-custom","gutter-b"],[1,"card-header","py-5"],[1,"card-title"],[1,"card-label"],[1,"card-body","py-0"],[1,"row","m-0"],[1,"col","px-8","py-6","me-8"],[1,"fs-sm","text-muted","fw-bold"],[1,"fw-bolder"],[1,"col","px-8","py-6"]],template:function(d,m){1&d&&(i.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3),i.YNc(4,y,9,8,"div",4),i.TgZ(5,"div",5),i.YNc(6,C,19,9,"div",6),i.qZA(),i.TgZ(7,"div",7)(8,"button",8),i.NdJ("click",function(){return m.close()}),i._uU(9),i.ALo(10,"localize"),i.qZA()()()()()),2&d&&(i.Q6J("config",i.DdM(6,Z)),i.xp6(4),i.Q6J("ngIf",m.entityChange),i.xp6(2),i.Q6J("ngForOf",m.entityPropertyChanges),i.xp6(3),i.hij(" ",i.lcZ(10,4,"Close")," "))},dependencies:[h.sg,h.O5,x.Z,e.F],encapsulation:2})}return p})()}}]);