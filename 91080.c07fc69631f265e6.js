"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[91080],{91080:(ie,g,s)=>{s.r(g),s.d(g,{SubscriptionManagementModule:()=>te});var Z=s(71902),b=s(92337),p=s(70916),f=s(47530),T=s(41840),c=s(44328),_=s(64716),e=s(99468),u=s(96814),d=s(56223),h=s(612),y=s(94901),m=s(68027),x=s(85219),A=s(51712),v=s(68989),P=s(88922),S=s(3291);const C=["dataTable"],L=["paginator"];function U(t,a){1&t&&(e.TgZ(0,"span",34),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Free")," "))}function q(t,a){1&t&&(e.TgZ(0,"span",35),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Trial")," "))}function z(t,a){if(1&t&&(e.TgZ(0,"div",31)(1,"small",12),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"h3",13),e._uU(5),e.qZA(),e.YNc(6,U,3,3,"span",32),e.YNc(7,q,3,3,"span",33),e.qZA()),2&t){const n=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,4,"Edition")," "),e.xp6(3),e.hij(" ",n.tenant.edition.displayName," "),e.xp6(1),e.Q6J("ngIf",n.tenant.edition.isFree),e.xp6(1),e.Q6J("ngIf",n.tenant.isInTrialPeriod)}}function I(t,a){1&t&&e._UZ(0,"i",40)}function w(t,a){1&t&&e._UZ(0,"i",41)}function M(t,a){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.hij(" : ",n.value," ")}}const j=function(t,a){return{"text-muted":t,"text-success":a}};function N(t,a){if(1&t&&(e.TgZ(0,"span",37),e.YNc(1,I,1,0,"i",38),e.YNc(2,w,1,0,"i",39),e._uU(3),e.YNc(4,M,2,1,"span",15),e.qZA()),2&t){const n=a.$implicit;e.Q6J("ngClass",e.WLB(5,j,"false"==n.value,"false"!=n.value)),e.xp6(1),e.Q6J("ngIf","false"==n.value),e.xp6(1),e.Q6J("ngIf","false"!=n.value),e.xp6(1),e.hij(" ",n.name," "),e.xp6(1),e.Q6J("ngIf","false"!=n.value&&"true"!=n.value)}}function R(t,a){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,N,5,8,"span",36),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.tenant.featureValues)}}function J(t,a){1&t&&(e.TgZ(0,"div")(1,"p"),e._uU(2),e.ALo(3,"localize"),e.qZA()()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"NoFeaturesInYourPlan")," "))}const H=function(){return["/account/extend"]},Q=function(t){return{editionPaymentType:t}};function Y(t,a){if(1&t&&(e.TgZ(0,"div",42)(1,"div",18)(2,"a",43),e._uU(3),e.ALo(4,"localize"),e.qZA()()()),2&t){const n=e.oxw();e.xp6(2),e.Q6J("routerLink",e.DdM(5,H))("queryParams",e.VKq(6,Q,n.editionPaymentType.Extend)),e.xp6(1),e.hij(" ",e.lcZ(4,3,"Extend")," ")}}const O=function(){return["/account/buy"]},D=function(t,a,n){return{editionPaymentType:t,editionId:a,tenantId:n}};function F(t,a){if(1&t&&(e.TgZ(0,"div",42)(1,"div",18)(2,"a",43),e._uU(3),e.ALo(4,"localize"),e.qZA()()()),2&t){const n=e.oxw();e.xp6(2),e.Q6J("routerLink",e.DdM(5,O))("queryParams",e.kEZ(6,D,n.editionPaymentType.BuyNow,n.tenant.edition.id,n.tenant.id)),e.xp6(1),e.hij(" ",e.lcZ(4,3,"BuyNow")," ")}}const k=function(){return["/account/select-edition"]};function E(t,a){1&t&&(e.TgZ(0,"div",42)(1,"div",18)(2,"a",44),e._uU(3),e.ALo(4,"localize"),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("routerLink",e.DdM(4,k)),e.xp6(1),e.hij(" ",e.lcZ(4,2,"Upgrade")," "))}function B(t,a){1&t&&(e.TgZ(0,"tr")(1,"th",45),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"th",46),e._uU(5),e.ALo(6,"localize"),e._UZ(7,"p-sortIcon",47),e.qZA(),e.TgZ(8,"th",48),e._uU(9),e.ALo(10,"localize"),e._UZ(11,"p-sortIcon",49),e.qZA(),e.TgZ(12,"th",50),e._uU(13),e.ALo(14,"localize"),e._UZ(15,"p-sortIcon",51),e.qZA(),e.TgZ(16,"th",52),e._uU(17),e.ALo(18,"localize"),e._UZ(19,"p-sortIcon",53),e.qZA(),e.TgZ(20,"th",54),e._uU(21),e.ALo(22,"localize"),e._UZ(23,"p-sortIcon",55),e.qZA(),e.TgZ(24,"th",56),e._uU(25),e.ALo(26,"localize"),e._UZ(27,"p-sortIcon",57),e.qZA(),e.TgZ(28,"th",58),e._uU(29),e.ALo(30,"localize"),e.qZA(),e.TgZ(31,"th",59),e._uU(32),e.ALo(33,"localize"),e.qZA(),e.TgZ(34,"th",60),e._uU(35),e.ALo(36,"localize"),e._UZ(37,"p-sortIcon",61),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,10,"Invoice")),e.xp6(3),e.hij(" ",e.lcZ(6,12,"ProcessTime")," "),e.xp6(4),e.hij(" ",e.lcZ(10,14,"Edition")," "),e.xp6(4),e.hij(" ",e.lcZ(14,16,"Gateway")," "),e.xp6(4),e.hij(" ",e.lcZ(18,18,"Amount")," "),e.xp6(4),e.hij(" ",e.lcZ(22,20,"Status")," "),e.xp6(4),e.hij(" ",e.lcZ(26,22,"Period")," "),e.xp6(4),e.Oqu(e.lcZ(30,24,"DayCount")),e.xp6(3),e.Oqu(e.lcZ(33,26,"PaymentId")),e.xp6(3),e.hij(" ",e.lcZ(36,28,"InvoiceNo")," "))}function G(t,a){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"luxonFormat"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,n.creationTime,"F")," ")}}function $(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"-"),e.qZA())}function V(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"tr")(1,"td",45)(2,"button",62),e.NdJ("click",function(){const r=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.createOrShowInvoice(r.id,r.invoiceNo))}),e._uU(3),e.ALo(4,"localize"),e.qZA()(),e.TgZ(5,"td",63)(6,"span",64),e._uU(7),e.ALo(8,"localize"),e.qZA(),e.YNc(9,G,3,4,"span",15),e.YNc(10,$,2,0,"span",15),e.qZA(),e.TgZ(11,"td",63)(12,"span",64),e._uU(13),e.ALo(14,"localize"),e.qZA(),e._uU(15),e.qZA(),e.TgZ(16,"td",63)(17,"span",64),e._uU(18),e.ALo(19,"localize"),e.qZA(),e._uU(20),e.ALo(21,"localize"),e.qZA(),e.TgZ(22,"td",58)(23,"span",64),e._uU(24),e.ALo(25,"localize"),e.qZA(),e._uU(26),e.ALo(27,"number"),e.qZA(),e.TgZ(28,"td",63)(29,"span",64),e._uU(30),e.ALo(31,"localize"),e.qZA(),e._uU(32),e.ALo(33,"localize"),e.qZA(),e.TgZ(34,"td",63)(35,"span",64),e._uU(36),e.ALo(37,"localize"),e.qZA(),e._uU(38),e.ALo(39,"localize"),e.qZA(),e.TgZ(40,"td",58)(41,"span",64),e._uU(42),e.ALo(43,"localize"),e.qZA(),e._uU(44),e.qZA(),e.TgZ(45,"td",59)(46,"span",64),e._uU(47),e.ALo(48,"localize"),e.qZA(),e._uU(49),e.qZA(),e.TgZ(50,"td",63)(51,"span",64),e._uU(52),e.ALo(53,"localize"),e.qZA(),e._uU(54),e.qZA()()}if(2&t){const n=a.$implicit,o=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,21,"ShowInvoice")," "),e.xp6(4),e.Oqu(e.lcZ(8,23,"ProcessTime")),e.xp6(2),e.Q6J("ngIf",n.creationTime),e.xp6(1),e.Q6J("ngIf",!n.creationTime),e.xp6(3),e.Oqu(e.lcZ(14,25,"Edition")),e.xp6(2),e.hij(" ",n.editionDisplayName," "),e.xp6(3),e.Oqu(e.lcZ(19,27,"Gateway")),e.xp6(2),e.hij(" ",e.lcZ(21,29,"SubscriptionPaymentGatewayType_"+n.gateway)," "),e.xp6(4),e.Oqu(e.lcZ(25,31,"Amount")),e.xp6(2),e.AsE(" ",o.appSession.application.currencySign," ",e.xi3(27,33,n.amount,"1.2-2")," "),e.xp6(4),e.Oqu(e.lcZ(31,36,"Status")),e.xp6(2),e.hij(" ",e.lcZ(33,38,"SubscriptionPaymentStatus_"+n.status)," "),e.xp6(4),e.Oqu(e.lcZ(37,40,"Period")),e.xp6(2),e.hij(" ",e.lcZ(39,42,"PaymentPeriodType_"+n.paymentPeriodType)," "),e.xp6(4),e.Oqu(e.lcZ(43,44,"DayCount")),e.xp6(2),e.hij(" ",n.dayCount," "),e.xp6(3),e.Oqu(e.lcZ(48,46,"PaymentId")),e.xp6(2),e.hij(" ",n.paymentId," "),e.xp6(3),e.Oqu(e.lcZ(53,48,"InvoiceNo")),e.xp6(2),e.hij(" ",n.invoiceNo," ")}}function K(t,a){1&t&&(e.TgZ(0,"div",65),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const W=function(){return{"min-width":"50rem"}},X=[{path:"",component:(()=>{class t extends T.c{constructor(n,o,i,r,l,ne){super(n),this._sessionService=o,this._paymentServiceProxy=i,this._invoiceServiceProxy=r,this._subscriptionServiceProxy=l,this._activatedRoute=ne,this.subscriptionStartType=c.gPM,this.subscriptionPaymentType=c.Ykt,this.user=new c.dL0,this.tenant=new c.oQ$,this.application=new c.BeN,this.editionPaymentType=c.qLZ,this.filterText="",this.filterText=this._activatedRoute.snapshot.queryParams.filterText||""}ngOnInit(){this.getSettings()}createOrShowInvoice(n,o){o?window.open("/app/admin/invoice/"+n,"_blank"):this._invoiceServiceProxy.createInvoice(new c.Zjf({subscriptionPaymentId:n})).subscribe(()=>{this.getPaymentHistory(),window.open("/app/admin/invoice/"+n,"_blank")})}getSettings(){this.loading=!0,this.appSession.init().then(()=>{this.loading=!1,this.user=this.appSession.user,this.tenant=this.appSession.tenant,this.application=this.appSession.application})}getPaymentHistory(n){this.primengTableHelper.shouldResetPaging(n)&&(this.paginator.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0)||(this.primengTableHelper.showLoadingIndicator(),this._paymentServiceProxy.getPaymentHistory(this.primengTableHelper.getSorting(this.dataTable),this.primengTableHelper.getMaxResultCount(this.paginator,n),this.primengTableHelper.getSkipCount(this.paginator,n)).pipe((0,_.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(o=>{this.primengTableHelper.totalRecordsCount=o.totalCount,this.primengTableHelper.records=o.items,this.primengTableHelper.hideLoadingIndicator()}))}disableRecurringPayments(){this._subscriptionServiceProxy.disableRecurringPayments().subscribe(n=>{this.tenant.subscriptionPaymentType=this.subscriptionPaymentType.RecurringManual})}enableRecurringPayments(){this._subscriptionServiceProxy.enableRecurringPayments().subscribe(n=>{this.tenant.subscriptionPaymentType=this.subscriptionPaymentType.RecurringAutomatic})}hasRecurringSubscription(){return this.tenant.subscriptionPaymentType!==this.subscriptionPaymentType.Manual}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(e.zs3),e.Y36(c.HQk),e.Y36(c.KC),e.Y36(c.n4k),e.Y36(c.BYK),e.Y36(p.gz))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(o,i){if(1&o&&(e.Gf(C,7),e.Gf(L,7)),2&o){let r;e.iGM(r=e.CRH())&&(i.dataTable=r.first),e.iGM(r=e.CRH())&&(i.paginator=r.first)}},features:[e.qOj],decls:62,vars:54,consts:[[3,"title"],[1,"card","card-custom","gutter-b"],[1,"card-body"],[1,"p-5",3,"heading"],[1,"mb-10"],[1,"card","shadow-sm","col-md-6","col-lg-4"],[1,"card-header"],[1,"container"],[1,"row"],["class","col-md-12 mt-10",4,"ngIf"],[1,"row","my-5"],[1,"col-md-6"],[1,"text-muted","text-uppercase","d-block"],[1,"d-inline"],[1,"text-muted","text-uppercase","d-block","mb-5"],[4,"ngIf"],[1,"card-footer"],[1,"mb-5","row",3,"hidden"],[1,"col-md-12"],["id","btnDisableRecurringPayments","href","javascript:;",1,"btn","btn-secondary","btn-lg","w-100",3,"click"],["id","btnEnableRecurringPayments","href","javascript:;",1,"btn","btn-info","btn-lg","w-100",3,"click"],["class","mb-5 row",4,"ngIf"],[1,"primeng-datatable-container",3,"busyIf"],["sortMode","multiple","ScrollWidth","100%",3,"value","rows","paginator","lazy","scrollable","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[1,"col-md-12","mt-10"],["class","badge badge-success",4,"ngIf"],["class","badge badge-warning",4,"ngIf"],[1,"badge","badge-success"],[1,"badge","badge-warning"],["class","text-left d-block mb-2",3,"ngClass",4,"ngFor","ngForOf"],[1,"text-left","d-block","mb-2",3,"ngClass"],["class","far fa-times-circle text-muted",4,"ngIf"],["class","far fa-check-circle text-success",4,"ngIf"],[1,"far","fa-times-circle","text-muted"],[1,"far","fa-check-circle","text-success"],[1,"mb-5","row"],[1,"btn","btn-info","btn-lg","w-100",3,"routerLink","queryParams"],[1,"btn","btn-warning","btn-lg","w-100",3,"routerLink"],[2,"width","130px"],["pSortableColumn","creationTime",2,"width","150px"],["field","creationTime"],["pSortableColumn","editionDisplayName",2,"width","150px"],["field","editionDisplayName"],["pSortableColumn","gateway",2,"width","150px"],["field","gateway"],["pSortableColumn","amount",2,"width","100px"],["field","amount"],["pSortableColumn","status",2,"width","150px"],["field","status"],["pSortableColumn","paymentPeriodType",2,"width","150px"],["field","paymentPeriodType"],[2,"width","100px"],[2,"width","250px"],["pSortableColumn","invoiceNo",2,"width","150px"],["field","invoiceNo"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[2,"width","150px"],[1,"p-column-title"],[1,"primeng-no-data"]],template:function(o,i){1&o&&(e.TgZ(0,"div"),e._UZ(1,"sub-header",0),e.ALo(2,"localize"),e.TgZ(3,"div")(4,"div",1)(5,"div",2)(6,"tabset")(7,"tab",3),e.ALo(8,"localize"),e.TgZ(9,"form")(10,"h3",4),e._uU(11,"Your Plan"),e.qZA(),e.TgZ(12,"div",5)(13,"div",6)(14,"div",7)(15,"div",8),e.YNc(16,z,8,6,"div",9),e.qZA(),e.TgZ(17,"div",10)(18,"div",11)(19,"small",12),e._uU(20),e.ALo(21,"localize"),e.qZA(),e.TgZ(22,"h3",13),e._uU(23),e.qZA()(),e.TgZ(24,"div",11)(25,"small",12),e._uU(26),e.ALo(27,"localize"),e.qZA(),e.TgZ(28,"h3",13),e._uU(29),e.qZA()()()()(),e.TgZ(30,"div",2)(31,"small",14),e._uU(32),e.ALo(33,"localize"),e.qZA(),e.YNc(34,R,2,1,"div",15),e.YNc(35,J,4,3,"div",15),e.qZA(),e.TgZ(36,"div",16)(37,"div",17)(38,"div",18)(39,"a",19),e.NdJ("click",function(){return i.disableRecurringPayments()}),e._uU(40),e.ALo(41,"localize"),e.qZA()()(),e.TgZ(42,"div",17)(43,"div",18)(44,"a",20),e.NdJ("click",function(){return i.enableRecurringPayments()}),e._uU(45),e.ALo(46,"localize"),e.qZA()()(),e.YNc(47,Y,5,8,"div",21),e.YNc(48,F,5,10,"div",21),e.YNc(49,E,5,5,"div",21),e.qZA()()()(),e.TgZ(50,"tab",3),e.ALo(51,"localize"),e.TgZ(52,"div",22)(53,"p-table",23,24),e.NdJ("onLazyLoad",function(l){return i.getPaymentHistory(l)}),e.YNc(55,B,38,30,"ng-template",25),e.YNc(56,V,55,50,"ng-template",26),e.qZA(),e.YNc(57,K,3,3,"div",27),e.TgZ(58,"div",28)(59,"p-paginator",29,30),e.NdJ("onPageChange",function(l){return i.getPaymentHistory(l)}),e.ALo(61,"localize"),e.qZA()()()()()()()()()),2&o&&(e.Q6J("@routerTransition",void 0),e.xp6(1),e.Q6J("title",e.lcZ(2,34,"Subscription")),e.xp6(2),e.Tol(i.containerClass),e.xp6(4),e.s9C("heading",e.lcZ(8,36,"SubscriptionInformation")),e.xp6(9),e.Q6J("ngIf",i.tenant.edition),e.xp6(4),e.hij(" ",e.lcZ(21,38,"SubscriptionStartDate")," "),e.xp6(3),e.hij(" ",i.tenant.creationTimeString," "),e.xp6(3),e.hij(" ",e.lcZ(27,40,"SubscriptionEndDate")," "),e.xp6(3),e.hij(" ",i.tenant.subscriptionDateString," "),e.xp6(3),e.hij(" ",e.lcZ(33,42,"WhatsIncludedInYourPlan")," "),e.xp6(2),e.Q6J("ngIf",i.tenant.featureValues&&i.tenant.featureValues.length),e.xp6(1),e.Q6J("ngIf",!i.tenant.featureValues||!i.tenant.featureValues.length),e.xp6(2),e.Q6J("hidden",i.tenant.subscriptionPaymentType!=i.subscriptionPaymentType.RecurringAutomatic),e.xp6(3),e.hij(" ",e.lcZ(41,44,"DisableRecurringPayments")," "),e.xp6(2),e.Q6J("hidden",i.tenant.subscriptionPaymentType!=i.subscriptionPaymentType.RecurringManual),e.xp6(3),e.hij(" ",e.lcZ(46,46,"EnableRecurringPayments")," "),e.xp6(2),e.Q6J("ngIf",!i.hasRecurringSubscription()&&i.tenant.edition&&!i.tenant.edition.isFree&&!i.tenant.isInTrialPeriod),e.xp6(1),e.Q6J("ngIf",i.tenant.isInTrialPeriod),e.xp6(1),e.Q6J("ngIf",i.tenant.edition&&!i.tenant.edition.isHighestEdition&&!i.tenant.isInTrialPeriod),e.xp6(1),e.s9C("heading",e.lcZ(51,48,"PaymentHistory")),e.xp6(2),e.Q6J("busyIf",i.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",i.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",i.primengTableHelper.records)("paginator",!1)("lazy",!0)("scrollable",!0)("tableStyle",e.DdM(53,W)),e.xp6(4),e.Q6J("ngIf",0==i.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",i.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",i.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",i.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(61,50,"TotalRecordsCount",i.primengTableHelper.totalRecordsCount)))},dependencies:[u.mk,u.sg,u.O5,d._Y,d.JL,d.F,h.wW,h.AH,p.rH,y.U,m.iA,x.jx,m.lQ,m.fz,A.D,v.$,u.JJ,P.n,S.F],encapsulation:2,data:{animation:[(0,f.MH)()]}})}return t})(),pathMatch:"full"}];let ee=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(X),p.Bz]})}return t})(),te=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[b.o,Z.g,ee]})}return t})()}}]);