"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[26709],{26709:(E,v,s)=>{s.r(v),s.d(v,{OrganizationUnitsModule:()=>Be});var A=s(70916),N=s(47530),b=s(41840),e=s(99468),_=s(96814),Z=s(612),x=s(68989),g=s(44328),M=s(43136),I=s(66232),S=s(58504),H=s(26306),w=s(78164),L=s(98833),J=s(76388),C=s(85219),P=s(91396),q=s(48493),T=s(64716),r=s(56223),d=s(45513),m=s(42152),u=s(24142),c=s(3291);const z=["createOrEditModal"],y=["organizationUnitDisplayName"];function Y(o,p){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"Edit"),": ",t.organizationUnit.displayName," ")}}function j(o,p){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NewOrganizationUnit")))}const k=function(o){return{edited:o}};function K(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e.TgZ(2,"div",7)(3,"h5",8),e.YNc(4,Y,3,4,"span",9),e.YNc(5,j,3,3,"span",9),e.qZA(),e.TgZ(6,"button",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e.qZA()(),e.TgZ(7,"div",11)(8,"div",12)(9,"label",13),e._uU(10),e.ALo(11,"localize"),e.qZA(),e.TgZ(12,"input",14,15),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.organizationUnit.displayName=n)}),e.qZA(),e._UZ(14,"validation-messages",16),e.qZA()(),e.TgZ(15,"div",17)(16,"button",18),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e._uU(17),e.ALo(18,"localize"),e.qZA(),e.TgZ(19,"button",19),e._UZ(20,"i",20),e.TgZ(21,"span"),e._uU(22),e.ALo(23,"localize"),e.qZA()()()()}if(2&o){const t=e.MAs(1),i=e.MAs(13),n=e.oxw();e.xp6(4),e.Q6J("ngIf",n.organizationUnit.id),e.xp6(1),e.Q6J("ngIf",!n.organizationUnit.id),e.xp6(1),e.Q6J("disabled",n.saving),e.uIk("aria-label",n.l("Close")),e.xp6(4),e.Oqu(e.lcZ(11,14,"Name")),e.xp6(2),e.Q6J("ngClass",e.VKq(20,k,n.organizationUnit.displayName))("ngModel",n.organizationUnit.displayName),e.xp6(2),e.Q6J("formCtrl",i),e.xp6(2),e.Q6J("disabled",n.saving),e.xp6(1),e.hij(" ",e.lcZ(18,16,"Cancel")," "),e.xp6(2),e.Q6J("disabled",!t.form.valid)("buttonBusy",n.saving)("busyText",n.l("SavingWithThreeDot")),e.xp6(3),e.Oqu(e.lcZ(23,18,"Save"))}}const B=function(o){return{backdrop:"static",keyboard:o}};let W=(()=>{class o extends b.c{constructor(t,i,n){super(t),this._organizationUnitService=i,this._changeDetector=n,this.unitCreated=new e.vpe,this.unitUpdated=new e.vpe,this.active=!1,this.saving=!1,this.organizationUnit={}}onShown(){document.getElementById("OrganizationUnitDisplayName").focus()}show(t){this.organizationUnit=t,this.active=!0,this.modal.show(),this._changeDetector.detectChanges()}save(){this.organizationUnit.id?this.updateUnit():this.createUnit()}createUnit(){const t=new g.DIt;t.parentId=this.organizationUnit.parentId,t.displayName=this.organizationUnit.displayName,this.saving=!0,this._organizationUnitService.createOrganizationUnit(t).pipe((0,T.x)(()=>this.saving=!1)).subscribe(i=>{this.notify.info(this.l("SavedSuccessfully")),this.close(),this.unitCreated.emit(i)})}updateUnit(){const t=new g.cOS;t.id=this.organizationUnit.id,t.displayName=this.organizationUnit.displayName,this.saving=!0,this._organizationUnitService.updateOrganizationUnit(t).pipe((0,T.x)(()=>this.saving=!1)).subscribe(i=>{this.notify.info(this.l("SavedSuccessfully")),this.close(),this.unitUpdated.emit(i)})}close(){this.modal.hide(),this.active=!1}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.zs3),e.Y36(g.OAl),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["createOrEditOrganizationUnitModal"]],viewQuery:function(i,n){if(1&i&&(e.Gf(z,7),e.Gf(y,7)),2&i){let a;e.iGM(a=e.CRH())&&(n.modal=a.first),e.iGM(a=e.CRH())&&(n.organizationUnitDisplayNameInput=a.first)}},outputs:{unitCreated:"unitCreated",unitUpdated:"unitUpdated"},features:[e.qOj],decls:5,vars:4,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","createOrEditModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["createOrEditModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["novalidate","",3,"ngSubmit",4,"ngIf"],["novalidate","",3,"ngSubmit"],["editForm","ngForm"],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"mb-5","form-md-line-input","form-md-floating-label","no-hint"],["for","OrganizationUnitDisplayName",1,"form-label","required"],["id","OrganizationUnitDisplayName","type","text","name","displayName","required","","maxlength","128",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["organizationUnitDisplayName","ngModel"],[3,"formCtrl"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-save"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return n.onShown()}),e.TgZ(2,"div",2)(3,"div",3),e.YNc(4,K,24,22,"form",4),e.qZA()()()),2&i&&(e.Q6J("config",e.VKq(2,B,!n.saving)),e.xp6(4),e.Q6J("ngIf",n.active))},dependencies:[_.mk,_.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.nD,r.On,r.F,d.L,m.s,u.Z,c.F],encapsulation:2})}return o})();var D=s(83410);const $=["createOrEditOrganizationUnitModal"],X=["entityTypeHistoryModal"];function V(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.addUnit(null))}),e._UZ(1,"i",16),e.TgZ(2,"span",17),e._uU(3),e.ALo(4,"localize"),e.qZA()()}2&o&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"AddRootUnit")," "))}function ee(o,p){if(1&o&&(e.TgZ(0,"div")(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"small",18),e._uU(4),e.ALo(5,"localize"),e.ALo(6,"localize"),e.qZA()()),2&o){const t=p.$implicit;e.xp6(2),e.hij(" ",t.label," "),e.xp6(2),e.HOy(" ",t.memberCount," ",e.lcZ(5,5,"Members"),", ",t.roleCount," ",e.lcZ(6,7,"Roles")," ")}}function te(o,p){1&o&&(e.TgZ(0,"div",19),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoOrganizationUnitDefinedYet")," "))}let ne=(()=>{class o extends b.c{constructor(t,i,n,a){super(t),this._organizationUnitService=i,this._arrayToTreeConverterService=n,this._treeDataHelperService=a,this.ouSelected=new e.vpe,this.canManageOrganizationUnits=!1,this.totalUnitCount=0,this._entityTypeFullName="Abp.Organizations.OrganizationUnit"}ngOnInit(){this.canManageOrganizationUnits=this.isGranted("Pages.Administration.OrganizationUnits.ManageOrganizationTree"),this.ouContextMenuItems=this.getContextMenuItems(),this.getTreeDataFromServer()}nodeSelect(t){this.ouSelected.emit({id:t.node.data.id,displayName:t.node.data.displayName})}isDroppingBetweenTwoNodes(t){return"LI"===t.originalEvent.target.nodeName}nodeDrop(t){const i=new g.u6;i.id=t.dragNode.data.id;let n="";this.isDroppingBetweenTwoNodes(t)?(i.newParentId=t.dropNode.parent?t.dropNode.parent.data.id:null,n=t.dropNode.parent?t.dropNode.parent.data.displayName:this.l("Root")):(i.newParentId=t.dropNode.data.id,n=t.dropNode.data.displayName),this.message.confirm(this.l("OrganizationUnitMoveConfirmMessage",t.dragNode.data.displayName,n),this.l("AreYouSure"),a=>{a?this._organizationUnitService.moveOrganizationUnit(i).pipe((0,H.K)(l=>(this.revertDragDrop(),(0,S._)(l)))).subscribe(()=>{this.notify.success(this.l("SuccessfullyMoved")),this.reload()}):this.revertDragDrop()})}revertDragDrop(){this.reload()}reload(){this.getTreeDataFromServer()}addUnit(t){this.createOrEditOrganizationUnitModal.show({parentId:t})}unitCreated(t){if(t.parentId){let i=this._treeDataHelperService.findNode(this.treeData,{data:{id:t.parentId}});if(!i)return;i.children.push({label:t.displayName,expandedIcon:"fa fa-folder-open text-warning",collapsedIcon:"fa fa-folder text-warning",selected:!0,children:[],data:t,memberCount:t.memberCount,roleCount:t.roleCount})}else this.treeData.push({label:t.displayName,expandedIcon:"fa fa-folder-open text-warning",collapsedIcon:"fa fa-folder text-warning",selected:!0,children:[],data:t,memberCount:t.memberCount,roleCount:t.roleCount});this.totalUnitCount+=1}deleteUnit(t){let i=this._treeDataHelperService.findNode(this.treeData,{data:{id:t}});if(!i)return;i.data.parentId||(0,M.Z)(this.treeData,{data:{id:t}});let n=this._treeDataHelperService.findNode(this.treeData,{data:{id:i.data.parentId}});n&&(0,M.Z)(n.children,{data:{id:t}})}unitUpdated(t){let i=this._treeDataHelperService.findNode(this.treeData,{data:{id:t.id}});i&&(i.data.displayName=t.displayName,i.label=t.displayName,i.memberCount=t.memberCount,i.roleCount=t.roleCount)}membersAdded(t){this.incrementMemberCount(t.ouId,t.userIds.length)}memberRemoved(t){this.incrementMemberCount(t.ouId,-1)}incrementMemberCount(t,i){let n=this._treeDataHelperService.findNode(this.treeData,{data:{id:t}});n.data.memberCount+=i,n.memberCount=n.data.memberCount}rolesAdded(t){this.incrementRoleCount(t.ouId,t.roleIds.length)}roleRemoved(t){this.incrementRoleCount(t.ouId,-1)}incrementRoleCount(t,i){let n=this._treeDataHelperService.findNode(this.treeData,{data:{id:t}});n.data.roleCount+=i,n.roleCount=n.data.roleCount}getTreeDataFromServer(){this._organizationUnitService.getOrganizationUnits().subscribe(i=>{this.totalUnitCount=i.items.length,this.treeData=this._arrayToTreeConverterService.createTree(i.items,"parentId","id",null,"children",[{target:"label",targetFunction:n=>n.displayName},{target:"expandedIcon",value:"fa fa-folder-open text-warning"},{target:"collapsedIcon",value:"fa fa-folder text-warning"},{target:"selectable",value:!0},{target:"memberCount",targetFunction:n=>n.memberCount},{target:"roleCount",targetFunction:n=>n.roleCount}])})}isEntityHistoryEnabled(){let t=abp.custom;return t.EntityHistory&&t.EntityHistory.isEnabled&&1===(0,I.Z)(t.EntityHistory.enabledEntities,i=>i===this._entityTypeFullName).length}getContextMenuItems(){const t=this.isGranted("Pages.Administration.OrganizationUnits.ManageOrganizationTree");let i=[{label:this.l("Edit"),disabled:!t,command:n=>{this.createOrEditOrganizationUnitModal.show({id:this.selectedOu.data.id,displayName:this.selectedOu.data.displayName})}},{label:this.l("AddSubUnit"),disabled:!t,command:()=>{this.addUnit(this.selectedOu.data.id)}},{label:this.l("Delete"),disabled:!t,command:()=>{this.message.confirm(this.l("OrganizationUnitDeleteWarningMessage",this.selectedOu.data.displayName),this.l("AreYouSure"),n=>{n&&this._organizationUnitService.deleteOrganizationUnit(this.selectedOu.data.id).subscribe(()=>{this.deleteUnit(this.selectedOu.data.id),this.notify.success(this.l("SuccessfullyDeleted")),this.selectedOu=null,this.reload(),this.ouSelected.emit(null)})})}}];return this.isEntityHistoryEnabled()&&i.push({label:this.l("History"),disabled:!1,command:n=>{this.entityTypeHistoryModal.show({entityId:this.selectedOu.data.id.toString(),entityTypeFullName:this._entityTypeFullName,entityTypeDescription:this.selectedOu.data.displayName})}}),i}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.zs3),e.Y36(g.OAl),e.Y36(w.V),e.Y36(L.j))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["organization-tree"]],viewQuery:function(i,n){if(1&i&&(e.Gf($,7),e.Gf(X,7)),2&i){let a;e.iGM(a=e.CRH())&&(n.createOrEditOrganizationUnitModal=a.first),e.iGM(a=e.CRH())&&(n.entityTypeHistoryModal=a.first)}},outputs:{ouSelected:"ouSelected"},features:[e.qOj],decls:19,vars:13,consts:[[1,"card","card-custom","gutter-b"],[1,"card-header","align-items-center","border-0"],[1,"card-title","align-items-start","flex-column"],[1,"fw-bolder","text-dark"],[1,"card-toolbar"],["class","btn btn-outline btn-outline-primary btn-sm",3,"click",4,"ngIf"],[1,"card-body"],["selectionMode","single",3,"value","selection","contextMenu","draggableNodes","droppableNodes","selectionChange","onNodeSelect","onNodeDrop"],["pTemplate","default"],["appendTo","body","baseZIndex","99999",3,"model"],["ouContextMenu",""],["class","text-muted",4,"ngIf"],[3,"unitCreated","unitUpdated"],["createOrEditOrganizationUnitModal",""],["entityTypeHistoryModal",""],[1,"btn","btn-outline","btn-outline-primary","btn-sm",3,"click"],[1,"fa","fa-plus","btn-md-icon"],[1,"d-none","d-md-inline-block"],[2,"font-size","0.82em","opacity","0.5"],[1,"text-muted"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2)(3,"span",3),e._uU(4),e.ALo(5,"localize"),e.qZA()(),e.TgZ(6,"div",4),e.YNc(7,V,5,3,"button",5),e.ALo(8,"permission"),e.qZA()(),e.TgZ(9,"div",6)(10,"p-tree",7),e.NdJ("selectionChange",function(l){return n.selectedOu=l})("onNodeSelect",function(l){return n.nodeSelect(l)})("onNodeDrop",function(l){return n.nodeDrop(l)}),e.YNc(11,ee,7,9,"ng-template",8),e.qZA(),e._UZ(12,"p-contextMenu",9,10),e.YNc(14,te,3,3,"div",11),e.qZA()(),e.TgZ(15,"createOrEditOrganizationUnitModal",12,13),e.NdJ("unitCreated",function(l){return n.unitCreated(l)})("unitUpdated",function(l){return n.unitUpdated(l)}),e.qZA(),e._UZ(17,"entityTypeHistoryModal",null,14)),2&i){const a=e.MAs(13);e.xp6(4),e.hij(" ",e.lcZ(5,9,"OrganizationTree")," "),e.xp6(3),e.Q6J("ngIf",e.lcZ(8,11,"Pages.Administration.OrganizationUnits.ManageOrganizationTree")),e.xp6(3),e.Q6J("value",n.treeData)("selection",n.selectedOu)("contextMenu",a)("draggableNodes",n.canManageOrganizationUnits)("droppableNodes",n.canManageOrganizationUnits),e.xp6(2),e.Q6J("model",n.ouContextMenuItems),e.xp6(2),e.Q6J("ngIf",!n.totalUnitCount)}},dependencies:[_.O5,J.A,C.jx,P.mp,q.xV,W,c.F,D.a],encapsulation:2})}return o})();var R=s(94901),h=s(68027),O=s(51712),Q=s(74550),G=s(32925);const ie=["modal"],oe=["dataTable"],ae=["paginator"];function re(o,p){1&o&&(e.TgZ(0,"tr")(1,"th",27),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.ALo(5,"localize"),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.ALo(8,"localize"),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.ALo(11,"localize"),e.qZA()()),2&o&&(e.xp6(4),e.hij(" ",e.lcZ(5,3,"Name")," "),e.xp6(3),e.hij(" ",e.lcZ(8,5,"Surname")," "),e.xp6(3),e.hij(" ",e.lcZ(11,7,"Email")," "))}function le(o,p){if(1&o&&(e.TgZ(0,"tr",28)(1,"td",27)(2,"p-tableCheckbox",29),e.NdJ("click",function(i){return i.stopPropagation()}),e.qZA()(),e.TgZ(3,"td")(4,"span",30),e._uU(5),e.ALo(6,"localize"),e.qZA(),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"span",30),e._uU(10),e.ALo(11,"localize"),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"span",30),e._uU(15),e.ALo(16,"localize"),e.qZA(),e._uU(17),e.qZA()()),2&o){const t=p.$implicit;e.Q6J("pSelectableRow",t),e.xp6(2),e.Q6J("value",t),e.xp6(3),e.Oqu(e.lcZ(6,8,"Name")),e.xp6(2),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(e.lcZ(11,10,"Surname")),e.xp6(2),e.hij(" ",t.surname," "),e.xp6(3),e.Oqu(e.lcZ(16,12,"Email")),e.xp6(2),e.hij(" ",t.emailAddress," ")}}function se(o,p){1&o&&(e.TgZ(0,"div",31),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const de=function(o){return{backdrop:"static",keyboard:o}},pe=function(){return{"min-width":"25rem"}};let ce=(()=>{class o extends b.c{constructor(t,i){super(t),this._organizationUnitService=i,this.membersAdded=new e.vpe,this.isShown=!1,this.filterText="",this.saving=!1}show(){this.modal.show()}refreshTable(){this.paginator.changePage(this.paginator.getPage())}close(){this.modal.hide()}shown(){this.isShown=!0,this.getRecordsIfNeeds(null)}getRecordsIfNeeds(t){this.isShown&&this.getRecords(t)}getRecords(t){if(this.primengTableHelper.shouldResetPaging(t)&&(this.paginator.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0))return;this.primengTableHelper.showLoadingIndicator();const i=new g.ht;i.organizationUnitId=this.organizationUnitId,i.filter=this.filterText,i.skipCount=this.primengTableHelper.getSkipCount(this.paginator,t),i.maxResultCount=this.primengTableHelper.getMaxResultCount(this.paginator,t),this._organizationUnitService.findUsers(i).pipe((0,T.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(n=>{this.primengTableHelper.totalRecordsCount=n.totalCount,this.primengTableHelper.records=n.items,this.primengTableHelper.hideLoadingIndicator()})}addUsersToOrganizationUnit(){const t=new g.o5;t.organizationUnitId=this.organizationUnitId,t.userIds=(0,Q.Z)(this.selectedMembers,i=>Number(i.id)),this.saving=!0,this._organizationUnitService.addUsersToOrganizationUnit(t).subscribe(()=>{this.notify.success(this.l("SuccessfullyAdded")),this.membersAdded.emit({userIds:t.userIds,ouId:t.organizationUnitId}),this.saving=!1,this.close(),this.selectedMembers=[]})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.zs3),e.Y36(g.OAl))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["addMemberModal"]],viewQuery:function(i,n){if(1&i&&(e.Gf(ie,7),e.Gf(oe,7),e.Gf(ae,7)),2&i){let a;e.iGM(a=e.CRH())&&(n.modal=a.first),e.iGM(a=e.CRH())&&(n.dataTable=a.first),e.iGM(a=e.CRH())&&(n.paginator=a.first)}},outputs:{membersAdded:"membersAdded"},features:[e.qOj],decls:37,vars:40,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","modal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["modal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],["novalidate","","autocomplete","new-password",3,"ngSubmit"],[1,"input-group","mb-2"],["autoFocus","","name","filterText","type","text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"input-group-append"],["type","submit",1,"btn","btn-primary"],[1,"flaticon-search-1"],[1,"primeng-datatable-container",3,"busyIf"],["selectionMode","multiple",3,"value","rows","paginator","lazy","tableStyle","selection","onLazyLoad","selectionChange"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],[1,"btn","btn-primary","fw-bold",3,"buttonBusy","busyText","disabled","click"],[1,"fa","fa-save"],[2,"width","38px"],[3,"pSelectableRow"],[3,"value","click"],[1,"p-column-title"],[1,"primeng-no-data"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return n.shown()}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5)(6,"span"),e._uU(7),e.ALo(8,"localize"),e.qZA()(),e.TgZ(9,"button",6),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(10,"div",7)(11,"form",8),e.NdJ("ngSubmit",function(){return n.refreshTable()}),e.TgZ(12,"div",9)(13,"input",10),e.NdJ("ngModelChange",function(l){return n.filterText=l}),e.ALo(14,"localize"),e.qZA(),e.TgZ(15,"div",11)(16,"button",12),e._UZ(17,"i",13),e.qZA()()(),e.TgZ(18,"div",14)(19,"p-table",15,16),e.NdJ("onLazyLoad",function(l){return n.getRecordsIfNeeds(l)})("selectionChange",function(l){return n.selectedMembers=l}),e.YNc(21,re,12,9,"ng-template",17),e.YNc(22,le,18,14,"ng-template",18),e.qZA(),e.YNc(23,se,3,3,"div",19),e.TgZ(24,"div",20)(25,"p-paginator",21,22),e.NdJ("onPageChange",function(l){return n.getRecordsIfNeeds(l)}),e.ALo(27,"localize"),e.qZA()()()()(),e.TgZ(28,"div",23)(29,"button",24),e.NdJ("click",function(){return n.close()}),e._uU(30),e.ALo(31,"localize"),e.qZA(),e.TgZ(32,"button",25),e.NdJ("click",function(){return n.addUsersToOrganizationUnit()}),e._UZ(33,"i",26),e.TgZ(34,"span"),e._uU(35),e.ALo(36,"localize"),e.qZA()()()()()()),2&i&&(e.Q6J("config",e.VKq(37,de,!n.saving)),e.xp6(7),e.Oqu(e.lcZ(8,26,"SelectUsers")),e.xp6(2),e.Q6J("disabled",n.saving),e.uIk("aria-label",n.l("Close")),e.xp6(4),e.s9C("placeholder",e.lcZ(14,28,"SearchWithThreeDot")),e.Q6J("ngModel",n.filterText),e.xp6(4),e.uIk("aria-label",n.l("Search")),e.xp6(1),e.Q6J("busyIf",n.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",n.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",n.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(39,pe))("selection",n.selectedMembers),e.xp6(4),e.Q6J("ngIf",0==n.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",n.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",n.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",n.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(27,30,"TotalRecordsCount",n.primengTableHelper.totalRecordsCount)),e.xp6(4),e.Q6J("disabled",n.saving),e.xp6(1),e.hij(" ",e.lcZ(31,33,"Cancel")," "),e.xp6(2),e.Q6J("buttonBusy",n.saving)("busyText",n.l("SavingWithThreeDot"))("disabled",!(null!=n.selectedMembers&&n.selectedMembers.length)),e.xp6(3),e.Oqu(e.lcZ(36,35,"Save")))},dependencies:[_.O5,r._Y,r.Fj,r.JJ,r.JL,r.On,r.F,d.L,G.h,R.U,h.iA,C.jx,h.Ei,h.UA,h.Mo,O.D,u.Z,c.F],encapsulation:2})}return o})();var F=s(88922);const me=["addMemberModal"],ge=["dataTable"],ue=["paginator"];function he(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openAddMemberModal())}),e._UZ(1,"i",18),e._uU(2),e.ALo(3,"localize"),e.qZA()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"AddMember")," "))}function _e(o,p){1&o&&(e.TgZ(0,"tr")(1,"th",19),e.ALo(2,"permission"),e._uU(3),e.ALo(4,"localize"),e.qZA(),e.TgZ(5,"th",20),e._uU(6),e.ALo(7,"localize"),e._UZ(8,"p-sortIcon",21),e.qZA(),e.TgZ(9,"th",22),e._uU(10),e.ALo(11,"localize"),e._UZ(12,"p-sortIcon",23),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("hidden",!e.lcZ(2,4,"Pages.Administration.OrganizationUnits.ManageMembers")),e.xp6(2),e.hij(" ",e.lcZ(4,6,"Delete")," "),e.xp6(3),e.hij(" ",e.lcZ(7,8,"UserName")," "),e.xp6(4),e.hij(" ",e.lcZ(11,10,"AddedTime")," "))}function be(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td",24),e.ALo(2,"permission"),e.TgZ(3,"button",25),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.removeMember(a))}),e.ALo(4,"localize"),e._UZ(5,"i",26),e.qZA()(),e.TgZ(6,"td")(7,"span",27),e._uU(8),e.ALo(9,"localize"),e.qZA(),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"span",27),e._uU(13),e.ALo(14,"localize"),e.qZA(),e._uU(15),e.ALo(16,"luxonFormat"),e.qZA()()}if(2&o){const t=p.$implicit,i=e.oxw();e.xp6(1),e.Q6J("hidden",!e.lcZ(2,7,"Pages.Administration.OrganizationUnits.ManageMembers")),e.xp6(2),e.s9C("title",e.lcZ(4,9,"Delete")),e.xp6(2),e.uIk("aria-label",i.l("Delete")),e.xp6(3),e.Oqu(e.lcZ(9,11,"UserName")),e.xp6(2),e.hij(" ",t.userName," "),e.xp6(3),e.Oqu(e.lcZ(14,13,"AddedTime")),e.xp6(2),e.hij(" ",e.xi3(16,15,t.addedTime,"F")," ")}}function fe(o,p){1&o&&(e.TgZ(0,"div",28),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}function Te(o,p){1&o&&(e.TgZ(0,"div",29),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SelectAnOrganizationUnitToSeeMembers"),"\n"))}const ze=function(){return{"min-width":"25rem"}};let Ce=(()=>{class o extends b.c{constructor(t,i){super(t),this._organizationUnitService=i,this.memberRemoved=new e.vpe,this.membersAdded=new e.vpe,this._organizationUnit=null}get organizationUnit(){return this._organizationUnit}set organizationUnit(t){t?this._organizationUnit!==t&&(this._organizationUnit=t,this.addMemberModal.organizationUnitId=t.id,t&&this.refreshMembers()):this._organizationUnit=null}ngOnInit(){}getOrganizationUnitUsers(t){this._organizationUnit&&(this.primengTableHelper.shouldResetPaging(t)&&(this.paginator.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0)||(this.primengTableHelper.showLoadingIndicator(),this._organizationUnitService.getOrganizationUnitUsers(this._organizationUnit.id,this.primengTableHelper.getSorting(this.dataTable),this.primengTableHelper.getMaxResultCount(this.paginator,t),this.primengTableHelper.getSkipCount(this.paginator,t)).pipe((0,T.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(i=>{this.primengTableHelper.totalRecordsCount=i.totalCount,this.primengTableHelper.records=i.items,this.primengTableHelper.hideLoadingIndicator()})))}reloadPage(){this.getOrganizationUnitUsers(null),this.paginator.changePage(this.paginator.getPage())}refreshMembers(){this.reloadPage()}openAddMemberModal(){this.addMemberModal.show()}removeMember(t){this.message.confirm(this.l("RemoveUserFromOuWarningMessage",t.userName,this.organizationUnit.displayName),this.l("AreYouSure"),i=>{i&&this._organizationUnitService.removeUserFromOrganizationUnit(t.id,this.organizationUnit.id).subscribe(()=>{this.notify.success(this.l("SuccessfullyRemoved")),this.memberRemoved.emit({userId:t.id,ouId:this.organizationUnit.id}),this.refreshMembers()})})}addMembers(t){this.membersAdded.emit({userIds:t.userIds,ouId:t.ouId}),this.refreshMembers()}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.zs3),e.Y36(g.OAl))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["organization-unit-members"]],viewQuery:function(i,n){if(1&i&&(e.Gf(me,7),e.Gf(ge,7),e.Gf(ue,7)),2&i){let a;e.iGM(a=e.CRH())&&(n.addMemberModal=a.first),e.iGM(a=e.CRH())&&(n.dataTable=a.first),e.iGM(a=e.CRH())&&(n.paginator=a.first)}},outputs:{memberRemoved:"memberRemoved",membersAdded:"membersAdded"},features:[e.qOj],decls:19,vars:21,consts:[[1,"row"],[1,"col-12","p-3"],["class","btn btn-outline btn-outline-primary btn-sm float-end mb-3",3,"click",4,"ngIf"],[1,"col-12"],["id","OuMembersTable"],[1,"primeng-datatable-container",3,"busyIf","hidden"],["sortMode","multiple",3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],["class","text-muted",4,"ngIf"],[3,"membersAdded"],["addMemberModal",""],[1,"btn","btn-outline","btn-outline-primary","btn-sm","float-end","mb-3",3,"click"],[1,"fa","fa-plus"],[2,"width","15%",3,"hidden"],["pSortableColumn","userName"],["field","userName"],["pSortableColumn","addedTime"],["field","addedTime"],[3,"hidden"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-danger","btn-sm",3,"title","click"],[1,"fa","fa-times"],[1,"p-column-title"],[1,"primeng-no-data"],[1,"text-muted"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,he,4,3,"button",2),e.ALo(3,"permission"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"p-table",6,7),e.NdJ("onLazyLoad",function(l){return n.getOrganizationUnitUsers(l)}),e.YNc(9,_e,13,12,"ng-template",8),e.YNc(10,be,17,18,"ng-template",9),e.qZA(),e.YNc(11,fe,3,3,"div",10),e.TgZ(12,"div",11)(13,"p-paginator",12,13),e.NdJ("onPageChange",function(l){return n.getOrganizationUnitUsers(l)}),e.ALo(15,"localize"),e.qZA()()()()()(),e.YNc(16,Te,3,3,"div",14),e.TgZ(17,"addMemberModal",15,16),e.NdJ("membersAdded",function(l){return n.addMembers(l)}),e.qZA()),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,15,"Pages.Administration.OrganizationUnits.ManageMembers")&&n.organizationUnit),e.xp6(4),e.Q6J("busyIf",n.primengTableHelper.isLoading)("hidden",!n.organizationUnit),e.xp6(1),e.s9C("rows",n.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",n.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(20,ze)),e.xp6(4),e.Q6J("ngIf",0==n.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",n.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",n.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",n.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(15,17,"TotalRecordsCount",n.primengTableHelper.totalRecordsCount)),e.xp6(3),e.Q6J("ngIf",!n.organizationUnit))},dependencies:[_.O5,R.U,h.iA,C.jx,h.lQ,h.fz,O.D,ce,F.n,c.F,D.a],encapsulation:2})}return o})();const Ue=["modal"],ve=["dataTable"],Ae=["paginator"];function Ze(o,p){1&o&&(e.TgZ(0,"tr")(1,"th",27),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.ALo(5,"localize"),e.qZA()()),2&o&&(e.xp6(4),e.hij(" ",e.lcZ(5,1,"Name")," "))}function Me(o,p){if(1&o&&(e.TgZ(0,"tr",28)(1,"td",27)(2,"p-tableCheckbox",29),e.NdJ("click",function(i){return i.stopPropagation()}),e.qZA()(),e.TgZ(3,"td")(4,"span",30),e._uU(5),e.ALo(6,"localize"),e.qZA(),e._uU(7),e.qZA()()),2&o){const t=p.$implicit;e.Q6J("pSelectableRow",t),e.xp6(2),e.Q6J("value",t),e.xp6(3),e.Oqu(e.lcZ(6,4,"Name")),e.xp6(2),e.hij(" ",t.name," ")}}function ye(o,p){1&o&&(e.TgZ(0,"div",31),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const Re=function(o){return{backdrop:"static",keyboard:o}},Oe=function(){return{"min-width":"25rem"}};let Ne=(()=>{class o extends b.c{constructor(t,i){super(t),this._organizationUnitService=i,this.rolesAdded=new e.vpe,this.isShown=!1,this.filterText="",this.saving=!1}show(){this.modal.show()}refreshTable(){this.paginator.changePage(this.paginator.getPage())}close(){this.modal.hide()}shown(){this.isShown=!0,this.getRecordsIfNeeds(null)}getRecordsIfNeeds(t){this.isShown&&this.getRecords(t)}getRecords(t){if(this.primengTableHelper.shouldResetPaging(t)&&(this.paginator.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0))return;this.primengTableHelper.showLoadingIndicator();const i=new g.eQS;i.organizationUnitId=this.organizationUnitId,i.filter=this.filterText,i.skipCount=this.primengTableHelper.getSkipCount(this.paginator,t),i.maxResultCount=this.primengTableHelper.getMaxResultCount(this.paginator,t),this._organizationUnitService.findRoles(i).pipe((0,T.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(n=>{this.primengTableHelper.totalRecordsCount=n.totalCount,this.primengTableHelper.records=n.items,this.primengTableHelper.hideLoadingIndicator()})}addRolesToOrganizationUnit(){const t=new g.r96;t.organizationUnitId=this.organizationUnitId,t.roleIds=(0,Q.Z)(this.selectedRoles,i=>Number(i.value)),this.saving=!0,this._organizationUnitService.addRolesToOrganizationUnit(t).subscribe(()=>{this.notify.success(this.l("SuccessfullyAdded")),this.rolesAdded.emit({roleIds:t.roleIds,ouId:t.organizationUnitId}),this.saving=!1,this.close(),this.selectedRoles=[]})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.zs3),e.Y36(g.OAl))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["addRoleModal"]],viewQuery:function(i,n){if(1&i&&(e.Gf(Ue,7),e.Gf(ve,7),e.Gf(Ae,7)),2&i){let a;e.iGM(a=e.CRH())&&(n.modal=a.first),e.iGM(a=e.CRH())&&(n.dataTable=a.first),e.iGM(a=e.CRH())&&(n.paginator=a.first)}},outputs:{rolesAdded:"rolesAdded"},features:[e.qOj],decls:37,vars:40,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","modal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["modal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],["novalidate","","autocomplete","new-password",3,"ngSubmit"],[1,"input-group","mb-2"],["autoFocus","","name","filterText","type","text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"input-group-append"],["type","submit",1,"btn","btn-primary"],[1,"flaticon-search-1"],[1,"primeng-datatable-container",3,"busyIf"],["selectionMode","multiple",3,"value","rows","paginator","lazy","tableStyle","selection","onLazyLoad","selectionChange"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],[1,"btn","btn-primary","fw-bold",3,"buttonBusy","busyText","disabled","click"],[1,"fa","fa-save"],[2,"width","38px"],[3,"pSelectableRow"],[3,"value","click"],[1,"p-column-title"],[1,"primeng-no-data"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return n.shown()}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5)(6,"span"),e._uU(7),e.ALo(8,"localize"),e.qZA()(),e.TgZ(9,"button",6),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(10,"div",7)(11,"form",8),e.NdJ("ngSubmit",function(){return n.refreshTable()}),e.TgZ(12,"div",9)(13,"input",10),e.NdJ("ngModelChange",function(l){return n.filterText=l}),e.ALo(14,"localize"),e.qZA(),e.TgZ(15,"div",11)(16,"button",12),e._UZ(17,"i",13),e.qZA()()(),e.TgZ(18,"div",14)(19,"p-table",15,16),e.NdJ("onLazyLoad",function(l){return n.getRecordsIfNeeds(l)})("selectionChange",function(l){return n.selectedRoles=l}),e.YNc(21,Ze,6,3,"ng-template",17),e.YNc(22,Me,8,6,"ng-template",18),e.qZA(),e.YNc(23,ye,3,3,"div",19),e.TgZ(24,"div",20)(25,"p-paginator",21,22),e.NdJ("onPageChange",function(l){return n.getRecordsIfNeeds(l)}),e.ALo(27,"localize"),e.qZA()()()()(),e.TgZ(28,"div",23)(29,"button",24),e.NdJ("click",function(){return n.close()}),e._uU(30),e.ALo(31,"localize"),e.qZA(),e.TgZ(32,"button",25),e.NdJ("click",function(){return n.addRolesToOrganizationUnit()}),e._UZ(33,"i",26),e.TgZ(34,"span"),e._uU(35),e.ALo(36,"localize"),e.qZA()()()()()()),2&i&&(e.Q6J("config",e.VKq(37,Re,!n.saving)),e.xp6(7),e.Oqu(e.lcZ(8,26,"SelectRoles")),e.xp6(2),e.Q6J("disabled",n.saving),e.uIk("aria-label",n.l("Close")),e.xp6(4),e.s9C("placeholder",e.lcZ(14,28,"SearchWithThreeDot")),e.Q6J("ngModel",n.filterText),e.xp6(4),e.uIk("aria-label",n.l("Search")),e.xp6(1),e.Q6J("busyIf",n.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",n.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",n.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(39,Oe))("selection",n.selectedRoles),e.xp6(4),e.Q6J("ngIf",0==n.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",n.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",n.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",n.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(27,30,"TotalRecordsCount",n.primengTableHelper.totalRecordsCount)),e.xp6(4),e.Q6J("disabled",n.saving),e.xp6(1),e.hij(" ",e.lcZ(31,33,"Cancel")," "),e.xp6(2),e.Q6J("buttonBusy",n.saving)("busyText",n.l("SavingWithThreeDot"))("disabled",!(null!=n.selectedRoles&&n.selectedRoles.length)),e.xp6(3),e.Oqu(e.lcZ(36,35,"Save")))},dependencies:[_.O5,r._Y,r.Fj,r.JJ,r.JL,r.On,r.F,d.L,G.h,R.U,h.iA,C.jx,h.Ei,h.UA,h.Mo,O.D,u.Z,c.F],encapsulation:2})}return o})();const xe=["addRoleModal"],Ie=["dataTable"],Se=["paginator"];function He(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openAddRoleModal())}),e._UZ(1,"i",18),e._uU(2),e.ALo(3,"localize"),e.qZA()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"AddRole")," "))}function we(o,p){1&o&&(e.TgZ(0,"tr")(1,"th",19),e.ALo(2,"permission"),e._uU(3),e.ALo(4,"localize"),e.qZA(),e.TgZ(5,"th",20),e._uU(6),e.ALo(7,"localize"),e._UZ(8,"p-sortIcon",21),e.qZA(),e.TgZ(9,"th",22),e._uU(10),e.ALo(11,"localize"),e._UZ(12,"p-sortIcon",23),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("hidden",!e.lcZ(2,4,"Pages.Administration.OrganizationUnits.ManageRoles")),e.xp6(2),e.hij(" ",e.lcZ(4,6,"Delete")," "),e.xp6(3),e.hij(" ",e.lcZ(7,8,"Role")," "),e.xp6(4),e.hij(" ",e.lcZ(11,10,"AddedTime")," "))}function Le(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td",24),e.ALo(2,"permission"),e.TgZ(3,"button",25),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.removeRole(a))}),e.ALo(4,"localize"),e._UZ(5,"i",26),e.qZA()(),e.TgZ(6,"td")(7,"span",27),e._uU(8),e.ALo(9,"localize"),e.qZA(),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"span",27),e._uU(13),e.ALo(14,"localize"),e.qZA(),e._uU(15),e.ALo(16,"luxonFormat"),e.qZA()()}if(2&o){const t=p.$implicit,i=e.oxw();e.xp6(1),e.Q6J("hidden",!e.lcZ(2,7,"Pages.Administration.OrganizationUnits.ManageRoles")),e.xp6(2),e.s9C("title",e.lcZ(4,9,"Delete")),e.xp6(2),e.uIk("aria-label",i.l("Delete")),e.xp6(3),e.Oqu(e.lcZ(9,11,"Role")),e.xp6(2),e.hij(" ",t.displayName," "),e.xp6(3),e.Oqu(e.lcZ(14,13,"AddedTime")),e.xp6(2),e.hij(" ",e.xi3(16,15,t.addedTime,"F")," ")}}function Je(o,p){1&o&&(e.TgZ(0,"div",28),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}function Pe(o,p){1&o&&(e.TgZ(0,"div",29),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SelectAnOrganizationUnitToSeeRoles"),"\n"))}const qe=function(){return{"min-width":"25rem"}};let De=(()=>{class o extends b.c{constructor(t,i,n){super(t),this._changeDetector=i,this._organizationUnitService=n,this.roleRemoved=new e.vpe,this.rolesAdded=new e.vpe,this._organizationUnit=null}get organizationUnit(){return this._organizationUnit}set organizationUnit(t){t?this._organizationUnit!==t&&(this._organizationUnit=t,this.addRoleModal.organizationUnitId=t.id,t&&this.refreshRoles()):this._organizationUnit=null}ngOnInit(){}getOrganizationUnitRoles(t){this._organizationUnit&&(this.primengTableHelper.shouldResetPaging(t)&&(this.paginator.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0)||(this.primengTableHelper.showLoadingIndicator(),this._organizationUnitService.getOrganizationUnitRoles(this._organizationUnit.id,this.primengTableHelper.getSorting(this.dataTable),this.primengTableHelper.getMaxResultCount(this.paginator,t),this.primengTableHelper.getSkipCount(this.paginator,t)).pipe((0,T.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(i=>{this.primengTableHelper.totalRecordsCount=i.totalCount,this.primengTableHelper.records=i.items,this.primengTableHelper.hideLoadingIndicator()})))}reloadPage(){this.getOrganizationUnitRoles(null),this.paginator.changePage(this.paginator.getPage())}refreshRoles(){this.reloadPage()}openAddRoleModal(){this.addRoleModal.show()}removeRole(t){this.message.confirm(this.l("RemoveRoleFromOuWarningMessage",t.displayName,this.organizationUnit.displayName),this.l("AreYouSure"),i=>{i&&this._organizationUnitService.removeRoleFromOrganizationUnit(t.id,this.organizationUnit.id).subscribe(()=>{this.notify.success(this.l("SuccessfullyRemoved")),this.roleRemoved.emit({roleId:t.id,ouId:this.organizationUnit.id}),this.refreshRoles()})})}addRoles(t){this.rolesAdded.emit({roleIds:t.roleIds,ouId:t.ouId}),this.refreshRoles()}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.zs3),e.Y36(e.sBO),e.Y36(g.OAl))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["organization-unit-roles"]],viewQuery:function(i,n){if(1&i&&(e.Gf(xe,7),e.Gf(Ie,7),e.Gf(Se,7)),2&i){let a;e.iGM(a=e.CRH())&&(n.addRoleModal=a.first),e.iGM(a=e.CRH())&&(n.dataTable=a.first),e.iGM(a=e.CRH())&&(n.paginator=a.first)}},outputs:{roleRemoved:"roleRemoved",rolesAdded:"rolesAdded"},features:[e.qOj],decls:19,vars:21,consts:[[1,"row"],[1,"col-12","p-3"],["class","btn btn-outline btn-outline-primary btn-sm float-end mb-3",3,"click",4,"ngIf"],[1,"col-12"],["id","OuRolesTable"],[1,"primeng-datatable-container",3,"busyIf","hidden"],["sortMode","multiple",3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],["class","text-muted",4,"ngIf"],[3,"rolesAdded"],["addRoleModal",""],[1,"btn","btn-outline","btn-outline-primary","btn-sm","float-end","mb-3",3,"click"],[1,"fa","fa-plus"],[2,"width","15%",3,"hidden"],["pSortableColumn","displayName"],["field","displayName"],["pSortableColumn","addedTime"],["field","addedTime"],[3,"hidden"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-danger","btn-sm",3,"title","click"],[1,"fa","fa-times"],[1,"p-column-title"],[1,"primeng-no-data"],[1,"text-muted"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,He,4,3,"button",2),e.ALo(3,"permission"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"p-table",6,7),e.NdJ("onLazyLoad",function(l){return n.getOrganizationUnitRoles(l)}),e.YNc(9,we,13,12,"ng-template",8),e.YNc(10,Le,17,18,"ng-template",9),e.qZA(),e.YNc(11,Je,3,3,"div",10),e.TgZ(12,"div",11)(13,"p-paginator",12,13),e.NdJ("onPageChange",function(l){return n.getOrganizationUnitRoles(l)}),e.ALo(15,"localize"),e.qZA()()()()()(),e.YNc(16,Pe,3,3,"div",14),e.TgZ(17,"addRoleModal",15,16),e.NdJ("rolesAdded",function(l){return n.addRoles(l)}),e.qZA()),2&i&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,15,"Pages.Administration.OrganizationUnits.ManageRoles")&&n.organizationUnit),e.xp6(4),e.Q6J("busyIf",n.primengTableHelper.isLoading)("hidden",!n.organizationUnit),e.xp6(1),e.s9C("rows",n.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",n.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(20,qe)),e.xp6(4),e.Q6J("ngIf",0==n.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",n.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",n.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",n.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(15,17,"TotalRecordsCount",n.primengTableHelper.totalRecordsCount)),e.xp6(3),e.Q6J("ngIf",!n.organizationUnit))},dependencies:[_.O5,R.U,h.iA,C.jx,h.lQ,h.fz,O.D,Ne,F.n,c.F,D.a],encapsulation:2})}return o})();const Qe=["ouMembers"],Ge=["ouRoles"],Fe=["ouTree"];function Ee(o,p){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.organizationUnit.displayName)}}const Ye=[{path:"",component:(()=>{class o extends b.c{constructor(t){super(t),this.organizationUnit=null}ouSelected(t){this.organizationUnit=t,this.ouMembers.organizationUnit=t,this.ouRoles.organizationUnit=t}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&(e.Gf(Qe,7),e.Gf(Ge,7),e.Gf(Fe,7)),2&i){let a;e.iGM(a=e.CRH())&&(n.ouMembers=a.first),e.iGM(a=e.CRH())&&(n.ouRoles=a.first),e.iGM(a=e.CRH())&&(n.ouTree=a.first)}},features:[e.qOj],decls:25,vars:17,consts:[[3,"title","description"],[1,"row"],[1,"col-6"],[3,"ouSelected"],["ouTree",""],[1,"card","card-custom","gutter-b"],[1,"card-header","align-items-center","border-0"],[1,"card-title","align-items-start","flex-column"],[1,"fw-bolder","text-dark"],[4,"ngIf"],[1,"card-body"],[1,"tab-container"],[3,"heading","active"],[3,"membersAdded","memberRemoved"],["ouMembers",""],[3,"heading"],[3,"rolesAdded","roleRemoved"],["ouRoles",""]],template:function(i,n){if(1&i){const a=e.EpF();e.TgZ(0,"div"),e._UZ(1,"sub-header",0),e.ALo(2,"localize"),e.ALo(3,"localize"),e.TgZ(4,"div")(5,"div",1)(6,"div",2)(7,"organization-tree",3,4),e.NdJ("ouSelected",function(f){return n.ouSelected(f)}),e.qZA()(),e.TgZ(9,"div",2)(10,"div",5)(11,"div",6)(12,"h3",7)(13,"span",8),e.YNc(14,Ee,2,1,"span",9),e.qZA()()(),e.TgZ(15,"div",10)(16,"tabset",11)(17,"tab",12),e.ALo(18,"localize"),e.TgZ(19,"organization-unit-members",13,14),e.NdJ("membersAdded",function(f){e.CHM(a);const U=e.MAs(8);return e.KtG(U.membersAdded(f))})("memberRemoved",function(f){e.CHM(a);const U=e.MAs(8);return e.KtG(U.memberRemoved(f))}),e.qZA()(),e.TgZ(21,"tab",15),e.ALo(22,"localize"),e.TgZ(23,"organization-unit-roles",16,17),e.NdJ("rolesAdded",function(f){e.CHM(a);const U=e.MAs(8);return e.KtG(U.rolesAdded(f))})("roleRemoved",function(f){e.CHM(a);const U=e.MAs(8);return e.KtG(U.roleRemoved(f))}),e.qZA()()()()()()()()()}2&i&&(e.Q6J("@routerTransition",void 0),e.xp6(1),e.Q6J("title",e.lcZ(2,9,"OrganizationUnits"))("description",e.lcZ(3,11,"OrganizationUnitsHeaderInfo")),e.xp6(3),e.Tol(n.containerClass),e.xp6(10),e.Q6J("ngIf",n.organizationUnit),e.xp6(3),e.s9C("heading",e.lcZ(18,13,"Members")),e.Q6J("active",!0),e.xp6(4),e.s9C("heading",e.lcZ(22,15,"Roles")))},dependencies:[_.O5,Z.wW,Z.AH,x.$,ne,Ce,De,c.F],encapsulation:2,data:{animation:[(0,N.MH)()]}})}return o})(),pathMatch:"full"}];let je=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[A.Bz.forChild(Ye),A.Bz]})}return o})();var ke=s(71902),Ke=s(92337);let Be=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[Ke.o,ke.g,je]})}return o})()},43136:(E,v,s)=>{s.d(v,{Z:()=>T});var A=s(94138),N=s(45920);var _=s(14818);const M=function g(r,d){return d.length<2?r:(0,_.Z)(r,function Z(r,d,m){var u=-1,c=r.length;d<0&&(d=-d>c?0:c+d),(m=m>c?c:m)<0&&(m+=c),c=d>m?0:m-d>>>0,d>>>=0;for(var z=Array(c);++u<c;)z[u]=r[u+d];return z}(d,0,-1))};var I=s(77801);const H=function S(r,d){return d=(0,N.Z)(d,r),null==(r=M(r,d))||delete r[(0,I.Z)(function b(r){var d=null==r?0:r.length;return d?r[d-1]:void 0}(d))]};var w=s(19229),J=Array.prototype.splice;const T=function q(r,d){var m=[];if(!r||!r.length)return m;var u=-1,c=[],z=r.length;for(d=(0,A.Z)(d,3);++u<z;){var y=r[u];d(y,u,r)&&(m.push(y),c.push(u))}return function C(r,d){for(var m=r?d.length:0,u=m-1;m--;){var c=d[m];if(m==u||c!==z){var z=c;(0,w.Z)(c)?J.call(r,c,1):H(r,c)}}}(r,c),m}}}]);