"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[83297],{83297:(ke,y,s)=>{s.r(y),s.d(y,{TenantsModule:()=>Qe});var U=s(71902),I=s(92337),C=s(70916),E=s(47530),h=s(41840),u=s(44328),f=s(66232),g=s(64716),e=s(99468),J=s(12990),x=s(58399),m=s(96814),l=s(56223),Z=s(72500),N=s(56906),L=s(76388),D=s(94901),v=s(68027),F=s(85219),P=s(51712),H=s(68989),T=s(53279),R=s(78176),Q=s(24276),M=s(45513),S=s(42152),q=s(34714),w=s(77327),A=s(24142),b=s(3291);const z=["createModal"];function k(a,d){1&a&&(e.TgZ(0,"span",49),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TenantName_Regex_Description")," "))}const p=function(a){return{edited:a}};function G(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"label",50),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"input",51,52),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw(2);return e.KtG(o.tenant.connectionString=n)}),e.qZA(),e._UZ(6,"validation-messages",15),e.qZA()}if(2&a){const t=e.MAs(5),i=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,4,"DatabaseConnectionString")),e.xp6(2),e.Q6J("ngModel",i.tenant.connectionString)("ngClass",e.VKq(6,p,i.tenant.connectionString)),e.xp6(2),e.Q6J("formCtrl",t)}}function O(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"label",53),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"input",54,55),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw(2);return e.KtG(o.tenant.adminPassword=n)}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,9,"AdminPassword")),e.xp6(2),e.Q6J("ngModel",t.tenant.adminPassword)("ngClass",e.VKq(11,p,t.tenant.adminPassword))("required",!t.setRandomPassword)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength)}}function K(a,d){if(1&a&&(e.TgZ(0,"ul",56)(1,"li",33),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"li",33),e._uU(5),e.ALo(6,"localize"),e.qZA(),e.TgZ(7,"li",33),e._uU(8),e.ALo(9,"localize"),e.qZA(),e.TgZ(10,"li",33),e._uU(11),e.ALo(12,"localize"),e.qZA(),e.TgZ(13,"li",33),e._uU(14),e.ALo(15,"localize"),e.qZA()()),2&a){e.oxw();const t=e.MAs(1),i=e.oxw();e.xp6(1),e.Q6J("hidden",!t.controls.adminPassword.errors.requireDigit),e.xp6(1),e.hij(" ",e.lcZ(3,10,"PasswordComplexity_RequireDigit_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPassword.errors.requireLowercase),e.xp6(1),e.hij(" ",e.lcZ(6,12,"PasswordComplexity_RequireLowercase_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPassword.errors.requireUppercase),e.xp6(1),e.hij(" ",e.lcZ(9,14,"PasswordComplexity_RequireUppercase_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPassword.errors.requireNonAlphanumeric),e.xp6(1),e.hij(" ",e.lcZ(12,16,"PasswordComplexity_RequireNonAlphanumeric_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPassword.errors.requiredLength),e.xp6(1),e.hij(" ",e.xi3(15,18,"PasswordComplexity_RequiredLength_Hint",i.passwordComplexitySetting.requiredLength)," ")}}function j(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"label",57),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"input",58,59),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw(2);return e.KtG(o.tenantAdminPasswordRepeat=n)}),e.qZA()()}if(2&a){const t=e.MAs(5),i=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,9,"AdminPasswordRepeat")),e.xp6(2),e.Q6J("ngModel",i.tenantAdminPasswordRepeat)("ngClass",e.VKq(11,p,t))("required",!i.setRandomPassword)("requireDigit",i.passwordComplexitySetting.requireDigit)("requireLowercase",i.passwordComplexitySetting.requireLowercase)("requireUppercase",i.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",i.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",i.passwordComplexitySetting.requiredLength)}}function Y(a,d){if(1&a&&(e.TgZ(0,"ul",56)(1,"li",33),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"li",33),e._uU(5),e.ALo(6,"localize"),e.qZA(),e.TgZ(7,"li",33),e._uU(8),e.ALo(9,"localize"),e.qZA(),e.TgZ(10,"li",33),e._uU(11),e.ALo(12,"localize"),e.qZA(),e.TgZ(13,"li",33),e._uU(14),e.ALo(15,"localize"),e.qZA(),e.TgZ(16,"li",33),e._uU(17),e.ALo(18,"localize"),e.qZA()()),2&a){e.oxw();const t=e.MAs(1),i=e.oxw();e.xp6(1),e.Q6J("hidden",!t.controls.adminPasswordRepeat.errors.requireDigit),e.xp6(1),e.hij(" ",e.lcZ(3,12,"PasswordComplexity_RequireDigit_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPasswordRepeat.errors.requireLowercase),e.xp6(1),e.hij(" ",e.lcZ(6,14,"PasswordComplexity_RequireLowercase_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPasswordRepeat.errors.requireUppercase),e.xp6(1),e.hij(" ",e.lcZ(9,16,"PasswordComplexity_RequireUppercase_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPasswordRepeat.errors.requireNonAlphanumeric),e.xp6(1),e.hij(" ",e.lcZ(12,18,"PasswordComplexity_RequireNonAlphanumeric_Hint")," "),e.xp6(2),e.Q6J("hidden",!t.controls.adminPasswordRepeat.errors.requiredLength),e.xp6(1),e.hij(" ",e.xi3(15,20,"PasswordComplexity_RequiredLength_Hint",i.passwordComplexitySetting.requiredLength)," "),e.xp6(2),e.Q6J("hidden",t.controls.adminPasswordRepeat.valid),e.xp6(1),e.hij(" ",e.lcZ(18,23,"PasswordsDontMatch")," ")}}const V=function(a){return{"has-error":a}},B=function(){return{adaptivePosition:!0}};function W(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("submit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e.TgZ(2,"div",7)(3,"h5",8)(4,"span"),e._uU(5),e.ALo(6,"localize"),e.qZA()(),e.TgZ(7,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e.qZA()(),e.TgZ(8,"div",10)(9,"div",11)(10,"label",12),e._uU(11),e.ALo(12,"localize"),e.qZA(),e.TgZ(13,"input",13,14),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.tenancyName=n)}),e.qZA(),e._UZ(16,"validation-messages",15),e.qZA(),e.TgZ(17,"div"),e.YNc(18,k,3,3,"span",16),e.qZA(),e.TgZ(19,"div",11)(20,"label",17),e._uU(21),e.ALo(22,"localize"),e.qZA(),e.TgZ(23,"input",18,19),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.name=n)}),e.qZA(),e._UZ(25,"validation-messages",15),e.qZA(),e.YNc(26,G,7,8,"div",20),e.TgZ(27,"div",11)(28,"label",21),e._uU(29),e.ALo(30,"localize"),e.qZA(),e.TgZ(31,"input",22,23),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.adminName=n)}),e.qZA(),e._UZ(33,"validation-messages",15),e.qZA(),e.TgZ(34,"div",11)(35,"label",24),e._uU(36),e.ALo(37,"localize"),e.qZA(),e.TgZ(38,"input",25,26),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.adminSurname=n)}),e.qZA(),e._UZ(40,"validation-messages",15),e.qZA(),e.TgZ(41,"div",11)(42,"label",27),e._uU(43),e.ALo(44,"localize"),e.qZA(),e.TgZ(45,"input",28,29),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.adminEmailAddress=n)}),e.qZA(),e._UZ(47,"validation-messages",15),e.qZA(),e.TgZ(48,"div",11)(49,"label",30),e._uU(50," Country"),e.qZA(),e.TgZ(51,"div",31)(52,"p-autoComplete",32),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.country=n)})("completeMethod",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.filterCountries(n))}),e.qZA()()(),e.YNc(53,O,6,13,"div",20),e.TgZ(54,"div",33),e.YNc(55,K,16,21,"ul",34),e.qZA(),e.YNc(56,j,6,13,"div",20),e.TgZ(57,"div",33),e.YNc(58,Y,19,25,"ul",34),e.qZA(),e.TgZ(59,"label",35)(60,"input",36),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.isUnlimited=n)})("change",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onIsUnlimitedChange())}),e.qZA(),e.TgZ(61,"span",37),e._uU(62),e.ALo(63,"localize"),e.qZA()(),e.TgZ(64,"div",38)(65,"label",39),e._uU(66),e.ALo(67,"localize"),e.qZA(),e.TgZ(68,"input",40,41),e.NdJ("dateChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.subscriptionEndDateUtc=n)}),e.qZA()(),e.TgZ(70,"label",35)(71,"input",42),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.isInTrialPeriod=n)}),e.qZA(),e.TgZ(72,"span",37),e._uU(73),e.ALo(74,"localize"),e.qZA()(),e.TgZ(75,"label",43)(76,"input",44),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.isActive=n)}),e.qZA(),e.TgZ(77,"span",37),e._uU(78),e.ALo(79,"localize"),e.qZA()()(),e.TgZ(80,"div",45)(81,"button",46),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e._uU(82),e.ALo(83,"localize"),e.qZA(),e.TgZ(84,"button",47),e._UZ(85,"i",48),e.TgZ(86,"span"),e._uU(87),e.ALo(88,"localize"),e.qZA()()()()}if(2&a){const t=e.MAs(1),i=e.MAs(14),n=e.MAs(15),o=e.MAs(24),c=e.MAs(32),_=e.MAs(39),ze=e.MAs(46),r=e.oxw();e.xp6(5),e.Oqu(e.lcZ(6,54,"CreateNewTenant")),e.xp6(2),e.Q6J("disabled",r.saving),e.uIk("aria-label",r.l("Close")),e.xp6(4),e.Oqu(e.lcZ(12,56,"TenancyName")),e.xp6(2),e.Q6J("ngClass",e.VKq(78,p,r.tenant.tenancyName))("ngModel",r.tenant.tenancyName),e.xp6(3),e.Q6J("formCtrl",i),e.xp6(2),e.Q6J("ngIf",!n.valid&&!n.pristine),e.xp6(3),e.Oqu(e.lcZ(22,58,"Name")),e.xp6(2),e.Q6J("ngClass",e.VKq(80,p,r.tenant.name))("ngModel",r.tenant.name),e.xp6(2),e.Q6J("formCtrl",o),e.xp6(1),e.Q6J("ngIf",!r.useHostDb),e.xp6(3),e.Oqu(e.lcZ(30,60,"AdminName")),e.xp6(2),e.Q6J("ngModel",r.tenant.adminName)("ngClass",e.VKq(82,p,r.tenant.adminName)),e.xp6(2),e.Q6J("formCtrl",c),e.xp6(3),e.Oqu(e.lcZ(37,62,"AdminSurname")),e.xp6(2),e.Q6J("ngModel",r.tenant.adminSurname)("ngClass",e.VKq(84,p,r.tenant.adminSurname)),e.xp6(2),e.Q6J("formCtrl",_),e.xp6(3),e.Oqu(e.lcZ(44,64,"AdminEmailAddress")),e.xp6(2),e.Q6J("ngModel",r.tenant.adminEmailAddress)("ngClass",e.VKq(86,p,r.tenant.adminEmailAddress)),e.xp6(2),e.Q6J("formCtrl",ze),e.xp6(5),e.Q6J("ngModel",r.country)("suggestions",r.filteredCountries)("minLength",1),e.xp6(1),e.Q6J("ngIf",!r.setRandomPassword),e.xp6(1),e.Q6J("hidden",t.form.valid||t.form.pristine),e.xp6(1),e.Q6J("ngIf",t.controls.adminPassword&&t.controls.adminPassword.errors),e.xp6(1),e.Q6J("ngIf",!r.setRandomPassword),e.xp6(1),e.Q6J("hidden",t.form.valid||t.form.pristine),e.xp6(1),e.Q6J("ngIf",t.controls.adminPasswordRepeat&&t.controls.adminPasswordRepeat.errors),e.xp6(1),e.Q6J("hidden",!r.isSubscriptionFieldsVisible),e.xp6(1),e.Q6J("ngModel",r.isUnlimited),e.xp6(2),e.hij(" ",e.lcZ(63,66,"UnlimitedTimeSubscription")," "),e.xp6(2),e.Q6J("hidden",r.isUnlimited||!r.isSubscriptionFieldsVisible)("ngClass",e.VKq(88,V,!r.subscriptionEndDateIsValid())),e.xp6(2),e.Oqu(e.lcZ(67,68,"SubscriptionEndDate")),e.xp6(2),e.Q6J("date",r.tenant.subscriptionEndDateUtc)("bsConfig",e.DdM(90,B)),e.xp6(2),e.Q6J("hidden",r.isUnlimited||!r.isSubscriptionFieldsVisible),e.xp6(1),e.Q6J("ngModel",r.tenant.isInTrialPeriod)("disabled",r.isSelectedEditionFree),e.xp6(2),e.hij(" ",e.lcZ(74,70,"IsInTrialPeriod")," "),e.xp6(3),e.Q6J("ngModel",r.tenant.isActive),e.xp6(2),e.hij(" ",e.lcZ(79,72,"Active")," "),e.xp6(3),e.Q6J("disabled",r.saving),e.xp6(1),e.hij(" ",e.lcZ(83,74,"Cancel")," "),e.xp6(2),e.Q6J("buttonBusy",r.saving)("busyText",r.l("SavingWithThreeDot"))("disabled",!t.form.valid||r.saving||!r.subscriptionEndDateIsValid()),e.xp6(3),e.Oqu(e.lcZ(88,76,"Save"))}}const $=function(a){return{backdrop:"static",keyboard:a}};let X=(()=>{class a extends h.c{constructor(t,i,n,o,c,_){super(t),this._tenantService=i,this._commonLookupService=n,this._profileService=o,this._dateTimeService=c,this._countryService=_,this.modalSave=new e.vpe,this.active=!1,this.saving=!1,this.setRandomPassword=!1,this.useHostDb=!0,this.editions=[],this.passwordComplexitySetting=new u.qSp,this.isUnlimited=!1,this.isSubscriptionFieldsVisible=!1,this.isSelectedEditionFree=!1,this.tenantAdminPasswordRepeat=""}show(){this.active=!0,this.init(),this._profileService.getPasswordComplexitySetting().subscribe(t=>{this.passwordComplexitySetting=t.setting,this.modal.show()})}onShown(){document.getElementById("TenancyName").focus()}init(){this.tenant=new u.uNx,this.tenant.isActive=!0,this.tenant.shouldChangePasswordOnNextLogin=!0,this.tenant.sendActivationEmail=!0,this.tenant.editionId=0,this.tenant.isInTrialPeriod=!1,this.filterCountries(""),this._commonLookupService.getEditionsForCombobox(!1).subscribe(t=>{this.editions=t.items;let i=new u.EHF;i.value="",i.displayText=this.l("NotAssigned"),this.editions.unshift(i),this._commonLookupService.getDefaultEditionName().subscribe(n=>{let o=(0,f.Z)(this.editions,{displayText:n.name});o&&o[0]&&(this.tenant.editionId=parseInt(o[0].value),this.toggleSubscriptionFields())})})}filterCountries(t){this._countryService.getCountriesList(t.query).subscribe(i=>{this.filteredCountries=i})}getEditionValue(t){return parseInt(t.value)}selectedEditionIsFree(){let t=(0,f.Z)(this.editions,{value:this.tenant.editionId.toString()}).map(n=>Object.assign(new u.EHF,n));return 1!==t.length&&(this.isSelectedEditionFree=!0),this.isSelectedEditionFree=t[0].isFree,this.isSelectedEditionFree}subscriptionEndDateIsValid(){return!!(this.tenant.editionId<=0||this.isUnlimited)||!!this.tenant.subscriptionEndDateUtc&&void 0!==this.tenant.subscriptionEndDateUtc}save(){this.saving=!0,this.setRandomPassword&&(this.tenant.adminPassword=null),0===this.tenant.editionId&&(this.tenant.editionId=null),this.isUnlimited&&(this.tenant.isInTrialPeriod=!1),this.tenant.subscriptionEndDateUtc=this.isUnlimited||this.tenant.editionId<=0?null:this._dateTimeService.toUtcDate(this.tenant.subscriptionEndDateUtc),this.country.value&&(this.tenant.countryId=parseInt(this.country.value)),this._tenantService.createTenant(this.tenant).pipe((0,g.x)(()=>this.saving=!1)).subscribe(()=>{this.notify.info(this.l("SavedSuccessfully")),this.close(),this.modalSave.emit(null)})}close(){this.active=!1,this.tenantAdminPasswordRepeat="",this.modal.hide()}onEditionChange(){this.tenant.isInTrialPeriod=this.tenant.editionId>0&&!this.selectedEditionIsFree(),this.toggleSubscriptionFields()}toggleSubscriptionFields(){this.isSelectedEditionFree=this.selectedEditionIsFree(),this.tenant.editionId<=0||this.isSelectedEditionFree?(this.isSubscriptionFieldsVisible=!1,this.isUnlimited=!!this.isSelectedEditionFree):this.isSubscriptionFieldsVisible=!0}onIsUnlimitedChange(){this.isUnlimited&&(this.tenant.isInTrialPeriod=!1)}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(e.zs3),e.Y36(u.ANv),e.Y36(u.P0Z),e.Y36(u.qAB),e.Y36(x.C),e.Y36(u.Q7h))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["createTenantModal"]],viewQuery:function(i,n){if(1&i&&e.Gf(z,7),2&i){let o;e.iGM(o=e.CRH())&&(n.modal=o.first)}},outputs:{modalSave:"modalSave"},features:[e.qOj],decls:5,vars:4,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","createModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["createModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["role","form","novalidate","","class","form-validation",3,"submit",4,"ngIf"],["role","form","novalidate","",1,"form-validation",3,"submit"],["tenantCreateForm","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"mb-5"],["for","TenancyName",1,"form-label","required"],["id","TenancyName","type","text","name","tenancyName","required","","maxlength","64","pattern","^[a-zA-Z][a-zA-Z0-9_-]{1,}$",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["tenancyNameInput","ngModel","tenancyName","ngModel"],[3,"formCtrl"],["class","form-control-feedback",4,"ngIf"],["for","Name",1,"form-label","required"],["id","Name","type","text","name","Name","required","","maxlength","128",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["nameInput","ngModel"],["class","mb-5",4,"ngIf"],["for","AdminName",1,"form-label","required"],["id","AdminName","type","text","name","AdminName","required","","maxlength","64",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["adminNameInput","ngModel"],["for","AdminSurname",1,"form-label","required"],["id","AdminSurname","type","text","name","AdminSurname","required","","maxlength","64",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["adminSurnameInput","ngModel"],["for","AdminEmailAddress",1,"form-label","required"],["id","AdminEmailAddress","type","email","name","AdminEmailAddress","required","","pattern","^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$","maxlength","256",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["adminEmailAddressInput","ngModel"],["for","form-label",1,"form-label"],[1,"col-lg-12","col-md-12","col-sm-12"],["id","SingleSelectInput","field","name","placeholder","search for a country","name","SingleSelectInput","inputStyleClass","form-control","styleClass","w-100",3,"ngModel","suggestions","minLength","ngModelChange","completeMethod"],[3,"hidden"],["class","help-block text-danger",4,"ngIf"],[1,"form-check","form-check-custom","form-check-solid","py-1",3,"hidden"],["id","CreateTenant_IsUnlimited","type","checkbox","name","IsUnlimited",1,"form-check-input",3,"ngModel","ngModelChange","change"],[1,"form-check-label"],[1,"mb-5",3,"hidden","ngClass"],["for","SubscriptionEndDate"],["id","SubscriptionEndDate","type","text","name","SubscriptionEndDateUtc","bsDatepicker","","datePickerLuxonModifier","","autocomplete","new-password",1,"form-control",3,"date","bsConfig","dateChange"],["SubscriptionEndDateUtc",""],["id","CreateTenant_IsInTrialPeriod","type","checkbox","name","IsInTrialPeriod",1,"form-check-input",3,"ngModel","disabled","ngModelChange"],[1,"form-check","form-check-custom","form-check-solid","py-1"],["id","CreateTenant_IsActive","type","checkbox","name","IsActive",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"buttonBusy","busyText","disabled"],[1,"fa","fa-save"],[1,"form-control-feedback"],["for","DatabaseConnectionString",1,"form-label","required"],["id","DatabaseConnectionString","type","text","name","ConnectionString","required","","maxlength","1024",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["connectionStringInput","ngModel"],["for","AdminPassword",1,"form-label"],["id","AdminPassword","type","password","name","adminPassword","id","adminPassword","validateEqual","adminPasswordRepeat","reverse","true","maxlength","32",1,"form-control",3,"ngModel","ngClass","required","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","ngModelChange"],["adminPassword","ngModel"],[1,"help-block","text-danger"],["for","AdminPasswordRepeat"],["id","AdminPasswordRepeat","type","password","name","adminPasswordRepeat","validateEqual","adminPassword","maxlength","32",1,"form-control",3,"ngModel","ngClass","required","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","ngModelChange"],["adminPasswordRepeat","ngModel"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return n.onShown()}),e.TgZ(2,"div",2)(3,"div",3),e.YNc(4,W,89,91,"form",4),e.qZA()()()),2&i&&(e.Q6J("config",e.VKq(2,$,!n.saving)),e.xp6(4),e.Q6J("ngIf",n.active))},dependencies:[m.mk,m.O5,l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.Q7,l.nD,l.c5,l.On,l.F,T.Np,T.Y5,R.z,Q.J,M.L,S.s,q.s,w.Qc,A.Z,b.F],encapsulation:2})}return a})();const ee=["nameInput"],te=["editModal"],ne=["SubscriptionEndDateUtc"];function ie(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"label",34),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"input",35,36),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw(2);return e.KtG(o.tenant.connectionString=n)}),e.qZA(),e._UZ(6,"validation-messages",15),e.qZA()}if(2&a){const t=e.MAs(5),i=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,3,"DatabaseConnectionString")),e.xp6(2),e.Q6J("ngModel",i.tenant.connectionString),e.xp6(2),e.Q6J("formCtrl",t)}}function oe(a,d){1&a&&(e.TgZ(0,"div")(1,"span",37),e._uU(2),e.ALo(3,"localize"),e.qZA()()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"TenantDatabaseConnectionStringChangeWarningMessage")," "))}const ae=function(a){return{edited:a}},se=function(a){return{"has-error":a}},re=function(){return{adaptivePosition:!0}};function le(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("submit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e.TgZ(2,"div",7)(3,"h5",8)(4,"span"),e._uU(5),e.ALo(6,"localize"),e.qZA()(),e.TgZ(7,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e.qZA()(),e.TgZ(8,"div",10)(9,"div",11)(10,"label",12),e._uU(11),e.ALo(12,"localize"),e.qZA(),e.TgZ(13,"input",13,14),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.name=n)}),e.qZA(),e._UZ(15,"validation-messages",15),e.qZA(),e.YNc(16,ie,7,5,"div",16),e.YNc(17,oe,4,3,"div",17),e.TgZ(18,"div",11)(19,"label",18),e._uU(20," Country"),e.qZA(),e.TgZ(21,"div",19)(22,"p-autoComplete",20),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.country=n)})("completeMethod",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.filterCountries(n))}),e.qZA()()(),e.TgZ(23,"div",21)(24,"label",22),e._uU(25),e.ALo(26,"localize"),e.qZA(),e.TgZ(27,"input",23,24),e.NdJ("dateChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.subscriptionEndDateChange(n))})("dateChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.subscriptionEndDateUtc=n)}),e.qZA()(),e.TgZ(29,"label",25)(30,"input",26),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.isInTrialPeriod=n)}),e.qZA(),e.TgZ(31,"span",27),e._uU(32),e.ALo(33,"localize"),e.qZA()(),e.TgZ(34,"label",28)(35,"input",29),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.tenant.isActive=n)}),e.qZA(),e.TgZ(36,"span",27),e._uU(37),e.ALo(38,"localize"),e.qZA()()(),e.TgZ(39,"div",30)(40,"button",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e._uU(41),e.ALo(42,"localize"),e.qZA(),e.TgZ(43,"button",32),e._UZ(44,"i",33),e.TgZ(45,"span"),e._uU(46),e.ALo(47,"localize"),e.qZA()()()()}if(2&a){const t=e.MAs(1),i=e.MAs(14),n=e.oxw();e.xp6(5),e.AsE("",e.lcZ(6,32,"EditTenant"),": ",n.tenant.tenancyName,""),e.xp6(2),e.Q6J("disabled",n.saving),e.uIk("aria-label",n.l("Close")),e.xp6(4),e.Oqu(e.lcZ(12,34,"TenantName")),e.xp6(2),e.Q6J("ngClass",e.VKq(46,ae,n.tenant.name))("ngModel",n.tenant.name),e.xp6(2),e.Q6J("formCtrl",i),e.xp6(1),e.Q6J("ngIf",n.currentConnectionString),e.xp6(1),e.Q6J("ngIf",n.currentConnectionString),e.xp6(5),e.Q6J("ngModel",n.country)("suggestions",n.filteredCountries)("minLength",1),e.xp6(1),e.Q6J("hidden",n.isUnlimited||!n.isSubscriptionFieldsVisible)("ngClass",e.VKq(48,se,!n.subscriptionEndDateUtcIsValid)),e.xp6(2),e.Oqu(e.lcZ(26,36,"SubscriptionEndDateUtc")),e.xp6(2),e.Q6J("date",n.tenant.subscriptionEndDateUtc)("isUtc",!0)("bsConfig",e.DdM(50,re))("required",!n.isUnlimited),e.xp6(2),e.Q6J("hidden",n.isUnlimited||!n.isSubscriptionFieldsVisible),e.xp6(1),e.Q6J("disabled",n.selectedEditionIsFree())("ngModel",n.tenant.isInTrialPeriod),e.xp6(2),e.hij(" ",e.lcZ(33,38,"IsInTrialPeriod")," "),e.xp6(3),e.Q6J("ngModel",n.tenant.isActive),e.xp6(2),e.hij(" ",e.lcZ(38,40,"Active")," "),e.xp6(3),e.Q6J("disabled",n.saving),e.xp6(1),e.hij(" ",e.lcZ(42,42,"Cancel")," "),e.xp6(2),e.Q6J("buttonBusy",n.saving)("busyText",n.l("SavingWithThreeDot"))("disabled",!t.form.valid||n.saving||!n.subscriptionEndDateUtcIsValid),e.xp6(3),e.Oqu(e.lcZ(47,44,"Save"))}}const de=function(a){return{backdrop:"static",keyboard:a}};let ce=(()=>{class a extends h.c{constructor(t,i,n,o,c){super(t),this._tenantService=i,this._commonLookupService=n,this._countryService=o,this._dateTimeService=c,this.modalSave=new e.vpe,this.active=!1,this.saving=!1,this.isUnlimited=!1,this.subscriptionEndDateUtcIsValid=!1,this.tenant=void 0,this.editions=[],this.isSubscriptionFieldsVisible=!1}filterCountries(t){this._countryService.getCountriesList(t.query).subscribe(i=>{this.filteredCountries=i})}show(t){this.active=!0,this.filterCountries(""),this._commonLookupService.getEditionsForCombobox(!1).subscribe(i=>{this.editions=i.items;let n=new u.EHF;n.displayText=this.l("NotAssigned"),n.value="",this.editions.unshift(n),this._tenantService.getTenantForEdit(t).subscribe(o=>{this.tenant=o,this.country=o.country,this.currentConnectionString=o.connectionString,this.tenant.editionId=this.tenant.editionId||0,this.isUnlimited=!this.tenant.subscriptionEndDateUtc,this.subscriptionEndDateUtcIsValid=this.isUnlimited||void 0!==this.tenant.subscriptionEndDateUtc,this.modal.show(),this.toggleSubscriptionFields()})})}onShown(){document.getElementById("Name").focus()}subscriptionEndDateChange(t){this.subscriptionEndDateUtcIsValid=t&&!1!==t.date||this.isUnlimited}selectedEditionIsFree(){if(!this.tenant.editionId)return!0;let t=(0,f.Z)(this.editions,{value:this.tenant.editionId+""});return 1!==t.length||t[0].isFree}save(){this.saving=!0,0===this.tenant.editionId&&(this.tenant.editionId=null),this.isUnlimited&&(this.tenant.isInTrialPeriod=!1),this.tenant.subscriptionEndDateUtc=this.isUnlimited||!this.tenant.editionId?null:this.tenant.subscriptionEndDateUtc.toLocal(),this.country.value&&(this.tenant.countryId=parseInt(this.country.value)),this._tenantService.updateTenant(this.tenant).pipe((0,g.x)(()=>this.saving=!1)).subscribe(()=>{this.notify.info(this.l("SavedSuccessfully")),this.close(),this.modalSave.emit(null)})}close(){this.active=!1,this.modal.hide()}onEditionChange(){this.selectedEditionIsFree()&&(this.tenant.isInTrialPeriod=!1),this.toggleSubscriptionFields()}onUnlimitedChange(){this.isUnlimited?(this.tenant.subscriptionEndDateUtc=null,this.subscriptionEndDateUtcIsValid=!0,this.tenant.isInTrialPeriod=!1):this.tenant.subscriptionEndDateUtc||(this.subscriptionEndDateUtcIsValid=!1)}toggleSubscriptionFields(){this.isSubscriptionFieldsVisible=this.tenant.editionId>0}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(e.zs3),e.Y36(u.ANv),e.Y36(u.P0Z),e.Y36(u.Q7h),e.Y36(x.C))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["editTenantModal"]],viewQuery:function(i,n){if(1&i&&(e.Gf(ee,7),e.Gf(te,7),e.Gf(ne,5)),2&i){let o;e.iGM(o=e.CRH())&&(n.nameInput=o.first),e.iGM(o=e.CRH())&&(n.modal=o.first),e.iGM(o=e.CRH())&&(n.subscriptionEndDateUtc=o.first)}},outputs:{modalSave:"modalSave"},features:[e.qOj],decls:5,vars:4,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","editModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["editModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["role","form","novalidate","","class","form-validation",3,"submit",4,"ngIf"],["role","form","novalidate","",1,"form-validation",3,"submit"],["tenantEditForm","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"disabled","click"],[1,"modal-body"],[1,"mb-5"],["for","Name",1,"form-label","required"],["id","Name","type","text","name","Name","required","","maxlength","128",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["nameInput","ngModel"],[3,"formCtrl"],["class","mb-5",4,"ngIf"],[4,"ngIf"],["for","form-label",1,"form-label"],[1,"col-lg-12","col-md-12","col-sm-12"],["id","SingleSelectInput","field","name","placeholder","search for a country","name","SingleSelectInput","inputStyleClass","form-control","styleClass","w-100",3,"ngModel","suggestions","minLength","ngModelChange","completeMethod"],[1,"mb-5",3,"hidden","ngClass"],["for","SubscriptionEndDateUtc",1,"form-label"],["id","SubscriptionEndDateUtc","type","datetime","name","SubscriptionEndDateUtc","bsDatepicker","","datePickerLuxonModifier","",1,"form-control",3,"date","isUtc","bsConfig","required","dateChange"],["SubscriptionEndDateUtc",""],[1,"form-check","form-check-custom","form-check-solid","py-1",3,"hidden"],["id","CreateTenant_IsInTrialPeriod","type","checkbox","name","IsInTrialPeriod",1,"form-check-input",3,"disabled","ngModel","ngModelChange"],[1,"form-check-label"],[1,"form-check","form-check-custom","form-check-solid","py-1"],["id","EditTenant_IsActive","type","checkbox","name","IsActive",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"buttonBusy","busyText","disabled"],[1,"fa","fa-save"],["for","DatabaseConnectionString",1,"form-label","required"],["id","DatabaseConnectionString","type","text","name","ConnectionString","required","","maxlength","1024",1,"form-control",3,"ngModel","ngModelChange"],["connectionStringInput","ngModel"],[1,"help-block","text-warning"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return n.onShown()}),e.TgZ(2,"div",2)(3,"div",3),e.YNc(4,le,48,51,"form",4),e.qZA()()()),2&i&&(e.Q6J("config",e.VKq(2,de,!n.saving)),e.xp6(4),e.Q6J("ngIf",n.tenant&&n.active))},dependencies:[m.mk,m.O5,l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.Q7,l.nD,l.On,l.F,T.Np,T.Y5,M.L,S.s,q.s,w.Qc,A.Z,b.F],encapsulation:2})}return a})();var ue=s(39387),pe=s(2268);const me=["tenantFeaturesModal"],ge=["featureTree"];function _e(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("submit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e.TgZ(2,"div",7)(3,"h4",8)(4,"span"),e._uU(5),e.ALo(6,"localize"),e.qZA()(),e.TgZ(7,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e.qZA()(),e.TgZ(8,"div",10),e._UZ(9,"feature-tree",null,11),e.qZA(),e.TgZ(11,"div",12)(12,"button",13),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.resetFeatures())}),e.ALo(13,"localize"),e.TgZ(14,"span"),e._uU(15),e.ALo(16,"localize"),e.qZA()(),e.TgZ(17,"button",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e._uU(18),e.ALo(19,"localize"),e.qZA(),e.TgZ(20,"button",15),e._UZ(21,"i",16),e.TgZ(22,"span"),e._uU(23),e.ALo(24,"localize"),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(5),e.AsE("",e.lcZ(6,13,"Features")," - ",t.tenantName,""),e.xp6(7),e.s9C("tooltip",e.lcZ(13,15,"ResetFeaturesTooltip")),e.Q6J("disabled",t.saving)("buttonBusy",t.resettingFeatures)("busyText",t.l("SavingWithThreeDot")),e.xp6(3),e.Oqu(e.lcZ(16,17,"ResetSpecialFeatures")),e.xp6(2),e.Q6J("disabled",t.saving||t.resettingFeatures),e.xp6(1),e.hij(" ",e.lcZ(19,19,"Cancel")," "),e.xp6(2),e.Q6J("disabled",t.resettingFeatures)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),e.xp6(3),e.Oqu(e.lcZ(24,21,"Save"))}}const he=function(){return{backdrop:"static"}};let fe=(()=>{class a extends h.c{constructor(t,i){super(t),this._tenantService=i,this.active=!1,this.saving=!1,this.resettingFeatures=!1,this.featureEditData=null}show(t,i){this.tenantId=t,this.tenantName=i,this.active=!0,this.loadFeatures(),this.modal.show()}loadFeatures(){const t=this;t._tenantService.getTenantFeaturesForEdit(this.tenantId).subscribe(i=>{t.featureTree.editData=i})}save(){if(!this.featureTree.areAllValuesValid())return void this.message.warn(this.l("InvalidFeaturesWarning"));const t=new u.Qxy;t.id=this.tenantId,t.featureValues=this.featureTree.getGrantedFeatures(),this.saving=!0,this._tenantService.updateTenantFeatures(t).pipe((0,g.x)(()=>this.saving=!1)).subscribe(()=>{this.notify.info(this.l("SavedSuccessfully")),this.close()})}resetFeatures(){const t=new u.KAE;t.id=this.tenantId,this.resettingFeatures=!0,this._tenantService.resetTenantSpecificFeatures(t).pipe((0,g.x)(()=>this.resettingFeatures=!1)).subscribe(()=>{this.notify.info(this.l("ResetSuccessfully")),this.loadFeatures()})}close(){this.active=!1,this.modal.hide()}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(e.zs3),e.Y36(u.ANv))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["tenantFeaturesModal"]],viewQuery:function(i,n){if(1&i&&(e.Gf(me,7),e.Gf(ge,5)),2&i){let o;e.iGM(o=e.CRH())&&(n.modal=o.first),e.iGM(o=e.CRH())&&(n.featureTree=o.first)}},features:[e.qOj],decls:5,vars:3,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","tenantFeaturesModal","aria-hidden","true",1,"modal","fade",3,"config"],["tenantFeaturesModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["name","editTenantFeaturesForm","role","form","novalidate","","class","form-validation",3,"submit",4,"ngIf"],["name","editTenantFeaturesForm","role","form","novalidate","",1,"form-validation",3,"submit"],["editTenantFeaturesForm","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-hidden","true",1,"btn-close",3,"click"],[1,"modal-body"],["featureTree",""],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold","pull-left",3,"disabled","buttonBusy","busyText","tooltip","click"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-save"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3),e.YNc(4,_e,25,23,"form",4),e.qZA()()()),2&i&&(e.Q6J("config",e.DdM(2,he)),e.xp6(4),e.Q6J("ngIf",n.active))},dependencies:[m.O5,l._Y,l.JL,l.F,M.L,A.Z,ue.y,pe.i9,b.F],encapsulation:2})}return a})();var Te=s(88922),be=s(83410);const Ce=["impersonateUserLookupModal"],xe=["createTenantModal"],Ze=["editTenantModal"],ve=["tenantFeaturesModal"],Me=["dataTable"],Ae=["paginator"],ye=["entityTypeHistoryModal"];function Se(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.createTenant())}),e._UZ(1,"i",37),e.TgZ(2,"span",18),e._uU(3),e.ALo(4,"localize"),e.qZA()()}2&a&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"CreateNewTenant")," "))}function qe(a,d){1&a&&(e.TgZ(0,"tr")(1,"th",38),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"th",39),e._uU(5),e.ALo(6,"localize"),e._UZ(7,"p-sortIcon",40),e.qZA(),e.TgZ(8,"th",41),e._uU(9),e.ALo(10,"localize"),e._UZ(11,"p-sortIcon",42),e.qZA(),e.TgZ(12,"th",43),e._uU(13),e.ALo(14,"localize"),e._UZ(15,"p-sortIcon",44),e.qZA(),e.TgZ(16,"th",45),e._uU(17),e.ALo(18,"localize"),e._UZ(19,"p-sortIcon",46),e.qZA()()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,5,"Actions")),e.xp6(3),e.hij(" ",e.lcZ(6,7,"TenancyCodeName")," "),e.xp6(4),e.hij(" ",e.lcZ(10,9,"TenantName")," "),e.xp6(4),e.hij(" ",e.lcZ(14,11,"Active")," "),e.xp6(4),e.hij(" ",e.lcZ(18,13,"CreationTime")," "))}function we(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"li",58)(1,"a",59),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit;e.oxw();const o=e.MAs(44);return e.KtG(o.show(n.id))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Edit")," "))}function Ue(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"li",58)(1,"a",59),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,o=e.oxw();return e.KtG(o.deleteTenant(n))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"Delete")," "))}function Ie(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"li",58)(1,"a",59),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,o=e.oxw();return e.KtG(o.showHistory(n))}),e._uU(2),e.ALo(3,"localize"),e.qZA()()}2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"History")," "))}function Ee(a,d){if(1&a){const t=e.EpF();e.TgZ(0,"ul",56),e.YNc(1,we,4,3,"li",57),e.ALo(2,"permission"),e.YNc(3,Ue,4,3,"li",57),e.ALo(4,"permission"),e.TgZ(5,"li",58)(6,"a",59),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw();return e.KtG(o.unlockUser(n))}),e._uU(7),e.ALo(8,"localize"),e.qZA()(),e.YNc(9,Ie,4,3,"li",57),e.qZA()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,"Pages.Tenants.Edit")),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,6,"Pages.Tenants.Delete")),e.xp6(4),e.hij(" ",e.lcZ(8,8,"Unlock")," "),e.xp6(2),e.Q6J("ngIf",t.entityHistoryEnabled)}}function Je(a,d){1&a&&(e._UZ(0,"i",60),e.ALo(1,"localize")),2&a&&e.s9C("title",e.lcZ(1,1,"HasOwnDatabase"))}function Ne(a,d){1&a&&(e.TgZ(0,"span",61),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Yes")," "))}function Le(a,d){1&a&&(e.TgZ(0,"span",62),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"No")," "))}function De(a,d){if(1&a&&(e.TgZ(0,"tr")(1,"td",38)(2,"div",47)(3,"button",48),e._UZ(4,"i",49)(5,"span",50),e._uU(6),e.ALo(7,"localize"),e.qZA(),e.YNc(8,Ee,10,10,"ul",51),e.qZA()(),e.TgZ(9,"td")(10,"span",52),e._uU(11),e.ALo(12,"localize"),e.qZA(),e.YNc(13,Je,2,3,"i",53),e._uU(14),e.qZA(),e.TgZ(15,"td")(16,"span",52),e._uU(17),e.ALo(18,"localize"),e.qZA(),e._uU(19),e.qZA(),e.TgZ(20,"td")(21,"span",52),e._uU(22),e.ALo(23,"localize"),e.qZA(),e.YNc(24,Ne,3,3,"span",54),e.YNc(25,Le,3,3,"span",55),e.qZA(),e.TgZ(26,"td")(27,"span",52),e._uU(28),e.ALo(29,"localize"),e.qZA(),e._uU(30),e.ALo(31,"luxonFormat"),e.qZA()()),2&a){const t=d.$implicit;e.xp6(6),e.hij(" ",e.lcZ(7,11,"Actions")," "),e.xp6(5),e.Oqu(e.lcZ(12,13,"TenancyCodeName")),e.xp6(2),e.Q6J("ngIf",t.connectionString),e.xp6(1),e.hij(" ",t.tenancyName," "),e.xp6(3),e.Oqu(e.lcZ(18,15,"Name")),e.xp6(2),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(e.lcZ(23,17,"Active")),e.xp6(2),e.Q6J("ngIf",t.isActive),e.xp6(1),e.Q6J("ngIf",!t.isActive),e.xp6(3),e.Oqu(e.lcZ(29,19,"CreationTime")),e.xp6(2),e.hij(" ",e.xi3(31,21,t.creationTime,"F")," ")}}function Fe(a,d){1&a&&(e.TgZ(0,"div",63),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const Pe=function(){return{"min-width":"50rem"}},He=[{path:"",component:(()=>{class a extends h.c{constructor(t,i,n,o,c,_){super(t),this._tenantService=i,this._activatedRoute=n,this._commonLookupService=o,this._impersonationService=c,this._dateTimeService=_,this.subscriptionDateRange=[this._dateTimeService.getStartOfDay(),this._dateTimeService.getEndOfDayPlusDays(30)],this.creationDateRange=[this._dateTimeService.getStartOfDay(),this._dateTimeService.getEndOfDay()],this._entityTypeFullName="Minimates.MultiTenancy.Tenant",this.entityHistoryEnabled=!1,this.filters={},this.setFiltersFromRoute()}setFiltersFromRoute(){null!=this._activatedRoute.snapshot.queryParams.subscriptionEndDateStart?(this.filters.subscriptionEndDateRangeActive=!0,this.subscriptionDateRange[0]=this._dateTimeService.fromISODateString(this._activatedRoute.snapshot.queryParams.subscriptionEndDateStart)):this.subscriptionDateRange[0]=this._dateTimeService.getStartOfDay(),null!=this._activatedRoute.snapshot.queryParams.subscriptionEndDateEnd?(this.filters.subscriptionEndDateRangeActive=!0,this.subscriptionDateRange[1]=this._dateTimeService.fromISODateString(this._activatedRoute.snapshot.queryParams.subscriptionEndDateEnd)):this.subscriptionDateRange[1]=this._dateTimeService.getEndOfDayPlusDays(30),null!=this._activatedRoute.snapshot.queryParams.creationDateStart?(this.filters.creationDateRangeActive=!0,this.creationDateRange[0]=this._dateTimeService.fromISODateString(this._activatedRoute.snapshot.queryParams.creationDateStart)):this.creationDateRange[0]=this._dateTimeService.getEndOfDayMinusDays(7),null!=this._activatedRoute.snapshot.queryParams.creationDateEnd?(this.filters.creationDateRangeActive=!0,this.creationDateRange[1]=this._dateTimeService.fromISODateString(this._activatedRoute.snapshot.queryParams.creationDateEnd)):this.creationDateRange[1]=this._dateTimeService.getEndOfDay(),null!=this._activatedRoute.snapshot.queryParams.editionId&&(this.filters.selectedEditionId=parseInt(this._activatedRoute.snapshot.queryParams.editionId))}ngOnInit(){this.filters.filterText=this._activatedRoute.snapshot.queryParams.filterText||"",this.setIsEntityHistoryEnabled(),this.impersonateUserLookupModal.configure({title:this.l("SelectAUser"),dataSource:(t,i,n,o)=>{let c=new u.MD_;return c.filter=n,c.maxResultCount=i,c.skipCount=t,c.tenantId=o,this._commonLookupService.findUsers(c)}})}getTenants(t){this.primengTableHelper.shouldResetPaging(t)&&(this.paginator.changePage(0),this.primengTableHelper.records&&this.primengTableHelper.records.length>0)||(this.primengTableHelper.showLoadingIndicator(),this._tenantService.getTenants(this.filters.filterText,this.filters.subscriptionEndDateRangeActive?this.subscriptionDateRange[0]:void 0,this.filters.subscriptionEndDateRangeActive?this.subscriptionDateRange[1].endOf("day"):void 0,this.filters.creationDateRangeActive?this.creationDateRange[0]:void 0,this.filters.creationDateRangeActive?this.creationDateRange[1].endOf("day"):void 0,this.filters.selectedEditionId,void 0!==this.filters.selectedEditionId&&this.filters.selectedEditionId+""!="-1",this.primengTableHelper.getSorting(this.dataTable),this.primengTableHelper.getMaxResultCount(this.paginator,t),this.primengTableHelper.getSkipCount(this.paginator,t)).pipe((0,g.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(i=>{this.primengTableHelper.totalRecordsCount=i.totalCount,this.primengTableHelper.records=i.items,this.primengTableHelper.hideLoadingIndicator()}))}showUserImpersonateLookUpModal(t){abp.multiTenancy.getTenantIdCookie()?this.message.warn(this.l("YouAreNotLoggedInAsAHostUser")).then(()=>{document.location.reload()}):(this.impersonateUserLookupModal.tenantId=t.id,this.impersonateUserLookupModal.show())}unlockUser(t){this._tenantService.unlockTenantAdmin(new u.QJI({id:t.id})).subscribe(()=>{this.notify.success(this.l("UnlockedTenandAdmin",t.name))})}reloadPage(){this.paginator.changePage(this.paginator.getPage())}createTenant(){this.createTenantModal.show()}deleteTenant(t){this.message.confirm(this.l("TenantDeleteWarningMessage",t.tenancyName),this.l("AreYouSure"),i=>{i&&this._tenantService.deleteTenant(t.id).subscribe(()=>{this.reloadPage(),this.notify.success(this.l("SuccessfullyDeleted"))})})}showHistory(t){this.entityTypeHistoryModal.show({entityId:t.id.toString(),entityTypeFullName:this._entityTypeFullName,entityTypeDescription:t.tenancyName})}impersonateUser(t){this._impersonationService.impersonateTenant(t.id,this.impersonateUserLookupModal.tenantId)}setIsEntityHistoryEnabled(){let t=abp.custom;this.entityHistoryEnabled=t.EntityHistory&&t.EntityHistory.isEnabled&&1===(0,f.Z)(t.EntityHistory.enabledEntities,i=>i===this._entityTypeFullName).length}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(e.zs3),e.Y36(u.ANv),e.Y36(C.gz),e.Y36(u.P0Z),e.Y36(J.h),e.Y36(x.C))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&(e.Gf(Ce,7),e.Gf(xe,7),e.Gf(Ze,7),e.Gf(ve,7),e.Gf(Me,7),e.Gf(Ae,7),e.Gf(ye,7)),2&i){let o;e.iGM(o=e.CRH())&&(n.impersonateUserLookupModal=o.first),e.iGM(o=e.CRH())&&(n.createTenantModal=o.first),e.iGM(o=e.CRH())&&(n.editTenantModal=o.first),e.iGM(o=e.CRH())&&(n.tenantFeaturesModal=o.first),e.iGM(o=e.CRH())&&(n.dataTable=o.first),e.iGM(o=e.CRH())&&(n.paginator=o.first),e.iGM(o=e.CRH())&&(n.entityTypeHistoryModal=o.first)}},features:[e.qOj],decls:51,vars:39,consts:[[3,"title","description"],["role","actions"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"card","card-custom","gutter-b"],[1,"card-body"],[1,"form"],["autocomplete","new-password",3,"submit"],[1,"form-body"],[1,"row","mb-4"],[1,"col-xl-6"],["for","TenantNameOrTenancyCode",1,"form-label"],[1,"input-group"],["id","TenantNameOrTenancyCode","name","filterText","type","text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],["type","submit",1,"btn","btn-primary"],[1,"flaticon-search-1"],[1,"col-xl-12","text-end"],["name","RefreshButton",1,"btn","btn-primary"],[1,"fa","fa-sync","btn-md-icon"],[1,"d-none","d-md-inline-block"],[1,"row","align-items-center"],[1,"col","primeng-datatable-container",3,"busyIf"],["sortMode","multiple",3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[3,"modalSave"],["createTenantModal",""],["editTenantModal",""],["tenantFeaturesModal",""],[3,"itemSelected"],["impersonateUserLookupModal",""],["entityTypeHistoryModal",""],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus","btn-md-icon"],[2,"width","130px"],["pSortableColumn","tenancyName"],["field","tenancyName"],["pSortableColumn","name"],["field","name"],["pSortableColumn","isActive"],["field","isActive"],["pSortableColumn","creationTime"],["field","creationTime"],["dropdown","","placement","bottom left","container","body",1,"btn-group"],["id","dropdownButton","type","button","dropdownToggle","","aria-controls","dropdownMenu",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"fa","fa-cog"],[1,"caret"],["id","dropdownMenu","class","dropdown-menu","role","menu","aria-labelledby","dropdownButton",4,"dropdownMenu"],[1,"p-column-title"],["class","fa fa-database",3,"title",4,"ngIf"],["class","badge badge-success badge-inline",4,"ngIf"],["class","badge badge-dark badge-inline",4,"ngIf"],["id","dropdownMenu","role","menu","aria-labelledby","dropdownButton",1,"dropdown-menu"],["role","menuitem",4,"ngIf"],["role","menuitem"],["href","javascript:;",1,"dropdown-item",3,"click"],[1,"fa","fa-database",3,"title"],[1,"badge","badge-success","badge-inline"],[1,"badge","badge-dark","badge-inline"],[1,"primeng-no-data"]],template:function(i,n){1&i&&(e.TgZ(0,"div")(1,"sub-header",0),e.ALo(2,"localize"),e.ALo(3,"localize"),e.TgZ(4,"div",1),e.YNc(5,Se,5,3,"button",2),e.ALo(6,"permission"),e.qZA()(),e.TgZ(7,"div")(8,"div",3)(9,"div",4)(10,"div",5)(11,"form",6),e.NdJ("submit",function(){return n.getTenants()}),e.TgZ(12,"div",7)(13,"div",8)(14,"div",9)(15,"label",10),e._uU(16),e.ALo(17,"localize"),e.qZA(),e.TgZ(18,"div",11)(19,"input",12),e.NdJ("ngModelChange",function(c){return n.filters.filterText=c}),e.ALo(20,"localize"),e.qZA(),e.TgZ(21,"button",13),e._UZ(22,"i",14),e.qZA()()()(),e.TgZ(23,"div",8)(24,"div",15)(25,"button",16),e._UZ(26,"i",17),e.TgZ(27,"span",18),e._uU(28),e.ALo(29,"localize"),e.qZA()()()()()()(),e.TgZ(30,"div",19)(31,"div",20)(32,"p-table",21,22),e.NdJ("onLazyLoad",function(c){return n.getTenants(c)}),e.YNc(34,qe,20,15,"ng-template",23),e.YNc(35,De,32,24,"ng-template",24),e.qZA(),e.YNc(36,Fe,3,3,"div",25),e.TgZ(37,"div",26)(38,"p-paginator",27,28),e.NdJ("onPageChange",function(c){return n.getTenants(c)}),e.ALo(40,"localize"),e.qZA()()()()()()(),e.TgZ(41,"createTenantModal",29,30),e.NdJ("modalSave",function(){return n.getTenants()}),e.qZA(),e.TgZ(43,"editTenantModal",29,31),e.NdJ("modalSave",function(){return n.getTenants()}),e.qZA(),e._UZ(45,"tenantFeaturesModal",null,32),e.TgZ(47,"commonLookupModal",33,34),e.NdJ("itemSelected",function(c){return n.impersonateUser(c)}),e.qZA(),e._UZ(49,"entityTypeHistoryModal",null,35),e.qZA()),2&i&&(e.Q6J("@routerTransition",void 0),e.xp6(1),e.Q6J("title",e.lcZ(2,23,"Tenants"))("description",e.lcZ(3,25,"TenantsHeaderInfo")),e.xp6(4),e.Q6J("ngIf",e.lcZ(6,27,"Pages.Tenants.Create")),e.xp6(2),e.Tol(n.containerClass),e.xp6(9),e.hij(" ",e.lcZ(17,29,"TenantNameOrTenancyCode")," "),e.xp6(3),e.s9C("placeholder",e.lcZ(20,31,"SearchWithThreeDot")),e.Q6J("ngModel",n.filters.filterText),e.xp6(3),e.uIk("aria-label",n.l("Search")),e.xp6(6),e.hij(" ",e.lcZ(29,33,"Refresh")," "),e.xp6(3),e.Q6J("busyIf",n.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",n.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",n.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(38,Pe)),e.xp6(4),e.Q6J("ngIf",0==n.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",n.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",n.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",n.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(40,35,"TotalRecordsCount",n.primengTableHelper.totalRecordsCount)))},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F,Z.Hz,Z.Mq,Z.TO,N.s,L.A,D.U,v.iA,F.jx,v.lQ,v.fz,P.D,H.$,X,ce,fe,Te.n,b.F,be.a],encapsulation:2,data:{animation:[(0,E.MH)()]}})}return a})(),pathMatch:"full"}];let Re=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[C.Bz.forChild(He),C.Bz]})}return a})(),Qe=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[I.o,U.g,Re]})}return a})()}}]);