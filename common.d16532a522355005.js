"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[68592],{78812:(D,E,s)=>{s.d(E,{Y:()=>g});var e=s(99468);let g=(()=>{class u{constructor(){}isEditionFree(_){return!(_.dailyPrice||_.weeklyPrice||_.monthlyPrice||_.annualPrice)}static#e=this.\u0275fac=function(d){return new(d||u)};static#t=this.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},77213:(D,E,s)=>{s.r(E),s.d(E,{DynamicEntityPropertyValueModule:()=>v});var e=s(71902),g=s(92337),u=s(70916),m=s(40457),_=s(99468);const d=[{path:"",component:m.J,pathMatch:"full"}];let a=(()=>{class h{static#e=this.\u0275fac=function(T){return new(T||h)};static#t=this.\u0275mod=_.oAB({type:h});static#n=this.\u0275inj=_.cJS({imports:[u.Bz.forChild(d),u.Bz]})}return h})(),v=(()=>{class h{static#e=this.\u0275fac=function(T){return new(T||h)};static#t=this.\u0275mod=_.oAB({type:h});static#n=this.\u0275inj=_.cJS({imports:[g.o,e.g,a]})}return h})()},40457:(D,E,s)=>{s.d(E,{J:()=>p});var e=s(99468),g=s(41840),u=s(44328),m=s(49556),_=s(63686),d=s(96814),a=s(94901),v=s(68027),h=s(85219),c=s(3291),f=s(83410);function T(r,n){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"localize"),e.qZA(),e.TgZ(7,"th",7),e._uU(8),e.ALo(9,"localize"),e.qZA()()),2&r&&(e.xp6(2),e.Oqu(e.lcZ(3,3,"PropertyName")),e.xp6(3),e.Oqu(e.lcZ(6,5,"Values")),e.xp6(3),e.Oqu(e.lcZ(9,7,"Actions")))}function M(r,n){1&r&&e.GkF(0)}function y(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.deleteAllValuesOfDynamicEntityPropertyId(o))}),e._uU(1),e.ALo(2,"localize"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Delete")," "))}function C(r,n){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.YNc(4,M,1,0,"ng-container",8),e.qZA(),e.TgZ(5,"td"),e.YNc(6,y,3,3,"button",9),e.ALo(7,"permission"),e.qZA()()),2&r){const t=n.$implicit;e.xp6(2),e.hij(" ",t.data.propertyName," "),e.xp6(2),e.Q6J("ngComponentOutlet",t.definition.component)("ngComponentOutletInjector",t.injector),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,4,"Pages.Administration.DynamicEntityPropertyValue.Delete"))}}function P(r,n){1&r&&(e.TgZ(0,"div",11),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}function x(r,n){if(1&r&&(e.TgZ(0,"div",1)(1,"p-table",2,3),e.YNc(3,T,10,9,"ng-template",4),e.YNc(4,C,8,6,"ng-template",5),e.qZA(),e.YNc(5,P,3,3,"div",6),e.qZA()),2&r){const t=e.oxw();e.Q6J("busyIf",t.primengTableHelper.isLoading),e.xp6(1),e.Q6J("value",t.items)("paginator",!1),e.xp6(4),e.Q6J("ngIf",0==t.items.length)}}class A{constructor(n,t){this.data=n,this.definition=t}}let p=(()=>{class r extends g.c{constructor(t,i,o){super(t),this._injector=t,this._dynamicEntityPropertyValueService=i,this._inputTypeConfigurationService=o,this.onSaveDone=new e.vpe,this.initialized=!1}ngOnInit(){this.initialize()}initialize(){this.initialized=!1,this._dynamicEntityPropertyValueService.getAllDynamicEntityPropertyValues(this.entityFullName,this.entityId).subscribe(t=>{t.items&&(this.items=t.items.map(i=>{let o=this._inputTypeConfigurationService.getByInputType(i.inputType),l=new A(i,o),N=e.zs3.create({providers:[{provide:m.cT,useValue:i.selectedValues},{provide:m.TH,useValue:i.allValuesInputTypeHas},{provide:m.Ql,useValue:O=>{l.componentInstance=O}}],parent:this._injector});return l.injector=N,l})),this.initialized=!0,this.hideMainSpinner()},t=>{this.hideMainSpinner()})}deleteAllValuesOfDynamicEntityPropertyId(t){this.message.confirm(this.l("DeleteDynamicEntityPropertyValueMessage",t.data.propertyName),this.l("AreYouSure"),i=>{i&&this._dynamicEntityPropertyValueService.cleanValues(new u.RM({dynamicEntityPropertyId:t.data.dynamicEntityPropertyId,entityId:this.entityId})).subscribe(()=>{abp.notify.success(this.l("SuccessfullyDeleted")),this.initialize()})})}saveAll(){if(!this.items||0===this.items.length)return;let t=[];for(let i=0;i<this.items.length;i++){const o=this.items[i];t.push(new u.COX({dynamicEntityPropertyId:o.data.dynamicEntityPropertyId,entityId:this.entityId,values:o.componentInstance.getSelectedValues()}))}this._dynamicEntityPropertyValueService.insertOrUpdateAllValues(new u.O3u({items:t})).subscribe(()=>{abp.notify.success(this.l("SavedSuccessfully")),this.initialize(),this.hideMainSpinner(),this.onSaveDone&&this.onSaveDone.emit()},i=>{this.hideMainSpinner()})}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(e.zs3),e.Y36(u.mQH),e.Y36(_.R))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["dynamic-entity-property-value-manager"]],inputs:{entityFullName:"entityFullName",entityId:"entityId"},outputs:{onSaveDone:"onSaveDone"},features:[e.qOj],decls:1,vars:1,consts:[["class","col primeng-datatable-container",3,"busyIf",4,"ngIf"],[1,"col","primeng-datatable-container",3,"busyIf"],[3,"value","paginator"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[2,"width","100px"],[4,"ngComponentOutlet","ngComponentOutletInjector"],["class","btn btn-danger bt-sm",3,"click",4,"ngIf"],[1,"btn","btn-danger","bt-sm",3,"click"],[1,"primeng-no-data"]],template:function(i,o){1&i&&e.YNc(0,x,6,4,"div",0),2&i&&e.Q6J("ngIf",o.initialized)},dependencies:[d.$G,d.O5,a.U,v.iA,h.jx,c.F,f.a],encapsulation:2})}return r})()},39387:(D,E,s)=>{s.d(E,{y:()=>A});var e=s(41840),g=s(44328),u=s(75857),m=s(66232),_=s(78853),d=s(43136),a=s(99468),v=s(78164),h=s(98833),c=s(96814),f=s(56223),T=s(85219),M=s(91396);function y(p,r){if(1&p){const n=a.EpF();a.TgZ(0,"input",5),a.NdJ("ngModelChange",function(i){a.CHM(n);const o=a.oxw().$implicit;return a.KtG(o.value=i)})("change",function(){a.CHM(n);const i=a.oxw().$implicit,o=a.oxw();return a.KtG(o.onInputChange(i))}),a.qZA()}if(2&p){const n=a.oxw().$implicit;a.s9C("type","NUMERIC"===n.data.inputType.validator.name?"number":"text"),a.Q6J("ngModel",n.value),a.uIk("name",n.data.name)}}function C(p,r){if(1&p&&(a.TgZ(0,"option",8),a._uU(1),a.qZA()),2&p){const n=r.$implicit;a.Q6J("value",n.value),a.xp6(1),a.hij(" ",n.displayText," ")}}function P(p,r){if(1&p){const n=a.EpF();a.TgZ(0,"select",6),a.NdJ("ngModelChange",function(i){a.CHM(n);const o=a.oxw().$implicit;return a.KtG(o.value=i)})("change",function(){a.CHM(n);const i=a.oxw().$implicit,o=a.oxw();return a.KtG(o.onDropdownChange(i))}),a.YNc(1,C,2,2,"option",7),a.qZA()}if(2&p){const n=a.oxw().$implicit;a.Q6J("ngModel",n.value),a.xp6(1),a.Q6J("ngForOf",n.data.inputType.itemSource.items)}}function x(p,r){if(1&p&&(a.TgZ(0,"span",2),a._uU(1),a.qZA(),a.YNc(2,y,1,3,"input",3),a.YNc(3,P,2,2,"select",4)),2&p){const n=r.$implicit;a.xp6(1),a.Oqu(n.label),a.xp6(1),a.Q6J("ngIf","SINGLE_LINE_STRING"===n.data.inputType.name),a.xp6(1),a.Q6J("ngIf","COMBOBOX"===n.data.inputType.name)}}let A=(()=>{class p extends e.c{constructor(n,t,i){super(i),this._arrayToTreeConverterService=n,this._treeDataHelperService=t,this.selectedFeatures=[]}set editData(n){this._editData=n,this.setTreeData(n.features),this.setSelectedNodes(n)}setTreeData(n){this.treeData=this._arrayToTreeConverterService.createTree(n,"parentName","name",null,"children",[{target:"label",source:"displayName"},{target:"expandedIcon",value:"fa fa-folder-open text-warning"},{target:"collapsedIcon",value:"fa fa-folder text-warning"},{target:"expanded",value:!0},{target:"selectable",targetFunction:t=>"CHECKBOX"===t.inputType.name}])}setSelectedNodes(n){this.selectedFeatures=[],(0,u.Z)(n.features,t=>{let i=(0,m.Z)(n.featureValues,{name:t.name});if(i&&1===i.length){let o=i[0];this.setSelectedNode(o.name,o.value)}else this.setSelectedNode(t.name,t.defaultValue)})}setSelectedNode(n,t){let i;"true"===t?(i=this._treeDataHelperService.findNode(this.treeData,{data:{name:n}}),this.selectedFeatures.push(i)):t&&"false"!==t&&(i=this._treeDataHelperService.findNode(this.treeData,{data:{name:n}}),i.value=t,this.selectedFeatures.push(i))}getGrantedFeatures(){if(!this._editData.features)return[];let n=[];for(let t=0;t<this._editData.features.length;t++){let i=new g.O46;i.name=this._editData.features[t].name,i.value=this.getFeatureValueByName(i.name),n.push(i)}return n}onDropdownChange(n){n.value&&(n.selected=!0)}onInputChange(n){n.value&&(n.selected=!0)}findFeatureByName(n){const i=(0,_.Z)(this._editData.features,o=>o.name===n);return i||abp.log.warn("Could not find a feature by name: "+n),i}findFeatureValueByName(n){const i=this.findFeatureByName(n);if(!i)return"";const o=(0,_.Z)(this._editData.featureValues,l=>l.name===n);return o?o.value:i.defaultValue}isFeatureValueValid(n,t){const o=this.findFeatureByName(n);if(!o||!o.inputType||!o.inputType.validator)return!0;const l=o.inputType.validator;if("STRING"===l.name){if(null==t)return l.attributes.AllowNull;if("string"!=typeof t||l.attributes.MinLength>0&&t.length<l.attributes.MinLength||l.attributes.MaxLength>0&&t.length>l.attributes.MaxLength)return!1;if(l.attributes.RegularExpression)return new RegExp(l.attributes.RegularExpression).test(t)}else if("NUMERIC"===l.name){const I=parseInt(t);if(isNaN(I)||l.attributes.MinValue>I)return!1;const O=l.attributes.MaxValue;if(O>0&&I>O)return!1}return!0}areAllValuesValid(){let n=!0;return(0,u.Z)(this._editData.features,t=>{let i=this.getFeatureValueByName(t.name);this.isFeatureValueValid(t.name,i)||(n=!1)}),n}setFeatureValueByName(n,t){const i=(0,_.Z)(this._editData.featureValues,o=>o.name===n);i&&(i.value=t)}isFeatureSelected(n){let t=(0,m.Z)(this.selectedFeatures,{data:{name:n}});return t&&1===t.length}getFeatureValueByName(n){let t=this._treeDataHelperService.findNode(this.treeData,{data:{name:n}});return t?t.value?t.value:this.isFeatureSelected(n)?"true":"false":null}isFeatureEnabled(n){return"true"===this.findFeatureValueByName(n).toLowerCase()}nodeSelect(n){let t=this._treeDataHelperService.findParent(this.treeData,{data:{name:n.node.data.name}});for(;null!=t;)(0,_.Z)(this.selectedFeatures,o=>o.data.name===t.data.name)||this.selectedFeatures.push(t),t=this._treeDataHelperService.findParent(this.treeData,{data:{name:t.data.name}})}onNodeUnselect(n){let t=this._treeDataHelperService.findChildren(this.treeData,{data:{name:n.node.data.name}});t.push(n.node.data.name),(0,d.Z)(this.selectedFeatures,i=>-1!==t.indexOf(i.data.name))}static#e=this.\u0275fac=function(t){return new(t||p)(a.Y36(v.V),a.Y36(h.j),a.Y36(a.zs3))};static#t=this.\u0275cmp=a.Xpm({type:p,selectors:[["feature-tree"]],features:[a.qOj],decls:2,vars:3,consts:[["selectionMode","checkbox",3,"value","selection","propagateSelectionUp","selectionChange","onNodeSelect","onNodeUnselect"],["pTemplate","default"],[2,"margin-right","5px"],[3,"type","ngModel","ngModelChange","change",4,"ngIf"],[3,"ngModel","ngModelChange","change",4,"ngIf"],[3,"type","ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){1&t&&(a.TgZ(0,"p-tree",0),a.NdJ("selectionChange",function(l){return i.selectedFeatures=l})("onNodeSelect",function(l){return i.nodeSelect(l)})("onNodeUnselect",function(l){return i.onNodeUnselect(l)}),a.YNc(1,x,4,3,"ng-template",1),a.qZA()),2&t&&a.Q6J("value",i.treeData)("selection",i.selectedFeatures)("propagateSelectionUp",!1)},dependencies:[c.sg,c.O5,f.YN,f.Kr,f.Fj,f.EJ,f.JJ,f.On,T.jx,M.mp],styles:[".feature-tree-textbox[_ngcontent-%COMP%]{max-width:100px;margin:1px 1px 1px 5px}.feature-tree-textbox.feature-tree-textbox-invalid[_ngcontent-%COMP%]{background:#f00;color:#fff}"]})}return p})()},91344:(D,E,s)=>{s.d(E,{P:()=>h});var e=s(99468),g=s(96814),u=s(56223),m=s(3291);function _(c,f){1&c&&e._UZ(0,"i",7)}function d(c,f){1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&c&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Show")))}function a(c,f){1&c&&e._UZ(0,"i",8)}function v(c,f){1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&c&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Hide")))}let h=(()=>{class c{constructor(){this.dataChange=new e.vpe,this.isVisible=!1}toggleVisibility(){this.isVisible=!this.isVisible}onChange(){this.dataChange.emit(this.data)}static#e=this.\u0275fac=function(M){return new(M||c)};static#t=this.\u0275cmp=e.Xpm({type:c,selectors:[["password-input-with-show-button"]],inputs:{data:"data"},outputs:{dataChange:"dataChange"},decls:8,vars:6,consts:[[1,"input-group"],[1,"form-control",3,"ngModel","type","ngModelChange","change"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],["class","far fa-eye text-white",4,"ngIf"],[4,"ngIf"],["class","far fa-eye-slash text-white",4,"ngIf"],[1,"far","fa-eye","text-white"],[1,"far","fa-eye-slash","text-white"]],template:function(M,y){1&M&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("ngModelChange",function(P){return y.data=P})("change",function(){return y.onChange()}),e.qZA(),e.TgZ(2,"div",2)(3,"button",3),e.NdJ("click",function(){return y.toggleVisibility()}),e.YNc(4,_,1,0,"i",4),e.YNc(5,d,3,3,"span",5),e.YNc(6,a,1,0,"i",6),e.YNc(7,v,3,3,"span",5),e.qZA()()()),2&M&&(e.xp6(1),e.Q6J("ngModel",y.data)("type",y.isVisible?"text":"password"),e.xp6(3),e.Q6J("ngIf",!y.isVisible),e.xp6(1),e.Q6J("ngIf",!y.isVisible),e.xp6(1),e.Q6J("ngIf",y.isVisible),e.xp6(1),e.Q6J("ngIf",y.isVisible))},dependencies:[g.O5,u.Fj,u.JJ,u.On,m.F],encapsulation:2})}return c})()},98155:(D,E,s)=>{s.d(E,{G:()=>u});var e=s(50387),g=s(99468);let u=(()=>{class m{constructor(d){this.permission=d.get(e.qT)}transform(d){if(!d)return!1;for(const a of d)if(this.permission.isGranted(a))return!0;return!1}static#e=this.\u0275fac=function(a){return new(a||m)(g.Y36(g.zs3,16))};static#t=this.\u0275pipe=g.Yjl({name:"permissionAny",type:m,pure:!0})}return m})()}}]);