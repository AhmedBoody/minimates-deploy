"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[68592],{78812:(O,M,s)=>{s.d(M,{Y:()=>C});var e=s(99468);let C=(()=>{class m{constructor(){}isEditionFree(T){return!(T.dailyPrice||T.weeklyPrice||T.monthlyPrice||T.annualPrice)}static#e=this.\u0275fac=function(P){return new(P||m)};static#t=this.\u0275prov=e.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()},39387:(O,M,s)=>{s.d(M,{y:()=>E});var e=s(41840),C=s(44328),m=s(75857),_=s(66232),T=s(78853),P=s(43136),t=s(99468),D=s(78164),v=s(98833),p=s(96814),g=s(56223),N=s(85219),o=s(91396);function l(f,y){if(1&f){const n=t.EpF();t.TgZ(0,"input",5),t.NdJ("ngModelChange",function(i){t.CHM(n);const c=t.oxw().$implicit;return t.KtG(c.value=i)})("change",function(){t.CHM(n);const i=t.oxw().$implicit,c=t.oxw();return t.KtG(c.onInputChange(i))}),t.qZA()}if(2&f){const n=t.oxw().$implicit;t.s9C("type","NUMERIC"===n.data.inputType.validator.name?"number":"text"),t.Q6J("ngModel",n.value),t.uIk("name",n.data.name)}}function r(f,y){if(1&f&&(t.TgZ(0,"option",8),t._uU(1),t.qZA()),2&f){const n=y.$implicit;t.Q6J("value",n.value),t.xp6(1),t.hij(" ",n.displayText," ")}}function u(f,y){if(1&f){const n=t.EpF();t.TgZ(0,"select",6),t.NdJ("ngModelChange",function(i){t.CHM(n);const c=t.oxw().$implicit;return t.KtG(c.value=i)})("change",function(){t.CHM(n);const i=t.oxw().$implicit,c=t.oxw();return t.KtG(c.onDropdownChange(i))}),t.YNc(1,r,2,2,"option",7),t.qZA()}if(2&f){const n=t.oxw().$implicit;t.Q6J("ngModel",n.value),t.xp6(1),t.Q6J("ngForOf",n.data.inputType.itemSource.items)}}function d(f,y){if(1&f&&(t.TgZ(0,"span",2),t._uU(1),t.qZA(),t.YNc(2,l,1,3,"input",3),t.YNc(3,u,2,2,"select",4)),2&f){const n=y.$implicit;t.xp6(1),t.Oqu(n.label),t.xp6(1),t.Q6J("ngIf","SINGLE_LINE_STRING"===n.data.inputType.name),t.xp6(1),t.Q6J("ngIf","COMBOBOX"===n.data.inputType.name)}}let E=(()=>{class f extends e.c{constructor(n,a,i){super(i),this._arrayToTreeConverterService=n,this._treeDataHelperService=a,this.selectedFeatures=[]}set editData(n){this._editData=n,this.setTreeData(n.features),this.setSelectedNodes(n)}setTreeData(n){this.treeData=this._arrayToTreeConverterService.createTree(n,"parentName","name",null,"children",[{target:"label",source:"displayName"},{target:"expandedIcon",value:"fa fa-folder-open text-warning"},{target:"collapsedIcon",value:"fa fa-folder text-warning"},{target:"expanded",value:!0},{target:"selectable",targetFunction:a=>"CHECKBOX"===a.inputType.name}])}setSelectedNodes(n){this.selectedFeatures=[],(0,m.Z)(n.features,a=>{let i=(0,_.Z)(n.featureValues,{name:a.name});if(i&&1===i.length){let c=i[0];this.setSelectedNode(c.name,c.value)}else this.setSelectedNode(a.name,a.defaultValue)})}setSelectedNode(n,a){let i;"true"===a?(i=this._treeDataHelperService.findNode(this.treeData,{data:{name:n}}),this.selectedFeatures.push(i)):a&&"false"!==a&&(i=this._treeDataHelperService.findNode(this.treeData,{data:{name:n}}),i.value=a,this.selectedFeatures.push(i))}getGrantedFeatures(){if(!this._editData.features)return[];let n=[];for(let a=0;a<this._editData.features.length;a++){let i=new C.O46;i.name=this._editData.features[a].name,i.value=this.getFeatureValueByName(i.name),n.push(i)}return n}onDropdownChange(n){n.value&&(n.selected=!0)}onInputChange(n){n.value&&(n.selected=!0)}findFeatureByName(n){const i=(0,T.Z)(this._editData.features,c=>c.name===n);return i||abp.log.warn("Could not find a feature by name: "+n),i}findFeatureValueByName(n){const i=this.findFeatureByName(n);if(!i)return"";const c=(0,T.Z)(this._editData.featureValues,h=>h.name===n);return c?c.value:i.defaultValue}isFeatureValueValid(n,a){const c=this.findFeatureByName(n);if(!c||!c.inputType||!c.inputType.validator)return!0;const h=c.inputType.validator;if("STRING"===h.name){if(null==a)return h.attributes.AllowNull;if("string"!=typeof a||h.attributes.MinLength>0&&a.length<h.attributes.MinLength||h.attributes.MaxLength>0&&a.length>h.attributes.MaxLength)return!1;if(h.attributes.RegularExpression)return new RegExp(h.attributes.RegularExpression).test(a)}else if("NUMERIC"===h.name){const I=parseInt(a);if(isNaN(I)||h.attributes.MinValue>I)return!1;const A=h.attributes.MaxValue;if(A>0&&I>A)return!1}return!0}areAllValuesValid(){let n=!0;return(0,m.Z)(this._editData.features,a=>{let i=this.getFeatureValueByName(a.name);this.isFeatureValueValid(a.name,i)||(n=!1)}),n}setFeatureValueByName(n,a){const i=(0,T.Z)(this._editData.featureValues,c=>c.name===n);i&&(i.value=a)}isFeatureSelected(n){let a=(0,_.Z)(this.selectedFeatures,{data:{name:n}});return a&&1===a.length}getFeatureValueByName(n){let a=this._treeDataHelperService.findNode(this.treeData,{data:{name:n}});return a?a.value?a.value:this.isFeatureSelected(n)?"true":"false":null}isFeatureEnabled(n){return"true"===this.findFeatureValueByName(n).toLowerCase()}nodeSelect(n){let a=this._treeDataHelperService.findParent(this.treeData,{data:{name:n.node.data.name}});for(;null!=a;)(0,T.Z)(this.selectedFeatures,c=>c.data.name===a.data.name)||this.selectedFeatures.push(a),a=this._treeDataHelperService.findParent(this.treeData,{data:{name:a.data.name}})}onNodeUnselect(n){let a=this._treeDataHelperService.findChildren(this.treeData,{data:{name:n.node.data.name}});a.push(n.node.data.name),(0,P.Z)(this.selectedFeatures,i=>-1!==a.indexOf(i.data.name))}static#e=this.\u0275fac=function(a){return new(a||f)(t.Y36(D.V),t.Y36(v.j),t.Y36(t.zs3))};static#t=this.\u0275cmp=t.Xpm({type:f,selectors:[["feature-tree"]],features:[t.qOj],decls:2,vars:3,consts:[["selectionMode","checkbox",3,"value","selection","propagateSelectionUp","selectionChange","onNodeSelect","onNodeUnselect"],["pTemplate","default"],[2,"margin-right","5px"],[3,"type","ngModel","ngModelChange","change",4,"ngIf"],[3,"ngModel","ngModelChange","change",4,"ngIf"],[3,"type","ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(a,i){1&a&&(t.TgZ(0,"p-tree",0),t.NdJ("selectionChange",function(h){return i.selectedFeatures=h})("onNodeSelect",function(h){return i.nodeSelect(h)})("onNodeUnselect",function(h){return i.onNodeUnselect(h)}),t.YNc(1,d,4,3,"ng-template",1),t.qZA()),2&a&&t.Q6J("value",i.treeData)("selection",i.selectedFeatures)("propagateSelectionUp",!1)},dependencies:[p.sg,p.O5,g.YN,g.Kr,g.Fj,g.EJ,g.JJ,g.On,N.jx,o.mp],styles:[".feature-tree-textbox[_ngcontent-%COMP%]{max-width:100px;margin:1px 1px 1px 5px}.feature-tree-textbox.feature-tree-textbox-invalid[_ngcontent-%COMP%]{background:#f00;color:#fff}"]})}return f})()},59170:(O,M,s)=>{s.d(M,{Z:()=>N});var e=s(99468),C=s(41840),m=s(44328),_=s(96814),T=s(24142),P=s(99824),t=s(3291);const D=["permissionTreeModal"],v=["permissionTree"];function p(o,l){if(1&o){const r=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(r);const d=e.oxw();return e.KtG(d.openPermissionTreeModal())}),e._uU(1),e.ALo(2,"localize"),e.qZA()}if(2&o){const r=e.oxw();e.xp6(1),e.AsE(" ",e.lcZ(2,2,"SelectPermissions")," (",r.NumberOfFilteredPermission,")\n")}}const g=function(){return{backdrop:"static"}};let N=(()=>{class o extends C.c{constructor(r,u){super(r),this._permissionService=u,this.onModalclose=new e.vpe,this.selectedPermissions=[],this.NumberOfFilteredPermission=0}ngOnInit(){this.loadAllPermissionsToFilterTree()}openPermissionTreeModal(){this.permissionTreeModal.show()}closePermissionTreeModal(){let r=this.getSelectedPermissions();this.NumberOfFilteredPermission=r.length,this.onModalclose.emit(r),this.permissionTreeModal.hide(),abp.notify.success(this.l("XCountPermissionFiltered",this.NumberOfFilteredPermission))}getSelectedPermissions(){return this.permissionTree?this.permissionTree.getGrantedPermissionNames().filter((u,d,E)=>d===E.findIndex(f=>f===u)):[]}loadAllPermissionsToFilterTree(){let r=[];this._permissionService.getAllPermissions().subscribe(u=>{u.items&&u.items.forEach(d=>{r.push(new m.h$({name:d.name,description:d.description,displayName:d.displayName,isGrantedByDefault:d.isGrantedByDefault,parentName:d.parentName}))}),this.permissionTree.editData={permissions:r,grantedPermissionNames:[]}})}static#e=this.\u0275fac=function(u){return new(u||o)(e.Y36(e.zs3),e.Y36(m.$zk))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["permission-tree-modal"]],viewQuery:function(u,d){if(1&u&&(e.Gf(D,7),e.Gf(v,5)),2&u){let E;e.iGM(E=e.CRH())&&(d.permissionTreeModal=E.first),e.iGM(E=e.CRH())&&(d.permissionTree=E.first)}},inputs:{dontAddOpenerButton:"dontAddOpenerButton",singleSelect:"singleSelect",disableCascade:"disableCascade"},outputs:{onModalclose:"onModalclose"},features:[e.qOj],decls:17,vars:12,consts:[["class","btn btn-secondary w-100",3,"click",4,"ngIf"],["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","permissionTreeModal","aria-hidden","true",1,"modal","fade",3,"config"],["permissionTreeModal","bs-modal"],[1,"modal-dialog","modal-lg","permissionFilterTreeModal"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"singleSelect","disableCascade"],["permissionTree",""],[1,"modal-footer"],["type","button",1,"btn","btn-primary","fw-bold",3,"click"],[1,"btn","btn-secondary","w-100",3,"click"]],template:function(u,d){1&u&&(e.YNc(0,p,3,4,"button",0),e.TgZ(1,"div",1,2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),e._uU(7),e.ALo(8,"localize"),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(){return d.closePermissionTreeModal()}),e.qZA()(),e.TgZ(10,"div",8),e._UZ(11,"permission-tree",9,10),e.qZA(),e.TgZ(13,"div",11)(14,"button",12),e.NdJ("click",function(){return d.closePermissionTreeModal()}),e._uU(15),e.ALo(16,"localize"),e.qZA()()()()()),2&u&&(e.Q6J("ngIf",!d.dontAddOpenerButton),e.xp6(1),e.Q6J("config",e.DdM(11,g)),e.xp6(6),e.hij(" ",e.lcZ(8,7,"SelectPermissions")," "),e.xp6(2),e.uIk("aria-label",d.l("Close")),e.xp6(2),e.Q6J("singleSelect",d.singleSelect)("disableCascade",d.disableCascade),e.xp6(4),e.hij(" ",e.lcZ(16,9,"Select")," "))},dependencies:[_.O5,T.Z,P.I,t.F],encapsulation:2})}return o})()},99824:(O,M,s)=>{s.d(M,{I:()=>p});var e=s(41840),C=s(75857),m=s(43136),_=s(99468),T=s(78164),P=s(98833),t=s(56223),D=s(91396),v=s(3291);let p=(()=>{class g extends e.c{constructor(o,l,r){super(r),this._arrayToTreeConverterService=o,this._treeDataHelperService=l,this.selectedPermissions=[],this.filter=""}set editData(o){this.setTreeData(o.permissions),this.setSelectedNodes(o.grantedPermissionNames)}setTreeData(o){this.treeData=this._arrayToTreeConverterService.createTree(o,"parentName","name",null,"children",[{target:"label",source:"displayName"},{target:"expandedIcon",value:"fa fa-folder-open text-warning"},{target:"collapsedIcon",value:"fa fa-folder text-warning"},{target:"expanded",value:!0}])}setSelectedNodes(o){this.selectedPermissions=[],(0,C.Z)(o,l=>{let r=this._treeDataHelperService.findNode(this.treeData,{data:{name:l}});r&&this.selectedPermissions.push(r)})}getGrantedPermissionNames(){if(!this.selectedPermissions||!this.selectedPermissions.length)return[];let o=[];for(let l=0;l<this.selectedPermissions.length;l++)o.push(this.selectedPermissions[l].data.name);return o}nodeSelect(o){if(this.singleSelect)return void(this.selectedPermissions=[o.node]);if(this.disableCascade)return;let l=this._treeDataHelperService.findParent(this.treeData,{data:{name:o.node.data.name}});for(;null!=l;)this.selectedPermissions.push(l),l=this._treeDataHelperService.findParent(this.treeData,{data:{name:l.data.name}})}onNodeUnselect(o){if(this.disableCascade)return;let l=this._treeDataHelperService.findChildren(this.treeData,{data:{name:o.node.data.name}});l.push(o.node.data.name),(0,m.Z)(this.selectedPermissions,r=>-1!==l.indexOf(r.data.name))}filterPermissions(o){this.filterPermission(this.treeData,this.filter)}filterPermission(o,l){(0,C.Z)(o,r=>{r.styleClass=r.data.displayName.toLowerCase().indexOf(l.toLowerCase())>=0?this.showParentNodes(r):"hidden-tree-node",r.children&&this.filterPermission(r.children,l)})}showParentNodes(o){o.parent&&(o.parent.styleClass="",this.showParentNodes(o.parent))}static#e=this.\u0275fac=function(l){return new(l||g)(_.Y36(T.V),_.Y36(P.j),_.Y36(_.zs3))};static#t=this.\u0275cmp=_.Xpm({type:g,selectors:[["permission-tree"]],inputs:{singleSelect:"singleSelect",disableCascade:"disableCascade"},features:[_.qOj],decls:4,vars:8,consts:[[1,"my-5"],["type","text",1,"form-control",3,"ngModel","placeholder","input","ngModelChange"],["selectionMode","checkbox",3,"value","selection","propagateSelectionUp","propagateSelectionDown","selectionChange","onNodeSelect","onNodeUnselect"]],template:function(l,r){1&l&&(_.TgZ(0,"div",0)(1,"input",1),_.NdJ("input",function(d){return r.filterPermissions(d)})("ngModelChange",function(d){return r.filter=d}),_.ALo(2,"localize"),_.qZA()(),_.TgZ(3,"p-tree",2),_.NdJ("selectionChange",function(d){return r.selectedPermissions=d})("onNodeSelect",function(d){return r.nodeSelect(d)})("onNodeUnselect",function(d){return r.onNodeUnselect(d)}),_.qZA()),2&l&&(_.xp6(1),_.s9C("placeholder",_.lcZ(2,6,"SearchWithThreeDot")),_.Q6J("ngModel",r.filter),_.xp6(2),_.Q6J("value",r.treeData)("selection",r.selectedPermissions)("propagateSelectionUp",!1)("propagateSelectionDown",!r.disableCascade))},dependencies:[t.Fj,t.JJ,t.On,D.mp,v.F],encapsulation:2})}return g})()},91344:(O,M,s)=>{s.d(M,{P:()=>v});var e=s(99468),C=s(96814),m=s(56223),_=s(3291);function T(p,g){1&p&&e._UZ(0,"i",7)}function P(p,g){1&p&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Show")))}function t(p,g){1&p&&e._UZ(0,"i",8)}function D(p,g){1&p&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Hide")))}let v=(()=>{class p{constructor(){this.dataChange=new e.vpe,this.isVisible=!1}toggleVisibility(){this.isVisible=!this.isVisible}onChange(){this.dataChange.emit(this.data)}static#e=this.\u0275fac=function(o){return new(o||p)};static#t=this.\u0275cmp=e.Xpm({type:p,selectors:[["password-input-with-show-button"]],inputs:{data:"data"},outputs:{dataChange:"dataChange"},decls:8,vars:6,consts:[[1,"input-group"],[1,"form-control",3,"ngModel","type","ngModelChange","change"],[1,"input-group-append"],["type","button",1,"btn","btn-primary",3,"click"],["class","far fa-eye text-white",4,"ngIf"],[4,"ngIf"],["class","far fa-eye-slash text-white",4,"ngIf"],[1,"far","fa-eye","text-white"],[1,"far","fa-eye-slash","text-white"]],template:function(o,l){1&o&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("ngModelChange",function(u){return l.data=u})("change",function(){return l.onChange()}),e.qZA(),e.TgZ(2,"div",2)(3,"button",3),e.NdJ("click",function(){return l.toggleVisibility()}),e.YNc(4,T,1,0,"i",4),e.YNc(5,P,3,3,"span",5),e.YNc(6,t,1,0,"i",6),e.YNc(7,D,3,3,"span",5),e.qZA()()()),2&o&&(e.xp6(1),e.Q6J("ngModel",l.data)("type",l.isVisible?"text":"password"),e.xp6(3),e.Q6J("ngIf",!l.isVisible),e.xp6(1),e.Q6J("ngIf",!l.isVisible),e.xp6(1),e.Q6J("ngIf",l.isVisible),e.xp6(1),e.Q6J("ngIf",l.isVisible))},dependencies:[C.O5,m.Fj,m.JJ,m.On,_.F],encapsulation:2})}return p})()},98155:(O,M,s)=>{s.d(M,{G:()=>m});var e=s(50387),C=s(99468);let m=(()=>{class _{constructor(P){this.permission=P.get(e.qT)}transform(P){if(!P)return!1;for(const t of P)if(this.permission.isGranted(t))return!0;return!1}static#e=this.\u0275fac=function(t){return new(t||_)(C.Y36(C.zs3,16))};static#t=this.\u0275pipe=C.Yjl({name:"permissionAny",type:_,pure:!0})}return _})()}}]);