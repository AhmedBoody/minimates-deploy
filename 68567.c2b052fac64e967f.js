"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[68567,83410],{96655:(A,g,o)=>{o.d(g,{S:()=>Z});var u=o(41840),t=o(99468),e=o(44328),p=o(58399),C=o(96814),m=o(24142),h=o(3291);const M=["entityChangeDetailModal"];function v(d,f){if(1&d){const i=t.EpF();t.TgZ(0,"div",9)(1,"h4",10)(2,"span"),t._uU(3),t.ALo(4,"localize"),t.ALo(5,"localize"),t.qZA(),t._UZ(6,"br")(7,"small",11),t.qZA(),t.TgZ(8,"button",12),t.NdJ("click",function(){t.CHM(i);const c=t.oxw();return t.KtG(c.close())}),t.qZA()()}if(2&d){const i=t.oxw();t.xp6(3),t.AsE("",t.lcZ(4,4,"Detail")," - ",t.lcZ(5,6,i.entityChange.entityTypeFullName),""),t.xp6(4),t.Q6J("innerHTML",i.l("CreatedAtByUser",i.entityChange.changeTime,i.entityChange.userName),t.oJD),t.xp6(1),t.uIk("aria-label",i.l("Close"))}}function D(d,f){if(1&d&&(t.TgZ(0,"div",13)(1,"div",14)(2,"h3",15)(3,"span",16),t._uU(4),t.qZA()()(),t.TgZ(5,"div",17)(6,"div",18)(7,"div",19)(8,"div",20),t._uU(9),t.ALo(10,"localize"),t.qZA(),t.TgZ(11,"div",21),t._uU(12),t.qZA()(),t.TgZ(13,"div",22)(14,"div",20),t._uU(15),t.ALo(16,"localize"),t.qZA(),t.TgZ(17,"div",21),t._uU(18),t.qZA()()()()()),2&d){const i=f.$implicit,a=t.oxw();t.xp6(4),t.Oqu(i.propertyName),t.xp6(5),t.hij(" ",t.lcZ(10,5,"OriginalValue")," "),t.xp6(3),t.hij(" ",a.getPropertyChangeValue(i.originalValue,i.propertyTypeFullName)," "),t.xp6(3),t.Oqu(t.lcZ(16,7,"NewValue")),t.xp6(3),t.hij(" ",a.getPropertyChangeValue(i.newValue,i.propertyTypeFullName)," ")}}const b=function(){return{backdrop:"static"}};let Z=(()=>{class d extends u.c{constructor(i,a,c){super(i),this._auditLogService=a,this._dateTimeService=c,this.active=!1}getPropertyChangeValue(i,a){return i&&(i=i.replace(/^['"]+/g,"").replace(/['"]+$/g,""),this.isDate(i,a)?this._dateTimeService.formatDate(this._dateTimeService.fromISODateString(i),"yyyy-LL-dd HH:mm:ss"):"null"===i?"":i)}isDate(i,a){return a.includes("DateTime")&&!isNaN(Date.parse(i).valueOf())}show(i){const a=this;a.active=!0,a.entityChange=i,this._auditLogService.getEntityPropertyChanges(i.id).subscribe(c=>{a.entityPropertyChanges=c}),a.modal.show()}close(){this.active=!1,this.modal.hide()}static#e=this.\u0275fac=function(a){return new(a||d)(t.Y36(t.zs3),t.Y36(e.xWy),t.Y36(p.C))};static#t=this.\u0275cmp=t.Xpm({type:d,selectors:[["entityChangeDetailModal"]],viewQuery:function(a,c){if(1&a&&t.Gf(M,7),2&a){let y;t.iGM(y=t.CRH())&&(c.modal=y.first)}},features:[t.qOj],decls:11,vars:7,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","entityChangeDetailModal","aria-hidden","true",1,"modal","fade",3,"config"],["entityChangeDetailModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["class","modal-header",4,"ngIf"],[1,"modal-body"],["class","card card-custom gutter-b",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],[1,"modal-header"],[1,"modal-title"],[3,"innerHTML"],["type","button",1,"btn-close",3,"click"],[1,"card","card-custom","gutter-b"],[1,"card-header","py-5"],[1,"card-title"],[1,"card-label"],[1,"card-body","py-0"],[1,"row","m-0"],[1,"col","px-8","py-6","me-8"],[1,"fs-sm","text-muted","fw-bold"],[1,"fw-bolder"],[1,"col","px-8","py-6"]],template:function(a,c){1&a&&(t.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3),t.YNc(4,v,9,8,"div",4),t.TgZ(5,"div",5),t.YNc(6,D,19,9,"div",6),t.qZA(),t.TgZ(7,"div",7)(8,"button",8),t.NdJ("click",function(){return c.close()}),t._uU(9),t.ALo(10,"localize"),t.qZA()()()()()),2&a&&(t.Q6J("config",t.DdM(6,b)),t.xp6(4),t.Q6J("ngIf",c.entityChange),t.xp6(2),t.Q6J("ngForOf",c.entityPropertyChanges),t.xp6(3),t.hij(" ",t.lcZ(10,4,"Close")," "))},dependencies:[C.sg,C.O5,m.Z,h.F],encapsulation:2})}return d})()},76388:(A,g,o)=>{o.d(g,{A:()=>R});var u=o(41840),t=o(64716),e=o(99468),p=o(44328),C=o(96814),m=o(94901),h=o(68027),M=o(85219),v=o(51712),D=o(24142),b=o(96655),Z=o(88922),d=o(3291);const f=["entityChangeDetailModal"],i=["modal"],a=["dataTable"],c=["paginator"];function y(r,E){if(1&r&&(e.TgZ(0,"h4",20),e._uU(1),e.ALo(2,"localize"),e.ALo(3,"localize"),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,"ChangeLogs")+":"+e.lcZ(3,3,n.options.entityTypeFullName)+"("+n.options.entityTypeDescription+")"," ")}}function P(r,E){1&r&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"localize"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"localize"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"localize"),e.qZA()()),2&r&&(e.xp6(2),e.hij(" ",e.lcZ(3,4,"Select")," "),e.xp6(3),e.hij(" ",e.lcZ(6,6,"Action")," "),e.xp6(3),e.hij(" ",e.lcZ(9,8,"UserName")," "),e.xp6(3),e.hij(" ",e.lcZ(12,10,"Time")," "))}function L(r,E){if(1&r){const n=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"button",22),e.NdJ("click",function(){const _=e.CHM(n).$implicit,T=e.oxw();return e.KtG(T.showEntityChangeDetails(_))}),e.ALo(3,"localize"),e._UZ(4,"i",23),e.qZA()(),e.TgZ(5,"td")(6,"span",24),e._uU(7),e.ALo(8,"localize"),e.qZA(),e._uU(9),e.qZA(),e.TgZ(10,"td")(11,"span",24),e._uU(12),e.ALo(13,"localize"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"td")(16,"span",24),e._uU(17),e.ALo(18,"localize"),e.qZA(),e._uU(19),e.ALo(20,"luxonFormat"),e.qZA()()}if(2&r){const n=E.$implicit,s=e.oxw();e.xp6(2),e.s9C("title",e.lcZ(3,8,"Select")),e.xp6(2),e.uIk("aria-label",s.l("Select")),e.xp6(3),e.Oqu(e.lcZ(8,10,"Action")),e.xp6(2),e.hij(" ",n.changeTypeName," "),e.xp6(3),e.Oqu(e.lcZ(13,12,"UserName")),e.xp6(2),e.hij(" ",n.userName," "),e.xp6(3),e.Oqu(e.lcZ(18,14,"Time")),e.xp6(2),e.hij(" ",e.xi3(20,16,n.changeTime,"F")," ")}}function O(r,E){1&r&&(e.TgZ(0,"div",25),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const x=function(){return{backdrop:"static"}},U=function(){return{"min-width":"25rem"}};let R=(()=>{class r extends u.c{constructor(n,s){super(n),this._auditLogService=s,this.isShown=!1,this.isInitialized=!1,this.filterText=""}show(n){this.options=n,this.modal.show()}refreshTable(){this.paginator.changePage(this.paginator.getPage())}close(){this.modal.hide()}shown(){this.isShown=!0,this.getRecordsIfNeeds(null)}getRecordsIfNeeds(n){this.isShown&&(this.getRecords(n),this.isInitialized=!0)}getRecords(n){this.primengTableHelper.showLoadingIndicator(),this._auditLogService.getEntityTypeChanges(this.options.entityTypeFullName,this.options.entityId,this.primengTableHelper.getSorting(this.dataTable),this.primengTableHelper.getMaxResultCount(this.paginator,n),this.primengTableHelper.getSkipCount(this.paginator,n)).pipe((0,t.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(s=>{this.primengTableHelper.totalRecordsCount=s.totalCount,this.primengTableHelper.records=s.items,this.primengTableHelper.hideLoadingIndicator()})}showEntityChangeDetails(n){this.entityChangeDetailModal.show(n)}static#e=this.\u0275fac=function(s){return new(s||r)(e.Y36(e.zs3),e.Y36(p.xWy))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["entityTypeHistoryModal"]],viewQuery:function(s,l){if(1&s&&(e.Gf(f,7),e.Gf(i,7),e.Gf(a,7),e.Gf(c,7)),2&s){let _;e.iGM(_=e.CRH())&&(l.entityChangeDetailModal=_.first),e.iGM(_=e.CRH())&&(l.modal=_.first),e.iGM(_=e.CRH())&&(l.dataTable=_.first),e.iGM(_=e.CRH())&&(l.paginator=_.first)}},features:[e.qOj],decls:24,vars:23,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","modal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["modal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["class","modal-title",4,"ngIf"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"primeng-datatable-container",3,"busyIf"],[3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],["entityChangeDetailModal",""],[1,"modal-title"],[2,"width","15%"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm",3,"title","click"],[1,"la","la-chevron-circle-right"],[1,"p-column-title"],[1,"primeng-no-data"]],template:function(s,l){1&s&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return l.shown()}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4),e.YNc(5,y,4,5,"h4",5),e.TgZ(6,"button",6),e.NdJ("click",function(){return l.close()}),e.qZA()(),e.TgZ(7,"div",7)(8,"div",8)(9,"p-table",9,10),e.NdJ("onLazyLoad",function(T){return l.getRecordsIfNeeds(T)}),e.YNc(11,P,13,12,"ng-template",11),e.YNc(12,L,21,19,"ng-template",12),e.qZA(),e.YNc(13,O,3,3,"div",13),e.TgZ(14,"div",14)(15,"p-paginator",15,16),e.NdJ("onPageChange",function(T){return l.getRecordsIfNeeds(T)}),e.ALo(17,"localize"),e.qZA()()()(),e.TgZ(18,"div",17)(19,"button",18),e.NdJ("click",function(){return l.close()}),e._uU(20),e.ALo(21,"localize"),e.qZA()()()()(),e._UZ(22,"entityChangeDetailModal",null,19)),2&s&&(e.Q6J("config",e.DdM(21,x)),e.xp6(5),e.Q6J("ngIf",l.options),e.xp6(1),e.uIk("aria-label",l.l("Close")),e.xp6(2),e.Q6J("busyIf",l.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",l.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",l.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(22,U)),e.xp6(4),e.Q6J("ngIf",0==l.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",l.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",l.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",l.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(17,16,"TotalRecordsCount",l.primengTableHelper.totalRecordsCount)),e.xp6(5),e.hij(" ",e.lcZ(21,19,"Close")," "))},dependencies:[C.O5,m.U,h.iA,M.jx,v.D,D.Z,b.S,Z.n,d.F],encapsulation:2})}return r})()},83410:(A,g,o)=>{o.d(g,{a:()=>e});var u=o(50387),t=o(99468);let e=(()=>{class p{constructor(m){this.permission=m.get(u.qT)}transform(m){return this.permission.isGranted(m)}static#e=this.\u0275fac=function(h){return new(h||p)(t.Y36(t.zs3,16))};static#t=this.\u0275pipe=t.Yjl({name:"permission",type:p,pure:!0})}return p})()}}]);