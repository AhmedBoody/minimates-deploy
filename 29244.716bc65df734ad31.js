"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[29244,83410,53722],{59170:(D,T,o)=>{o.d(T,{Z:()=>E});var n=o(99468),_=o(41840),f=o(44328),e=o(96814),u=o(24142),g=o(99824),C=o(3291);const v=["permissionTreeModal"],O=["permissionTree"];function y(l,p){if(1&l){const t=n.EpF();n.TgZ(0,"button",13),n.NdJ("click",function(){n.CHM(t);const s=n.oxw();return n.KtG(s.openPermissionTreeModal())}),n._uU(1),n.ALo(2,"localize"),n.qZA()}if(2&l){const t=n.oxw();n.xp6(1),n.AsE(" ",n.lcZ(2,2,"SelectPermissions")," (",t.NumberOfFilteredPermission,")\n")}}const P=function(){return{backdrop:"static"}};let E=(()=>{class l extends _.c{constructor(t,c){super(t),this._permissionService=c,this.onModalclose=new n.vpe,this.selectedPermissions=[],this.NumberOfFilteredPermission=0}ngOnInit(){this.loadAllPermissionsToFilterTree()}openPermissionTreeModal(){this.permissionTreeModal.show()}closePermissionTreeModal(){let t=this.getSelectedPermissions();this.NumberOfFilteredPermission=t.length,this.onModalclose.emit(t),this.permissionTreeModal.hide(),abp.notify.success(this.l("XCountPermissionFiltered",this.NumberOfFilteredPermission))}getSelectedPermissions(){return this.permissionTree?this.permissionTree.getGrantedPermissionNames().filter((c,s,i)=>s===i.findIndex(d=>d===c)):[]}loadAllPermissionsToFilterTree(){let t=[];this._permissionService.getAllPermissions().subscribe(c=>{c.items&&c.items.forEach(s=>{t.push(new f.h$({name:s.name,description:s.description,displayName:s.displayName,isGrantedByDefault:s.isGrantedByDefault,parentName:s.parentName}))}),this.permissionTree.editData={permissions:t,grantedPermissionNames:[]}})}static#e=this.\u0275fac=function(c){return new(c||l)(n.Y36(n.zs3),n.Y36(f.$zk))};static#t=this.\u0275cmp=n.Xpm({type:l,selectors:[["permission-tree-modal"]],viewQuery:function(c,s){if(1&c&&(n.Gf(v,7),n.Gf(O,5)),2&c){let i;n.iGM(i=n.CRH())&&(s.permissionTreeModal=i.first),n.iGM(i=n.CRH())&&(s.permissionTree=i.first)}},inputs:{dontAddOpenerButton:"dontAddOpenerButton",singleSelect:"singleSelect",disableCascade:"disableCascade"},outputs:{onModalclose:"onModalclose"},features:[n.qOj],decls:17,vars:12,consts:[["class","btn btn-secondary w-100",3,"click",4,"ngIf"],["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","permissionTreeModal","aria-hidden","true",1,"modal","fade",3,"config"],["permissionTreeModal","bs-modal"],[1,"modal-dialog","modal-lg","permissionFilterTreeModal"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"singleSelect","disableCascade"],["permissionTree",""],[1,"modal-footer"],["type","button",1,"btn","btn-primary","fw-bold",3,"click"],[1,"btn","btn-secondary","w-100",3,"click"]],template:function(c,s){1&c&&(n.YNc(0,y,3,4,"button",0),n.TgZ(1,"div",1,2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),n._uU(7),n.ALo(8,"localize"),n.qZA(),n.TgZ(9,"button",7),n.NdJ("click",function(){return s.closePermissionTreeModal()}),n.qZA()(),n.TgZ(10,"div",8),n._UZ(11,"permission-tree",9,10),n.qZA(),n.TgZ(13,"div",11)(14,"button",12),n.NdJ("click",function(){return s.closePermissionTreeModal()}),n._uU(15),n.ALo(16,"localize"),n.qZA()()()()()),2&c&&(n.Q6J("ngIf",!s.dontAddOpenerButton),n.xp6(1),n.Q6J("config",n.DdM(11,P)),n.xp6(6),n.hij(" ",n.lcZ(8,7,"SelectPermissions")," "),n.xp6(2),n.uIk("aria-label",s.l("Close")),n.xp6(2),n.Q6J("singleSelect",s.singleSelect)("disableCascade",s.disableCascade),n.xp6(4),n.hij(" ",n.lcZ(16,9,"Select")," "))},dependencies:[e.O5,u.Z,g.I,C.F],encapsulation:2})}return l})()},99824:(D,T,o)=>{o.d(T,{I:()=>y});var n=o(41840),_=o(75857),f=o(43136),e=o(99468),u=o(78164),g=o(98833),C=o(56223),v=o(91396),O=o(3291);let y=(()=>{class P extends n.c{constructor(l,p,t){super(t),this._arrayToTreeConverterService=l,this._treeDataHelperService=p,this.selectedPermissions=[],this.filter=""}set editData(l){this.setTreeData(l.permissions),this.setSelectedNodes(l.grantedPermissionNames)}setTreeData(l){this.treeData=this._arrayToTreeConverterService.createTree(l,"parentName","name",null,"children",[{target:"label",source:"displayName"},{target:"expandedIcon",value:"fa fa-folder-open text-warning"},{target:"collapsedIcon",value:"fa fa-folder text-warning"},{target:"expanded",value:!0}])}setSelectedNodes(l){this.selectedPermissions=[],(0,_.Z)(l,p=>{let t=this._treeDataHelperService.findNode(this.treeData,{data:{name:p}});t&&this.selectedPermissions.push(t)})}getGrantedPermissionNames(){if(!this.selectedPermissions||!this.selectedPermissions.length)return[];let l=[];for(let p=0;p<this.selectedPermissions.length;p++)l.push(this.selectedPermissions[p].data.name);return l}nodeSelect(l){if(this.singleSelect)return void(this.selectedPermissions=[l.node]);if(this.disableCascade)return;let p=this._treeDataHelperService.findParent(this.treeData,{data:{name:l.node.data.name}});for(;null!=p;)this.selectedPermissions.push(p),p=this._treeDataHelperService.findParent(this.treeData,{data:{name:p.data.name}})}onNodeUnselect(l){if(this.disableCascade)return;let p=this._treeDataHelperService.findChildren(this.treeData,{data:{name:l.node.data.name}});p.push(l.node.data.name),(0,f.Z)(this.selectedPermissions,t=>-1!==p.indexOf(t.data.name))}filterPermissions(l){this.filterPermission(this.treeData,this.filter)}filterPermission(l,p){(0,_.Z)(l,t=>{t.styleClass=t.data.displayName.toLowerCase().indexOf(p.toLowerCase())>=0?this.showParentNodes(t):"hidden-tree-node",t.children&&this.filterPermission(t.children,p)})}showParentNodes(l){l.parent&&(l.parent.styleClass="",this.showParentNodes(l.parent))}static#e=this.\u0275fac=function(p){return new(p||P)(e.Y36(u.V),e.Y36(g.j),e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:P,selectors:[["permission-tree"]],inputs:{singleSelect:"singleSelect",disableCascade:"disableCascade"},features:[e.qOj],decls:4,vars:8,consts:[[1,"my-5"],["type","text",1,"form-control",3,"ngModel","placeholder","input","ngModelChange"],["selectionMode","checkbox",3,"value","selection","propagateSelectionUp","propagateSelectionDown","selectionChange","onNodeSelect","onNodeUnselect"]],template:function(p,t){1&p&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("input",function(s){return t.filterPermissions(s)})("ngModelChange",function(s){return t.filter=s}),e.ALo(2,"localize"),e.qZA()(),e.TgZ(3,"p-tree",2),e.NdJ("selectionChange",function(s){return t.selectedPermissions=s})("onNodeSelect",function(s){return t.nodeSelect(s)})("onNodeUnselect",function(s){return t.onNodeUnselect(s)}),e.qZA()),2&p&&(e.xp6(1),e.s9C("placeholder",e.lcZ(2,6,"SearchWithThreeDot")),e.Q6J("ngModel",t.filter),e.xp6(2),e.Q6J("value",t.treeData)("selection",t.selectedPermissions)("propagateSelectionUp",!1)("propagateSelectionDown",!t.disableCascade))},dependencies:[C.Fj,C.JJ,C.On,v.mp,O.F],encapsulation:2})}return P})()},49556:(D,T,o)=>{o.d(T,{Ql:()=>e,TH:()=>f,cT:()=>_});var n=o(99468);const _=new n.OlP("selectedValues"),f=new n.OlP("allValues"),e=new n.OlP("componentInstance")},63686:(D,T,o)=>{o.d(T,{R:()=>p});var n=o(41840),_=o(49556);class f extends n.c{constructor(c){super(c),this.selectedValues=c.get(_.cT),this.allValues=c.get(_.TH),c.get(_.Ql)(this)}}var e=o(99468),u=o(56223);let g=(()=>{class t extends f{constructor(s){super(s)}getSelectedValues(){return this.selectedValue?[this.selectedValue]:[]}ngOnInit(){this.selectedValue=this.selectedValues[0]}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-single-line-string-input-type"]],features:[e.qOj],decls:1,vars:1,consts:[["type","text",1,"form-control",3,"ngModel","ngModelChange"]],template:function(i,d){1&i&&(e.TgZ(0,"input",0),e.NdJ("ngModelChange",function(a){return d.selectedValue=a}),e.qZA()),2&i&&e.Q6J("ngModel",d.selectedValue)},dependencies:[u.Fj,u.JJ,u.On]})}return t})(),C=(()=>{class t extends f{constructor(s){super(s)}ngOnInit(){this.checked=this.selectedValues&&this.selectedValues[0]&&"true"===this.selectedValues[0]}getSelectedValues(){return[this.checked.toString()]}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-checkbox-input-type"]],features:[e.qOj],decls:4,vars:1,consts:[[1,"checkbox-inline"],[1,"checkbox","checkbox-solid"],["type","checkbox","value","true",3,"ngModel","ngModelChange"]],template:function(i,d){1&i&&(e.TgZ(0,"div",0)(1,"label",1)(2,"input",2),e.NdJ("ngModelChange",function(a){return d.checked=a}),e.qZA(),e._UZ(3,"span"),e.qZA()()),2&i&&(e.xp6(2),e.Q6J("ngModel",d.checked))},dependencies:[u.Wl,u.JJ,u.On]})}return t})();var v=o(96814);function O(t,c){if(1&t&&(e.TgZ(0,"option",3),e._uU(1),e.qZA()),2&t){const s=c.$implicit;e.Q6J("value",s),e.xp6(1),e.Oqu(s)}}let y=(()=>{class t extends f{constructor(s){super(s)}ngOnInit(){this.selectedValue=this.selectedValues[0]}getSelectedValues(){return this.selectedValue?[this.selectedValue]:[]}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-combobox-input-type"]],features:[e.qOj],decls:3,vars:2,consts:[[1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,d){1&i&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(a){return d.selectedValue=a}),e._UZ(1,"option",1),e.YNc(2,O,2,2,"option",2),e.qZA()),2&i&&(e.Q6J("ngModel",d.selectedValue),e.xp6(2),e.Q6J("ngForOf",d.allValues))},dependencies:[v.sg,u.YN,u.Kr,u.EJ,u.JJ,u.On]})}return t})();var P=o(77327);let E=(()=>{class t extends f{constructor(s){super(s)}ngOnInit(){this.filteredValues=this.allValues}getSelectedValues(){return this.selectedValues?this.selectedValues:[]}filter(s){this.filteredValues=this.allValues.filter(i=>i.toLowerCase().includes(s.query.toLowerCase()))}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-multiple-select-input-type"]],features:[e.qOj],decls:1,vars:4,consts:[["inputStyleClass","form-control","styleClass","width-percent-100",3,"ngModel","suggestions","minLength","multiple","ngModelChange","completeMethod"]],template:function(i,d){1&i&&(e.TgZ(0,"p-autoComplete",0),e.NdJ("ngModelChange",function(a){return d.selectedValues=a})("completeMethod",function(a){return d.filter(a)}),e.qZA()),2&i&&e.Q6J("ngModel",d.selectedValues)("suggestions",d.filteredValues)("minLength",1)("multiple",!0)},dependencies:[u.JJ,u.On,P.Qc],encapsulation:2})}return t})();class l{constructor(c,s,i){this.name=c,this.component=s,this.hasValues=i}}let p=(()=>{class t{constructor(){this.initialize()}getByName(s){let i=this.InputTypeConfigurationDefinitions.filter(d=>d.name===s);return i&&1===i.length?i[0]:null}getByInputType(s){return this.getByName(s.name)}initialize(){let s=new l("SINGLE_LINE_STRING",g,!1),i=new l("CHECKBOX",C,!1),d=new l("COMBOBOX",y,!0),r=new l("MULTISELECTCOMBOBOX",E,!0);this.InputTypeConfigurationDefinitions=[],this.InputTypeConfigurationDefinitions.push(s),this.InputTypeConfigurationDefinitions.push(i),this.InputTypeConfigurationDefinitions.push(d),this.InputTypeConfigurationDefinitions.push(r)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()},83410:(D,T,o)=>{o.d(T,{a:()=>f});var n=o(50387),_=o(99468);let f=(()=>{class e{constructor(g){this.permission=g.get(n.qT)}transform(g){return this.permission.isGranted(g)}static#e=this.\u0275fac=function(C){return new(C||e)(_.Y36(_.zs3,16))};static#t=this.\u0275pipe=_.Yjl({name:"permission",type:e,pure:!0})}return e})()},43136:(D,T,o)=>{o.d(T,{Z:()=>d});var n=o(94138),_=o(45920);var u=o(14818);const O=function v(r,a){return a.length<2?r:(0,u.Z)(r,function g(r,a,h){var M=-1,m=r.length;a<0&&(a=-a>m?0:m+a),(h=h>m?m:h)<0&&(h+=m),m=a>h?0:h-a>>>0,a>>>=0;for(var I=Array(m);++M<m;)I[M]=r[M+a];return I}(a,0,-1))};var y=o(77801);const E=function P(r,a){return a=(0,_.Z)(a,r),null==(r=O(r,a))||delete r[(0,y.Z)(function f(r){var a=null==r?0:r.length;return a?r[a-1]:void 0}(a))]};var l=o(19229),t=Array.prototype.splice;const d=function i(r,a){var h=[];if(!r||!r.length)return h;var M=-1,m=[],I=r.length;for(a=(0,n.Z)(a,3);++M<I;){var b=r[M];a(b,M,r)&&(h.push(b),m.push(M))}return function c(r,a){for(var h=r?a.length:0,M=h-1;h--;){var m=a[h];if(h==M||m!==I){var I=m;(0,l.Z)(m)?t.call(r,m,1):E(r,m)}}}(r,m),h}}}]);