"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[69076],{96655:(U,f,i)=>{i.d(f,{S:()=>O});var C=i(41840),t=i(99468),e=i(44328),y=i(58399),Z=i(96814),T=i(24142),v=i(3291);const D=["entityChangeDetailModal"];function b(u,A){if(1&u){const o=t.EpF();t.TgZ(0,"div",9)(1,"h4",10)(2,"span"),t._uU(3),t.ALo(4,"localize"),t.ALo(5,"localize"),t.qZA(),t._UZ(6,"br")(7,"small",11),t.qZA(),t.TgZ(8,"button",12),t.NdJ("click",function(){t.CHM(o);const p=t.oxw();return t.KtG(p.close())}),t.qZA()()}if(2&u){const o=t.oxw();t.xp6(3),t.AsE("",t.lcZ(4,4,"Detail")," - ",t.lcZ(5,6,o.entityChange.entityTypeFullName),""),t.xp6(4),t.Q6J("innerHTML",o.l("CreatedAtByUser",o.entityChange.changeTime,o.entityChange.userName),t.oJD),t.xp6(1),t.uIk("aria-label",o.l("Close"))}}function P(u,A){if(1&u&&(t.TgZ(0,"div",13)(1,"div",14)(2,"h3",15)(3,"span",16),t._uU(4),t.qZA()()(),t.TgZ(5,"div",17)(6,"div",18)(7,"div",19)(8,"div",20),t._uU(9),t.ALo(10,"localize"),t.qZA(),t.TgZ(11,"div",21),t._uU(12),t.qZA()(),t.TgZ(13,"div",22)(14,"div",20),t._uU(15),t.ALo(16,"localize"),t.qZA(),t.TgZ(17,"div",21),t._uU(18),t.qZA()()()()()),2&u){const o=A.$implicit,l=t.oxw();t.xp6(4),t.Oqu(o.propertyName),t.xp6(5),t.hij(" ",t.lcZ(10,5,"OriginalValue")," "),t.xp6(3),t.hij(" ",l.getPropertyChangeValue(o.originalValue,o.propertyTypeFullName)," "),t.xp6(3),t.Oqu(t.lcZ(16,7,"NewValue")),t.xp6(3),t.hij(" ",l.getPropertyChangeValue(o.newValue,o.propertyTypeFullName)," ")}}const L=function(){return{backdrop:"static"}};let O=(()=>{class u extends C.c{constructor(o,l,p){super(o),this._auditLogService=l,this._dateTimeService=p,this.active=!1}getPropertyChangeValue(o,l){return o&&(o=o.replace(/^['"]+/g,"").replace(/['"]+$/g,""),this.isDate(o,l)?this._dateTimeService.formatDate(this._dateTimeService.fromISODateString(o),"yyyy-LL-dd HH:mm:ss"):"null"===o?"":o)}isDate(o,l){return l.includes("DateTime")&&!isNaN(Date.parse(o).valueOf())}show(o){const l=this;l.active=!0,l.entityChange=o,this._auditLogService.getEntityPropertyChanges(o.id).subscribe(p=>{l.entityPropertyChanges=p}),l.modal.show()}close(){this.active=!1,this.modal.hide()}static#e=this.\u0275fac=function(l){return new(l||u)(t.Y36(t.zs3),t.Y36(e.xWy),t.Y36(y.C))};static#t=this.\u0275cmp=t.Xpm({type:u,selectors:[["entityChangeDetailModal"]],viewQuery:function(l,p){if(1&l&&t.Gf(D,7),2&l){let E;t.iGM(E=t.CRH())&&(p.modal=E.first)}},features:[t.qOj],decls:11,vars:7,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","entityChangeDetailModal","aria-hidden","true",1,"modal","fade",3,"config"],["entityChangeDetailModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],["class","modal-header",4,"ngIf"],[1,"modal-body"],["class","card card-custom gutter-b",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],[1,"modal-header"],[1,"modal-title"],[3,"innerHTML"],["type","button",1,"btn-close",3,"click"],[1,"card","card-custom","gutter-b"],[1,"card-header","py-5"],[1,"card-title"],[1,"card-label"],[1,"card-body","py-0"],[1,"row","m-0"],[1,"col","px-8","py-6","me-8"],[1,"fs-sm","text-muted","fw-bold"],[1,"fw-bolder"],[1,"col","px-8","py-6"]],template:function(l,p){1&l&&(t.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3),t.YNc(4,b,9,8,"div",4),t.TgZ(5,"div",5),t.YNc(6,P,19,9,"div",6),t.qZA(),t.TgZ(7,"div",7)(8,"button",8),t.NdJ("click",function(){return p.close()}),t._uU(9),t.ALo(10,"localize"),t.qZA()()()()()),2&l&&(t.Q6J("config",t.DdM(6,L)),t.xp6(4),t.Q6J("ngIf",p.entityChange),t.xp6(2),t.Q6J("ngForOf",p.entityPropertyChanges),t.xp6(3),t.hij(" ",t.lcZ(10,4,"Close")," "))},dependencies:[Z.sg,Z.O5,T.Z,v.F],encapsulation:2})}return u})()},76388:(U,f,i)=>{i.d(f,{A:()=>c});var C=i(41840),t=i(64716),e=i(99468),y=i(44328),Z=i(96814),T=i(94901),v=i(68027),D=i(85219),b=i(51712),P=i(24142),L=i(96655),O=i(88922),u=i(3291);const A=["entityChangeDetailModal"],o=["modal"],l=["dataTable"],p=["paginator"];function E(s,M){if(1&s&&(e.TgZ(0,"h4",20),e._uU(1),e.ALo(2,"localize"),e.ALo(3,"localize"),e.qZA()),2&s){const r=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,"ChangeLogs")+":"+e.lcZ(3,3,r.options.entityTypeFullName)+"("+r.options.entityTypeDescription+")"," ")}}function R(s,M){1&s&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2),e.ALo(3,"localize"),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"localize"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"localize"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"localize"),e.qZA()()),2&s&&(e.xp6(2),e.hij(" ",e.lcZ(3,4,"Select")," "),e.xp6(3),e.hij(" ",e.lcZ(6,6,"Action")," "),e.xp6(3),e.hij(" ",e.lcZ(9,8,"UserName")," "),e.xp6(3),e.hij(" ",e.lcZ(12,10,"Time")," "))}function n(s,M){if(1&s){const r=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"button",22),e.NdJ("click",function(){const m=e.CHM(r).$implicit,x=e.oxw();return e.KtG(x.showEntityChangeDetails(m))}),e.ALo(3,"localize"),e._UZ(4,"i",23),e.qZA()(),e.TgZ(5,"td")(6,"span",24),e._uU(7),e.ALo(8,"localize"),e.qZA(),e._uU(9),e.qZA(),e.TgZ(10,"td")(11,"span",24),e._uU(12),e.ALo(13,"localize"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"td")(16,"span",24),e._uU(17),e.ALo(18,"localize"),e.qZA(),e._uU(19),e.ALo(20,"luxonFormat"),e.qZA()()}if(2&s){const r=M.$implicit,g=e.oxw();e.xp6(2),e.s9C("title",e.lcZ(3,8,"Select")),e.xp6(2),e.uIk("aria-label",g.l("Select")),e.xp6(3),e.Oqu(e.lcZ(8,10,"Action")),e.xp6(2),e.hij(" ",r.changeTypeName," "),e.xp6(3),e.Oqu(e.lcZ(13,12,"UserName")),e.xp6(2),e.hij(" ",r.userName," "),e.xp6(3),e.Oqu(e.lcZ(18,14,"Time")),e.xp6(2),e.hij(" ",e.xi3(20,16,r.changeTime,"F")," ")}}function a(s,M){1&s&&(e.TgZ(0,"div",25),e._uU(1),e.ALo(2,"localize"),e.qZA()),2&s&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NoData")," "))}const d=function(){return{backdrop:"static"}},h=function(){return{"min-width":"25rem"}};let c=(()=>{class s extends C.c{constructor(r,g){super(r),this._auditLogService=g,this.isShown=!1,this.isInitialized=!1,this.filterText=""}show(r){this.options=r,this.modal.show()}refreshTable(){this.paginator.changePage(this.paginator.getPage())}close(){this.modal.hide()}shown(){this.isShown=!0,this.getRecordsIfNeeds(null)}getRecordsIfNeeds(r){this.isShown&&(this.getRecords(r),this.isInitialized=!0)}getRecords(r){this.primengTableHelper.showLoadingIndicator(),this._auditLogService.getEntityTypeChanges(this.options.entityTypeFullName,this.options.entityId,this.primengTableHelper.getSorting(this.dataTable),this.primengTableHelper.getMaxResultCount(this.paginator,r),this.primengTableHelper.getSkipCount(this.paginator,r)).pipe((0,t.x)(()=>this.primengTableHelper.hideLoadingIndicator())).subscribe(g=>{this.primengTableHelper.totalRecordsCount=g.totalCount,this.primengTableHelper.records=g.items,this.primengTableHelper.hideLoadingIndicator()})}showEntityChangeDetails(r){this.entityChangeDetailModal.show(r)}static#e=this.\u0275fac=function(g){return new(g||s)(e.Y36(e.zs3),e.Y36(y.xWy))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["entityTypeHistoryModal"]],viewQuery:function(g,_){if(1&g&&(e.Gf(A,7),e.Gf(o,7),e.Gf(l,7),e.Gf(p,7)),2&g){let m;e.iGM(m=e.CRH())&&(_.entityChangeDetailModal=m.first),e.iGM(m=e.CRH())&&(_.modal=m.first),e.iGM(m=e.CRH())&&(_.dataTable=m.first),e.iGM(m=e.CRH())&&(_.paginator=m.first)}},features:[e.qOj],decls:24,vars:23,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","modal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["modal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["class","modal-title",4,"ngIf"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"primeng-datatable-container",3,"busyIf"],[3,"value","rows","paginator","lazy","tableStyle","onLazyLoad"],["dataTable",""],["pTemplate","header"],["pTemplate","body"],["class","primeng-no-data",4,"ngIf"],[1,"primeng-paging-container"],[3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","currentPageReportTemplate","onPageChange"],["paginator",""],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","fw-bold",3,"click"],["entityChangeDetailModal",""],[1,"modal-title"],[2,"width","15%"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm",3,"title","click"],[1,"la","la-chevron-circle-right"],[1,"p-column-title"],[1,"primeng-no-data"]],template:function(g,_){1&g&&(e.TgZ(0,"div",0,1),e.NdJ("onShown",function(){return _.shown()}),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4),e.YNc(5,E,4,5,"h4",5),e.TgZ(6,"button",6),e.NdJ("click",function(){return _.close()}),e.qZA()(),e.TgZ(7,"div",7)(8,"div",8)(9,"p-table",9,10),e.NdJ("onLazyLoad",function(x){return _.getRecordsIfNeeds(x)}),e.YNc(11,R,13,12,"ng-template",11),e.YNc(12,n,21,19,"ng-template",12),e.qZA(),e.YNc(13,a,3,3,"div",13),e.TgZ(14,"div",14)(15,"p-paginator",15,16),e.NdJ("onPageChange",function(x){return _.getRecordsIfNeeds(x)}),e.ALo(17,"localize"),e.qZA()()()(),e.TgZ(18,"div",17)(19,"button",18),e.NdJ("click",function(){return _.close()}),e._uU(20),e.ALo(21,"localize"),e.qZA()()()()(),e._UZ(22,"entityChangeDetailModal",null,19)),2&g&&(e.Q6J("config",e.DdM(21,d)),e.xp6(5),e.Q6J("ngIf",_.options),e.xp6(1),e.uIk("aria-label",_.l("Close")),e.xp6(2),e.Q6J("busyIf",_.primengTableHelper.isLoading),e.xp6(1),e.s9C("rows",_.primengTableHelper.defaultRecordsCountPerPage),e.Q6J("value",_.primengTableHelper.records)("paginator",!1)("lazy",!0)("tableStyle",e.DdM(22,h)),e.xp6(4),e.Q6J("ngIf",0==_.primengTableHelper.totalRecordsCount),e.xp6(2),e.Q6J("rows",_.primengTableHelper.defaultRecordsCountPerPage)("totalRecords",_.primengTableHelper.totalRecordsCount)("rowsPerPageOptions",_.primengTableHelper.predefinedRecordsCountPerPage)("showCurrentPageReport",!0)("currentPageReportTemplate",e.xi3(17,16,"TotalRecordsCount",_.primengTableHelper.totalRecordsCount)),e.xp6(5),e.hij(" ",e.lcZ(21,19,"Close")," "))},dependencies:[Z.O5,T.U,v.iA,D.jx,b.D,P.Z,L.S,O.n,u.F],encapsulation:2})}return s})()},83410:(U,f,i)=>{i.d(f,{a:()=>e});var C=i(50387),t=i(99468);let e=(()=>{class y{constructor(T){this.permission=T.get(C.qT)}transform(T){return this.permission.isGranted(T)}static#e=this.\u0275fac=function(v){return new(v||y)(t.Y36(t.zs3,16))};static#t=this.\u0275pipe=t.Yjl({name:"permission",type:y,pure:!0})}return y})()},43136:(U,f,i)=>{i.d(f,{Z:()=>R});var C=i(94138),t=i(45920);var Z=i(14818);const b=function D(n,a){return a.length<2?n:(0,Z.Z)(n,function T(n,a,d){var h=-1,c=n.length;a<0&&(a=-a>c?0:c+a),(d=d>c?c:d)<0&&(d+=c),c=a>d?0:d-a>>>0,a>>>=0;for(var s=Array(c);++h<c;)s[h]=n[h+a];return s}(a,0,-1))};var P=i(77801);const O=function L(n,a){return a=(0,t.Z)(a,n),null==(n=b(n,a))||delete n[(0,P.Z)(function e(n){var a=null==n?0:n.length;return a?n[a-1]:void 0}(a))]};var u=i(19229),o=Array.prototype.splice;const R=function E(n,a){var d=[];if(!n||!n.length)return d;var h=-1,c=[],s=n.length;for(a=(0,C.Z)(a,3);++h<s;){var M=n[h];a(M,h,n)&&(d.push(M),c.push(h))}return function l(n,a){for(var d=n?a.length:0,h=d-1;d--;){var c=a[d];if(d==h||c!==s){var s=c;(0,u.Z)(c)?o.call(n,c,1):O(n,c)}}}(n,c),d}}}]);